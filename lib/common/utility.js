var me=Object.create;var D=Object.defineProperty;var ue=Object.getOwnPropertyDescriptor;var ce=Object.getOwnPropertyNames;var pe=Object.getPrototypeOf,le=Object.prototype.hasOwnProperty;var de=(r,t)=>{for(var e in t)D(r,e,{get:t[e],enumerable:!0})},v=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of ce(t))!le.call(r,o)&&o!==e&&D(r,o,{get:()=>t[o],enumerable:!(n=ue(t,o))||n.enumerable});return r};var c=(r,t,e)=>(e=r!=null?me(pe(r)):{},v(t||!r||!r.__esModule?D(e,"default",{value:r,enumerable:!0}):e,r)),ge=r=>v(D({},"__esModule",{value:!0}),r);var Oe={};de(Oe,{getTimestamp:()=>De,jsonInfo2PoolKeys:()=>A,sleep:()=>Se});module.exports=ge(Oe);var oe=require("@solana/web3.js"),ie=c(require("bn.js"));var Z=c(require("big.js")),B=c(require("bn.js"));var s=c(require("bn.js"));var N=require("lodash"),j=c(require("pino")),H=c(require("pino-pretty")),_={},fe={},be=(0,H.default)({colorize:!0,levelFirst:!0,translateTime:"SYS:yyyymmdd HH:MM:ss.l"}),he=(0,j.default)({base:null,level:"silent"},be);function p(r){let t=(0,N.get)(_,r);if(!t){let e=(0,N.get)(fe,r);t=he.child({name:r},{level:e}),(0,N.set)(_,r,t)}return t.logWithError=(...e)=>{let n=e.map(o=>typeof o=="object"?JSON.stringify(o):o).join(", ");throw new Error(n)},t}var T=p("Raydium_bignumber");var Ce=new s.default(0),I=new s.default(1),Ke=new s.default(2),ve=new s.default(3),_e=new s.default(5),F=new s.default(10),z=new s.default(100),je=new s.default(1e3),He=new s.default(1e4),Y=9007199254740991;function u(r){if(r instanceof s.default)return r;if(typeof r=="string"){if(r.match(/^-?[0-9]+$/))return new s.default(r);T.logWithError(`invalid BigNumberish string: ${r}`)}return typeof r=="number"?(r%1&&T.logWithError(`BigNumberish number underflow: ${r}`),(r>=Y||r<=-Y)&&T.logWithError(`BigNumberish number overflow: ${r}`),new s.default(String(r))):typeof r=="bigint"?new s.default(r.toString()):(T.logWithError(`invalid BigNumberish value: ${r}`),new s.default(0))}function L(r){return F.pow(u(r))}var X=c(require("toformat")),Ne=X.default,w=Ne;var k=c(require("big.js")),$=c(require("decimal.js-light"));var P=p("module/fraction"),E=w(k.default),W=w($.default),we={[0]:W.ROUND_DOWN,[1]:W.ROUND_HALF_UP,[2]:W.ROUND_UP},ke={[0]:k.default.roundDown,[1]:k.default.roundHalfUp,[2]:k.default.roundUp},i=class{constructor(t,e=I){this.numerator=u(t),this.denominator=u(e)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new i(this.denominator,this.numerator)}add(t){let e=t instanceof i?t:new i(u(t));return this.denominator.eq(e.denominator)?new i(this.numerator.add(e.numerator),this.denominator):new i(this.numerator.mul(e.denominator).add(e.numerator.mul(this.denominator)),this.denominator.mul(e.denominator))}sub(t){let e=t instanceof i?t:new i(u(t));return this.denominator.eq(e.denominator)?new i(this.numerator.sub(e.numerator),this.denominator):new i(this.numerator.mul(e.denominator).sub(e.numerator.mul(this.denominator)),this.denominator.mul(e.denominator))}mul(t){let e=t instanceof i?t:new i(u(t));return new i(this.numerator.mul(e.numerator),this.denominator.mul(e.denominator))}div(t){let e=t instanceof i?t:new i(u(t));return new i(this.numerator.mul(e.denominator),this.denominator.mul(e.numerator))}toSignificant(t,e={groupSeparator:""},n=1){Number.isInteger(t)||P.logWithError(`${t} is not an integer.`),t<=0&&P.logWithError(`${t} is not positive.`),W.set({precision:t+1,rounding:we[n]});let o=new W(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(t);return o.toFormat(o.decimalPlaces(),e)}toFixed(t,e={groupSeparator:""},n=1){return Number.isInteger(t)||P.logWithError(`${t} is not an integer.`),t<0&&P.logWithError(`${t} is negative.`),E.DP=t,E.RM=ke[n]||1,new E(this.numerator.toString()).div(this.denominator.toString()).toFormat(t,e)}isZero(){return this.numerator.isZero()}};var We=p("Raydium_amount"),J=w(Z.default);function Be(r,t){let e="0",n="0";if(r.includes(".")){let o=r.split(".");o.length===2?([e,n]=o,n=n.padEnd(t,"0")):We.logWithError(`invalid number string, num: ${r}`)}else e=r;return[e,n.slice(0,t)||n]}var l=class extends i{constructor(e,n,o=!0,b){let h=new B.default(0),C=F.pow(new B.default(e.decimals));if(o)h=u(n);else{let S=new B.default(0),K=new B.default(0);if(typeof n=="string"||typeof n=="number"||typeof n=="bigint"){let[ae,se]=Be(n.toString(),e.decimals);S=u(ae),K=u(se)}S=S.mul(C),h=S.add(K)}super(h,C);this.logger=p(b||"Amount"),this.token=e}get raw(){return this.numerator}isZero(){return this.raw.isZero()}gt(e){return this.token.equals(e.token)||this.logger.logWithError("gt token not equals"),this.raw.gt(e.raw)}lt(e){return this.token.equals(e.token)||this.logger.logWithError("lt token not equals"),this.raw.lt(e.raw)}add(e){return this.token.equals(e.token)||this.logger.logWithError("add token not equals"),new l(this.token,this.raw.add(e.raw))}subtract(e){return this.token.equals(e.token)||this.logger.logWithError("sub token not equals"),new l(this.token,this.raw.sub(e.raw))}toSignificant(e=this.token.decimals,n,o=0){return super.toSignificant(e,n,o)}toFixed(e=this.token.decimals,n,o=0){return e>this.token.decimals&&this.logger.logWithError("decimals overflow"),super.toFixed(e,n,o)}toExact(e={groupSeparator:""}){return J.DP=this.token.decimals,new J(this.numerator.toString()).div(this.denominator.toString()).toFormat(e)}};var G=require("@solana/web3.js"),V={symbol:"SOL",name:"Solana",decimals:9},f={symbol:"WSOL",name:"Wrapped SOL",mint:"So11111111111111111111111111111111111111112",decimals:9,extensions:{coingeckoId:"solana"}},at={isQuantumSOL:!0,isLp:!1,official:!0,mint:new G.PublicKey(f.mint),decimals:9,symbol:"SOL",id:"sol",name:"solana",icon:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",extensions:{coingeckoId:"solana"}};var O=require("@solana/web3.js");var ee=require("@solana/spl-token"),a=require("@solana/web3.js");function R({pubkey:r,isSigner:t=!1,isWritable:e=!0}){return{pubkey:r,isWritable:e,isSigner:t}}var ut=[R({pubkey:ee.TOKEN_PROGRAM_ID,isWritable:!1}),R({pubkey:a.SystemProgram.programId,isWritable:!1}),R({pubkey:a.SYSVAR_RENT_PUBKEY,isWritable:!1})];function te({publicKey:r,transformSol:t}){if(r instanceof a.PublicKey)return t&&r.equals(x)?Q:r;if(t&&r===x.toBase58())return Q;if(typeof r=="string")try{return new a.PublicKey(r)}catch{throw new Error("invalid public key")}throw new Error("invalid public key")}function re(r){try{return new a.PublicKey(r)}catch{return r}}var ct=new a.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),pt=new a.PublicKey("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),lt=new a.PublicKey("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),dt=new a.PublicKey("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),gt=new a.PublicKey("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),ft=new a.PublicKey("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),bt=new a.PublicKey("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),ht=new a.PublicKey("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),Nt=new a.PublicKey("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),yt=new a.PublicKey("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),wt=new a.PublicKey("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Q=new a.PublicKey("So11111111111111111111111111111111111111112"),x=a.PublicKey.default;var U=class{constructor({mint:t,decimals:e,symbol:n="UNKNOWN",name:o="UNKNOWN",skipMint:b=!1}){if(t===x.toBase58()||t instanceof O.PublicKey&&x.equals(t)){this.decimals=f.decimals,this.symbol=f.symbol,this.name=f.name,this.mint=new O.PublicKey(f.mint);return}this.decimals=e,this.symbol=n,this.name=o,this.mint=b?O.PublicKey.default:te({publicKey:t})}equals(t){return this===t?!0:this.mint.equals(t.mint)}},g=U;g.WSOL=new U(f);var q=class{constructor({decimals:t,symbol:e="UNKNOWN",name:n="UNKNOWN"}){this.decimals=t,this.symbol=e,this.name=n}equals(t){return this===t}},M=q;M.SOL=new q(V);var ne=new i(z),y=class extends i{toSignificant(t=5,e,n){return this.mul(ne).toSignificant(t,e,n)}toFixed(t=2,e,n){return this.mul(ne).toFixed(t,e,n)}};var xe=p("Raydium_price"),d=class extends i{constructor(e){let{baseToken:n,quoteToken:o,numerator:b,denominator:h}=e;super(b,h);this.baseToken=n,this.quoteToken=o,this.scalar=new i(L(n.decimals),L(o.decimals))}get raw(){return new i(this.numerator,this.denominator)}get adjusted(){return super.mul(this.scalar)}invert(){return new d({baseToken:this.quoteToken,quoteToken:this.baseToken,denominator:this.numerator,numerator:this.denominator})}mul(e){this.quoteToken!==e.baseToken&&xe.logWithError("mul token not equals");let n=super.mul(e);return new d({baseToken:this.baseToken,quoteToken:e.quoteToken,denominator:n.denominator,numerator:n.numerator})}toSignificant(e=this.quoteToken.decimals,n,o){return this.adjusted.toSignificant(e,n,o)}toFixed(e=this.quoteToken.decimals,n,o){return this.adjusted.toFixed(e,n,o)}};async function Se(r){new Promise(t=>setTimeout(t,r))}function De(){return new Date().getTime()}var Te=[g,l,oe.PublicKey,i,ie.default,d,y];function Pe(r){return typeof r=="object"&&r!==null&&!Te.some(t=>typeof t=="object"&&r instanceof t)}function A(r){return typeof r=="string"?re(r):Array.isArray(r)?r.map(t=>A(t)):Pe(r)?Object.fromEntries(Object.entries(r).map(([t,e])=>[t,A(e)])):r}0&&(module.exports={getTimestamp,jsonInfo2PoolKeys,sleep});
//# sourceMappingURL=utility.js.map