var Pe=Object.defineProperty,Be=Object.defineProperties;var We=Object.getOwnPropertyDescriptors;var te=Object.getOwnPropertySymbols;var De=Object.prototype.hasOwnProperty,Re=Object.prototype.propertyIsEnumerable;var ne=(t,e,n)=>e in t?Pe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,O=(t,e)=>{for(var n in e||(e={}))De.call(e,n)&&ne(t,n,e[n]);if(te)for(var n of te(e))Re.call(e,n)&&ne(t,n,e[n]);return t},M=(t,e)=>Be(t,We(e));import{get as H,set as re}from"lodash";import Ae from"pino";import Ee from"pino-pretty";var $={},oe={},Oe=Ee({colorize:!0,levelFirst:!0,translateTime:"SYS:yyyymmdd HH:MM:ss.l"}),Le=Ae({base:null,level:"silent"},Oe);function y(t){let e=H($,t);if(!e){let n=H(oe,t);e=Le.child({name:t},{level:n}),re($,t,e)}return e.logWithError=(...n)=>{let r=n.map(o=>typeof o=="object"?JSON.stringify(o):o).join(", ");throw new Error(r)},e}function pt(t,e){re(oe,t,e);let n=H($,t);n&&(n.level=e)}import{PublicKey as Xe}from"@solana/web3.js";import Ge from"bn.js";import qe from"big.js";import j from"bn.js";import u from"bn.js";var C=y("Raydium_bignumber"),Y=(r=>(r[r.ROUND_DOWN=0]="ROUND_DOWN",r[r.ROUND_HALF_UP=1]="ROUND_HALF_UP",r[r.ROUND_UP=2]="ROUND_UP",r))(Y||{}),P=new u(0),ae=new u(1),ht=new u(2),yt=new u(3),xt=new u(5),A=new u(10),ue=new u(100),wt=new u(1e3),Nt=new u(1e4),ie=9007199254740991;function N(t){if(t instanceof u)return t;if(typeof t=="string"){if(t.match(/^-?[0-9]+$/))return new u(t);C.logWithError(`invalid BigNumberish string: ${t}`)}return typeof t=="number"?(t%1&&C.logWithError(`BigNumberish number underflow: ${t}`),(t>=ie||t<=-ie)&&C.logWithError(`BigNumberish number overflow: ${t}`),new u(String(t))):typeof t=="bigint"?new u(t.toString()):(C.logWithError(`invalid BigNumberish value: ${t}`),new u(0))}function z(t){return A.pow(N(t))}function E(t){var c;if(t===void 0)return{denominator:"1",numerator:"0"};if(t instanceof u)return{numerator:t.toString(),denominator:"1"};if(t instanceof i)return{denominator:t.denominator.toString(),numerator:t.numerator.toString()};let e=String(t),[,n="",r="",o=""]=(c=e.replace(",","").match(/(-?)(\d*)\.?(\d*)/))!=null?c:[],s="1"+"0".repeat(o.length),m=n+(r==="0"?"":r)+o||"0";return{denominator:s,numerator:m,sign:n,int:r,dec:o}}function Tt(t,e){let n=t.divmod(e);return n.mod.isZero()?n.div:n.div.negative!==0?n.div.isubn(1):n.div.iaddn(1)}function Fe(t){var r;let[,e="",n=""]=(r=t.toFixed(2).match(/(-?)(\d*)\.?(\d*)/))!=null?r:[];return`${e}${n}`}function Ie(t,e=0){return t instanceof u?t:new u(Fe(U(t).mul(A.pow(new u(String(e))))))}function U(t){if(t instanceof k)return new i(t.numerator,t.denominator);if(t instanceof w)return t.adjusted;if(t instanceof x)try{return U(t.toExact())}catch{return new i(P)}if(t instanceof i)return t;let e=String(t),n=E(e);return new i(n.numerator,n.denominator)}function kt(t,e){let{numerator:n,denominator:r}=E(t);return new k(new u(n),new u(r).mul(e!=null&&e.alreadyDecimaled?new u(100):new u(1)))}function St(t){let{token:e,numberPrice:n,decimalDone:r}=t,o=new T({mint:"",decimals:6,symbol:"usd",name:"usd",skipMint:!0}),{numerator:s,denominator:m}=E(n),c=r?new u(s).mul(A.pow(new u(e.decimals))):s,a=new u(m).mul(A.pow(new u(o.decimals)));return new w({baseToken:o,denominator:a.toString(),quoteToken:new T(M(O({},e),{skipMint:!0,mint:""})),numerator:c.toString()})}function ce(t,e){if(t==null||e==null)return;let n=U(t),r=U(e);return n.mul(r)}function se(t){let e=new T({mint:"",decimals:6,symbol:"usd",name:"usd",skipMint:!0}),n=Ie(ce(t,10**e.decimals));return new x(e,n)}function Pt(t,e){return se(!e||!t?0:ce(t,e))}import Ke from"toformat";var Me=Ke,L=Me;import q from"big.js";import Ce from"decimal.js-light";var _=y("module/fraction"),J=L(q),F=L(Ce),Ue={[0]:F.ROUND_DOWN,[1]:F.ROUND_HALF_UP,[2]:F.ROUND_UP},_e={[0]:q.roundDown,[1]:q.roundHalfUp,[2]:q.roundUp},i=class{constructor(e,n=ae){this.numerator=N(e),this.denominator=N(n)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new i(this.denominator,this.numerator)}add(e){let n=e instanceof i?e:new i(N(e));return this.denominator.eq(n.denominator)?new i(this.numerator.add(n.numerator),this.denominator):new i(this.numerator.mul(n.denominator).add(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}sub(e){let n=e instanceof i?e:new i(N(e));return this.denominator.eq(n.denominator)?new i(this.numerator.sub(n.numerator),this.denominator):new i(this.numerator.mul(n.denominator).sub(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}mul(e){let n=e instanceof i?e:new i(N(e));return new i(this.numerator.mul(n.numerator),this.denominator.mul(n.denominator))}div(e){let n=e instanceof i?e:new i(N(e));return new i(this.numerator.mul(n.denominator),this.denominator.mul(n.numerator))}toSignificant(e,n={groupSeparator:""},r=1){Number.isInteger(e)||_.logWithError(`${e} is not an integer.`),e<=0&&_.logWithError(`${e} is not positive.`),F.set({precision:e+1,rounding:Ue[r]});let o=new F(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return o.toFormat(o.decimalPlaces(),n)}toFixed(e,n={groupSeparator:""},r=1){return Number.isInteger(e)||_.logWithError(`${e} is not an integer.`),e<0&&_.logWithError(`${e} is negative.`),J.DP=e,J.RM=_e[r]||1,new J(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,n)}isZero(){return this.numerator.isZero()}};var je=y("Raydium_amount"),me=L(qe);function ve(t,e){let n="0",r="0";if(t.includes(".")){let o=t.split(".");o.length===2?([n,r]=o,r=r.padEnd(e,"0")):je.logWithError(`invalid number string, num: ${t}`)}else n=t;return[n,r.slice(0,e)||r]}var x=class extends i{constructor(n,r,o=!0,s){let m=new j(0),c=A.pow(new j(n.decimals));if(o)m=N(r);else{let a=new j(0),b=new j(0);if(typeof r=="string"||typeof r=="number"||typeof r=="bigint"){let[h,f]=ve(r.toString(),n.decimals);a=N(h),b=N(f)}a=a.mul(c),m=a.add(b)}super(m,c);this.logger=y(s||"Amount"),this.token=n}get raw(){return this.numerator}isZero(){return this.raw.isZero()}gt(n){return this.token.equals(n.token)||this.logger.logWithError("gt token not equals"),this.raw.gt(n.raw)}lt(n){return this.token.equals(n.token)||this.logger.logWithError("lt token not equals"),this.raw.lt(n.raw)}add(n){return this.token.equals(n.token)||this.logger.logWithError("add token not equals"),new x(this.token,this.raw.add(n.raw))}subtract(n){return this.token.equals(n.token)||this.logger.logWithError("sub token not equals"),new x(this.token,this.raw.sub(n.raw))}toSignificant(n=this.token.decimals,r,o=0){return super.toSignificant(n,r,o)}toFixed(n=this.token.decimals,r,o=0){return n>this.token.decimals&&this.logger.logWithError("decimals overflow"),super.toFixed(n,r,o)}toExact(n={groupSeparator:""}){return me.DP=this.token.decimals,new me(this.numerator.toString()).div(this.denominator.toString()).toFormat(n)}};import{PublicKey as He}from"@solana/web3.js";var le={symbol:"SOL",name:"Solana",decimals:9},D={symbol:"WSOL",name:"Wrapped SOL",mint:"So11111111111111111111111111111111111111112",decimals:9,extensions:{coingeckoId:"solana"}},Jt={isQuantumSOL:!0,isLp:!1,official:!0,mint:new He(D.mint),decimals:9,symbol:"SOL",id:"sol",name:"solana",icon:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",extensions:{coingeckoId:"solana"}};import{PublicKey as G}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as $e}from"@solana/spl-token";import{PublicKey as g,SystemProgram as Ye,SYSVAR_RENT_PUBKEY as ze}from"@solana/web3.js";function X({pubkey:t,isSigner:e=!1,isWritable:n=!0}){return{pubkey:t,isWritable:n,isSigner:e}}var Qt=[X({pubkey:$e,isWritable:!1}),X({pubkey:Ye.programId,isWritable:!1}),X({pubkey:ze,isWritable:!1})];function de({publicKey:t,transformSol:e}){if(t instanceof g)return e&&t.equals(I)?pe:t;if(e&&t===I.toBase58())return pe;if(typeof t=="string")try{return new g(t)}catch{throw new Error("invalid public key")}throw new Error("invalid public key")}function ge(t){try{return new g(t)}catch{return t}}var en=new g("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),tn=new g("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),nn=new g("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),rn=new g("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),on=new g("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),sn=new g("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),an=new g("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),un=new g("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),cn=new g("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),mn=new g("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),ln=new g("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),pe=new g("So11111111111111111111111111111111111111112"),I=g.default;var Z=class{constructor({mint:e,decimals:n,symbol:r="UNKNOWN",name:o="UNKNOWN",skipMint:s=!1}){if(e===I.toBase58()||e instanceof G&&I.equals(e)){this.decimals=D.decimals,this.symbol=D.symbol,this.name=D.name,this.mint=new G(D.mint);return}this.decimals=n,this.symbol=r,this.name=o,this.mint=s?G.default:de({publicKey:e})}equals(e){return this===e?!0:this.mint.equals(e.mint)}},T=Z;T.WSOL=new Z(D);var Q=class{constructor({decimals:e,symbol:n="UNKNOWN",name:r="UNKNOWN"}){this.decimals=e,this.symbol=n,this.name=r}equals(e){return this===e}},V=Q;V.SOL=new Q(le);var fe=new i(ue),k=class extends i{toSignificant(e=5,n,r){return this.mul(fe).toSignificant(e,n,r)}toFixed(e=2,n,r){return this.mul(fe).toFixed(e,n,r)}};var Je=y("Raydium_price"),w=class extends i{constructor(n){let{baseToken:r,quoteToken:o,numerator:s,denominator:m}=n;super(s,m);this.baseToken=r,this.quoteToken=o,this.scalar=new i(z(r.decimals),z(o.decimals))}get raw(){return new i(this.numerator,this.denominator)}get adjusted(){return super.mul(this.scalar)}invert(){return new w({baseToken:this.quoteToken,quoteToken:this.baseToken,denominator:this.numerator,numerator:this.denominator})}mul(n){this.quoteToken!==n.baseToken&&Je.logWithError("mul token not equals");let r=super.mul(n);return new w({baseToken:this.baseToken,quoteToken:n.quoteToken,denominator:r.denominator,numerator:r.numerator})}toSignificant(n=this.quoteToken.decimals,r,o){return this.adjusted.toSignificant(n,r,o)}toFixed(n=this.quoteToken.decimals,r,o){return this.adjusted.toFixed(n,r,o)}};async function vn(t){new Promise(e=>setTimeout(e,t))}function Hn(){return new Date().getTime()}var Ze=[T,x,Xe,i,Ge,w,k];function Ve(t){return typeof t=="object"&&t!==null&&!Ze.some(e=>typeof e=="object"&&t instanceof e)}function be(t){return typeof t=="string"?ge(t):Array.isArray(t)?t.map(e=>be(e)):Ve(t)?Object.fromEntries(Object.entries(t).map(([e,n])=>[e,be(n)])):t}import{PACKET_DATA_SIZE as Qe,PublicKey as we,sendAndConfirmTransaction as he,Transaction as v}from"@solana/web3.js";var B=y("Raydium_txTool"),ye=class{constructor(e){this.instructions=[];this.endInstructions=[];this.signers=[];this.connection=e.connection,this.feePayer=e.feePayer,this.signAllTransactions=e.signAllTransactions,this.owner=e.owner}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers}}get allInstructions(){return[...this.instructions,...this.endInstructions]}addInstruction({instructions:e=[],endInstructions:n=[],signers:r=[]}){return this.instructions.push(...e),this.endInstructions.push(...n),this.signers.push(...r),this}build(e){let n=new v;return this.allInstructions.length&&n.add(...this.allInstructions),n.feePayer=this.feePayer,{transaction:n,signers:this.signers,execute:async()=>{var o;let r=await xe(this.connection);if(n.recentBlockhash=r,(o=this.owner)!=null&&o.isKeyPair)return he(this.connection,n,this.signers);if(this.signAllTransactions){this.signers.length&&n.partialSign(...this.signers);let s=await this.signAllTransactions([n]);return await this.connection.sendRawTransaction(s[0].serialize(),{skipPreflight:!0})}throw new Error("please connect wallet first")},extInfo:e||{}}}buildMultiTx(e){let{extraPreBuildData:n=[],extInfo:r}=e,{transaction:o}=this.build(r),s=n.filter(a=>a.transaction.instructions.length>0),m=[...s.map(a=>a.transaction),o],c=[...s.map(a=>a.signers),this.signers];return{transactions:m,signers:c,execute:async()=>{var b;let a=await xe(this.connection);if((b=this.owner)!=null&&b.isKeyPair)return await Promise.all(m.map(async(h,f)=>(h.recentBlockhash=a,await he(this.connection,h,c[f]))));if(this.signAllTransactions){let h=m.map((S,R)=>(S.recentBlockhash=a,c[R].length&&S.partialSign(...c[R]),S)),f=await this.signAllTransactions(h),K=[];for(let S=0;S<f.length;S+=1){let R=await this.connection.sendRawTransaction(f[S].serialize(),{skipPreflight:!0});K.push(R)}return K}throw new Error("please connect wallet first")},extInfo:r||{}}}};async function xe(t){var e,n;try{return((n=await((e=t.getLatestBlockhash)==null?void 0:e.call(t)))==null?void 0:n.blockhash)||(await t.getRecentBlockhash()).blockhash}catch{return(await t.getRecentBlockhash()).blockhash}}function et(t,e){t.length<1&&B.logWithError(`no instructions provided: ${t.toString()}`),e.length<1&&B.logWithError(`no signers provided:, ${e.toString()}`);let n=new v;n.recentBlockhash="11111111111111111111111111111111",n.feePayer=e[0],n.add(...t);let r=n.compileMessage().serialize();return e.length+e.length*64+r.length}async function Qn(t,e,n){let r=new we("RaydiumSimuLateTransaction11111111111111111"),o=[],s=new v;s.feePayer=r;for(let a of e)et([...s.instructions,a],[r])>Qe&&(o.push(s),s=new v,s.feePayer=r),s.add(a);s.instructions.length>0&&o.push(s);let m=[];try{m=await Promise.all(o.map(a=>t.simulateTransaction(a)))}catch(a){a instanceof Error&&B.logWithError(`failed to simulate for instructions, RPC_ERROR, ${a.message}`)}let c=[];for(let a of m){let{value:b}=a;if(B.debug(`simulate result: ${JSON.stringify(a)}`),b.logs){let h=b.logs.filter(f=>f&&f.includes(n));B.debug(`filteredLog: ${JSON.stringify(c)}`),h.length||B.logWithError(` "simulate log not match keyword, keyword: ${n}`),c.push(...h)}}return c}function er(t,e){let n=t.match(/{["\w:,]+}/g);return!n||n.length!==1?B.logWithError(`simulate log fail to match json, keyword: ${e}`):n[0]}function tr(t,e){let r=new RegExp(`"${e}":(\\d+)`,"g").exec(t);return!r||r.length!==2?B.logWithError(`simulate log fail to match key", key: ${e}`):r[1]}async function nr(t,e){let[n,r]=await we.findProgramAddress(t,e);return{publicKey:n,nonce:r}}var W=class{constructor(e){this._owner=e}get publicKey(){return W.isKeyPair(this._owner)?this._owner.publicKey:this._owner}get signer(){return W.isKeyPair(this._owner)?this._owner:void 0}get isKeyPair(){return W.isKeyPair(this._owner)}get isPublicKey(){return W.isPublicKey(this._owner)}static isKeyPair(e){return e.secretKey!==void 0}static isPublicKey(e){return!W.isKeyPair(e)}};function Ne(t,e=1,n=[]){let r=[...t];if(e<=0)return n;for(;r.length;)n.push(r.splice(0,e));return n}function ir(t,...e){return t.filter(n=>e.every(r=>r.includes(n)))}function sr(t,...e){return t.filter(n=>e.every(r=>!r.includes(n)))}function ar(t){return[...new Set(t)]}import{PublicKey as tt}from"@solana/web3.js";var ee=y("Raydium_accountInfo_util");async function nt(t,e,n){let{batchRequest:r,commitment:o}=O({batchRequest:!1},n),s=Ne(e,100),m=new Array(s.length).fill([]);if(r){let c=s.map(b=>{let h=t._buildArgs([b.map(f=>f.toBase58())],o,"base64");return{methodName:"getMultipleAccounts",args:h}});m=(await t._rpcBatchRequest(c)).map(b=>(b.error&&ee.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${b.error.message}`),b.result.value.map(h=>{if(h){let{data:f,executable:K,lamports:S,owner:R,rentEpoch:Se}=h;return f.length!==2&&f[1]!=="base64"&&ee.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(f[0],"base64"),executable:K,lamports:S,owner:new tt(R),rentEpoch:Se}}return null})))}else try{m=await Promise.all(s.map(c=>t.getMultipleAccountsInfo(c,o)))}catch(c){c instanceof Error&&ee.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${c.message}`)}return m.flat()}async function fr(t,e,n){let r=await nt(t,e.map(o=>o.pubkey),n);return e.map((o,s)=>M(O({},o),{accountInfo:r[s]}))}function d(t){if(t instanceof k)return new i(t.numerator,t.denominator);if(t instanceof w)return t.adjusted;if(t instanceof x)try{return d(t.toExact())}catch{return new i(P)}if(t instanceof i)return t;let e=String(t),n=E(e);return new i(n.numerator,n.denominator)}function wr(t){var r;if(t instanceof k)return{fr:new i(t.numerator,t.denominator)};if(t instanceof w)return{fr:t.adjusted};if(t instanceof x)return{fr:d(t.toExact()),decimals:t.token.decimals};if(t instanceof i)return{fr:t};let e=String(t),n=E(e);return{fr:new i(n.numerator,n.denominator),decimals:(r=n.dec)==null?void 0:r.length}}function Nr(t,e){if(t==null||e==null)return!1;let n=d(t),r=d(e);return n.sub(r).numerator,n.sub(r).numerator.lt(P)}function rt(t,e){if(t==null||e==null)return!1;let n=d(t),r=d(e);return n.sub(r).numerator.gt(P)}function Tr(t,e){if(t==null||e==null)return!1;let n=d(t),r=d(e);return n.sub(r).numerator.lte(P)}function kr(t,e){if(t==null||e==null)return!1;let n=d(t),r=d(e);return n.sub(r).numerator.gte(P)}function ot(t,e){if(t==null||e==null)return!1;let n=d(t),r=d(e);return n.sub(r).numerator.eq(P)}function Sr(t,e){if(t==null||e==null)return;let n=d(t),r=d(e);try{return n.div(r)}catch{return n}}function Pr(t,e){if(t==null||e==null)return;let n=d(t),r=d(e);return n.sub(r)}function Br(t){return t==null?!1:!ot(t,0)}function Wr(t,e){return rt(e,t)?e:t}var Te=t=>typeof t=="number",ke=t=>t?new Date(t):new Date,it=t=>ke(t).getTime();function Rr(t,e,n){let r=Te(e)?e*((n==null?void 0:n.unit)==="s"?1e3:1):e;return new Date(t).getTime()<=r}function Ar(t,e,n){let r=Te(e)?e*((n==null?void 0:n.unit)==="s"?1e3:1):e;return new Date(t).getTime()>r}function Er(t,e){let r=it(t)+(e.days?e.days*24*60*60*1e3:0)+(e.hours?e.hours*60*60*1e3:0)+(e.minutes?e.minutes*60*1e3:0)+(e.seconds?e.seconds*1e3:0)+(e.milliseconds?e.milliseconds:0);return ke(r)}export{mn as ANAMint,ue as BN_100,wt as BN_1000,Nt as BN_10000,xt as BN_FIVE,ae as BN_ONE,A as BN_TEN,yt as BN_THREE,ht as BN_TWO,P as BN_ZERO,ln as ETHMint,cn as NRVMint,W as Owner,tn as PAIMint,en as RAYMint,Y as Rounding,I as SOLMint,nn as SRMMint,ye as TxBuilder,rn as USDCMint,un as USDHMint,on as USDTMint,pe as WSOLMint,X as accountMeta,Ne as chunkArray,Qt as commonSystemAccountMeta,y as createLogger,Sr as div,Tt as divCeil,ot as eq,nr as findProgramAddress,et as forecastTransactionSize,ke as getDate,Wr as getMax,nt as getMultipleAccountsInfo,fr as getMultipleAccountsInfoWithCustomFlags,xe as getRecentBlockHash,it as getTime,Hn as getTimestamp,rt as gt,kr as gte,ir as intersection,Ar as isDateAfter,Rr as isDateBefore,Br as isMeaningfulNumber,Te as isNumber,be as jsonInfo2PoolKeys,Nr as lt,Tr as lte,sn as mSOLMint,ce as mul,Er as offsetDateTime,N as parseBigNumberish,E as parseNumberInfo,er as parseSimulateLogToJson,tr as parseSimulateValue,pt as setLoggerLevel,Fe as shakeFractionDecimal,Qn as simulateMultipleInstruction,vn as sleep,an as stSOLMint,Pr as sub,z as tenExponential,Ie as toBN,U as toFraction,wr as toFractionWithDecimals,kt as toPercent,St as toTokenPrice,Pt as toTotalPrice,se as toUsdCurrency,ge as tryParsePublicKey,ar as uniq,de as validateAndParsePublicKey,sr as xor};
//# sourceMappingURL=index.mjs.map