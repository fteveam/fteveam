import ce from"big.js";import O from"bn.js";import a from"bn.js";import{get as j,set as V}from"lodash";import Q from"pino";import ee from"pino-pretty";var K={},ne={},re=ee({colorize:!0,levelFirst:!0,translateTime:"SYS:yyyymmdd HH:MM:ss.l"}),te=Q({base:null,level:"silent"},re);function l(n){let r=j(K,n);if(!r){let e=j(ne,n);r=te.child({name:n},{level:e}),V(K,n,r)}return r.logWithError=(...e)=>{let t=e.map(i=>typeof i=="object"?JSON.stringify(i):i).join(", ");throw new Error(t)},r}var D=l("Raydium_bignumber");var h=new a(0),H=new a(1),Ee=new a(2),Ue=new a(3),Re=new a(5),P=new a(10),Y=new a(100),Me=new a(1e3),qe=new a(1e4),I=9007199254740991;function p(n){if(n instanceof a)return n;if(typeof n=="string"){if(n.match(/^-?[0-9]+$/))return new a(n);D.logWithError(`invalid BigNumberish string: ${n}`)}return typeof n=="number"?(n%1&&D.logWithError(`BigNumberish number underflow: ${n}`),(n>=I||n<=-I)&&D.logWithError(`BigNumberish number overflow: ${n}`),new a(String(n))):typeof n=="bigint"?new a(n.toString()):(D.logWithError(`invalid BigNumberish value: ${n}`),new a(0))}function L(n){return P.pow(p(n))}function E(n){var x;if(n===void 0)return{denominator:"1",numerator:"0"};if(n instanceof a)return{numerator:n.toString(),denominator:"1"};if(n instanceof o)return{denominator:n.denominator.toString(),numerator:n.numerator.toString()};let r=String(n),[,e="",t="",i=""]=(x=r.replace(",","").match(/(-?)(\d*)\.?(\d*)/))!=null?x:[],g="1"+"0".repeat(i.length),b=e+(t==="0"?"":t)+i||"0";return{denominator:g,numerator:b,sign:e,int:t,dec:i}}import oe from"toformat";var ie=oe,W=ie;import F from"big.js";import ae from"decimal.js-light";var T=l("module/fraction"),U=W(F),k=W(ae),ue={[0]:k.ROUND_DOWN,[1]:k.ROUND_HALF_UP,[2]:k.ROUND_UP},me={[0]:F.roundDown,[1]:F.roundHalfUp,[2]:F.roundUp},o=class{constructor(r,e=H){this.numerator=p(r),this.denominator=p(e)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new o(this.denominator,this.numerator)}add(r){let e=r instanceof o?r:new o(p(r));return this.denominator.eq(e.denominator)?new o(this.numerator.add(e.numerator),this.denominator):new o(this.numerator.mul(e.denominator).add(e.numerator.mul(this.denominator)),this.denominator.mul(e.denominator))}sub(r){let e=r instanceof o?r:new o(p(r));return this.denominator.eq(e.denominator)?new o(this.numerator.sub(e.numerator),this.denominator):new o(this.numerator.mul(e.denominator).sub(e.numerator.mul(this.denominator)),this.denominator.mul(e.denominator))}mul(r){let e=r instanceof o?r:new o(p(r));return new o(this.numerator.mul(e.numerator),this.denominator.mul(e.denominator))}div(r){let e=r instanceof o?r:new o(p(r));return new o(this.numerator.mul(e.denominator),this.denominator.mul(e.numerator))}toSignificant(r,e={groupSeparator:""},t=1){Number.isInteger(r)||T.logWithError(`${r} is not an integer.`),r<=0&&T.logWithError(`${r} is not positive.`),k.set({precision:r+1,rounding:ue[t]});let i=new k(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(r);return i.toFormat(i.decimalPlaces(),e)}toFixed(r,e={groupSeparator:""},t=1){return Number.isInteger(r)||T.logWithError(`${r} is not an integer.`),r<0&&T.logWithError(`${r} is negative.`),U.DP=r,U.RM=me[t]||1,new U(this.numerator.toString()).div(this.denominator.toString()).toFormat(r,e)}isZero(){return this.numerator.isZero()}};var pe=l("Raydium_amount"),v=W(ce);function le(n,r){let e="0",t="0";if(n.includes(".")){let i=n.split(".");i.length===2?([e,t]=i,t=t.padEnd(r,"0")):pe.logWithError(`invalid number string, num: ${n}`)}else e=n;return[e,t.slice(0,r)||t]}var d=class extends o{constructor(e,t,i=!0,g){let b=new O(0),x=P.pow(new O(e.decimals));if(i)b=p(t);else{let S=new O(0),_=new O(0);if(typeof t=="string"||typeof t=="number"||typeof t=="bigint"){let[J,G]=le(t.toString(),e.decimals);S=p(J),_=p(G)}S=S.mul(x),b=S.add(_)}super(b,x);this.logger=l(g||"Amount"),this.token=e}get raw(){return this.numerator}isZero(){return this.raw.isZero()}gt(e){return this.token.equals(e.token)||this.logger.logWithError("gt token not equals"),this.raw.gt(e.raw)}lt(e){return this.token.equals(e.token)||this.logger.logWithError("lt token not equals"),this.raw.lt(e.raw)}add(e){return this.token.equals(e.token)||this.logger.logWithError("add token not equals"),new d(this.token,this.raw.add(e.raw))}subtract(e){return this.token.equals(e.token)||this.logger.logWithError("sub token not equals"),new d(this.token,this.raw.sub(e.raw))}toSignificant(e=this.token.decimals,t,i=0){return super.toSignificant(e,t,i)}toFixed(e=this.token.decimals,t,i=0){return e>this.token.decimals&&this.logger.logWithError("decimals overflow"),super.toFixed(e,t,i)}toExact(e={groupSeparator:""}){return v.DP=this.token.decimals,new v(this.numerator.toString()).div(this.denominator.toString()).toFormat(e)}};import{PublicKey as de}from"@solana/web3.js";var z={symbol:"SOL",name:"Solana",decimals:9},N={symbol:"WSOL",name:"Wrapped SOL",mint:"So11111111111111111111111111111111111111112",decimals:9,extensions:{coingeckoId:"solana"}},sn={isQuantumSOL:!0,isLp:!1,official:!0,mint:new de(N.mint),decimals:9,symbol:"SOL",id:"sol",name:"solana",icon:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",extensions:{coingeckoId:"solana"}};import{PublicKey as M}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as fe}from"@solana/spl-token";import{PublicKey as u,SystemProgram as ge,SYSVAR_RENT_PUBKEY as be}from"@solana/web3.js";function R({pubkey:n,isSigner:r=!1,isWritable:e=!0}){return{pubkey:n,isWritable:e,isSigner:r}}var pn=[R({pubkey:fe,isWritable:!1}),R({pubkey:ge.programId,isWritable:!1}),R({pubkey:be,isWritable:!1})];function Z({publicKey:n,transformSol:r}){if(n instanceof u)return r&&n.equals(B)?X:n;if(r&&n===B.toBase58())return X;if(typeof n=="string")try{return new u(n)}catch{throw new Error("invalid public key")}throw new Error("invalid public key")}var ln=new u("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),dn=new u("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),fn=new u("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),gn=new u("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),bn=new u("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),hn=new u("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),Nn=new u("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),wn=new u("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),xn=new u("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),yn=new u("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),Wn=new u("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),X=new u("So11111111111111111111111111111111111111112"),B=u.default;var q=class{constructor({mint:r,decimals:e,symbol:t="UNKNOWN",name:i="UNKNOWN",skipMint:g=!1}){if(r===B.toBase58()||r instanceof M&&B.equals(r)){this.decimals=N.decimals,this.symbol=N.symbol,this.name=N.name,this.mint=new M(N.mint);return}this.decimals=e,this.symbol=t,this.name=i,this.mint=g?M.default:Z({publicKey:r})}equals(r){return this===r?!0:this.mint.equals(r.mint)}},y=q;y.WSOL=new q(N);var C=class{constructor({decimals:r,symbol:e="UNKNOWN",name:t="UNKNOWN"}){this.decimals=r,this.symbol=e,this.name=t}equals(r){return this===r}},A=C;A.SOL=new C(z);var $=new o(Y),w=class extends o{toSignificant(r=5,e,t){return this.mul($).toSignificant(r,e,t)}toFixed(r=2,e,t){return this.mul($).toFixed(r,e,t)}};var he=l("Raydium_price"),f=class extends o{constructor(e){let{baseToken:t,quoteToken:i,numerator:g,denominator:b}=e;super(g,b);this.baseToken=t,this.quoteToken=i,this.scalar=new o(L(t.decimals),L(i.decimals))}get raw(){return new o(this.numerator,this.denominator)}get adjusted(){return super.mul(this.scalar)}invert(){return new f({baseToken:this.quoteToken,quoteToken:this.baseToken,denominator:this.numerator,numerator:this.denominator})}mul(e){this.quoteToken!==e.baseToken&&he.logWithError("mul token not equals");let t=super.mul(e);return new f({baseToken:this.baseToken,quoteToken:e.quoteToken,denominator:t.denominator,numerator:t.numerator})}toSignificant(e=this.quoteToken.decimals,t,i){return this.adjusted.toSignificant(e,t,i)}toFixed(e=this.quoteToken.decimals,t,i){return this.adjusted.toFixed(e,t,i)}};function s(n){if(n instanceof w)return new o(n.numerator,n.denominator);if(n instanceof f)return n.adjusted;if(n instanceof d)try{return s(n.toExact())}catch{return new o(h)}if(n instanceof o)return n;let r=String(n),e=E(r);return new o(e.numerator,e.denominator)}function Qn(n){var t;if(n instanceof w)return{fr:new o(n.numerator,n.denominator)};if(n instanceof f)return{fr:n.adjusted};if(n instanceof d)return{fr:s(n.toExact()),decimals:n.token.decimals};if(n instanceof o)return{fr:n};let r=String(n),e=E(r);return{fr:new o(e.numerator,e.denominator),decimals:(t=e.dec)==null?void 0:t.length}}function er(n,r){if(n==null||r==null)return!1;let e=s(n),t=s(r);return e.sub(t).numerator,e.sub(t).numerator.lt(h)}function Ne(n,r){if(n==null||r==null)return!1;let e=s(n),t=s(r);return e.sub(t).numerator.gt(h)}function nr(n,r){if(n==null||r==null)return!1;let e=s(n),t=s(r);return e.sub(t).numerator.lte(h)}function rr(n,r){if(n==null||r==null)return!1;let e=s(n),t=s(r);return e.sub(t).numerator.gte(h)}function we(n,r){if(n==null||r==null)return!1;let e=s(n),t=s(r);return e.sub(t).numerator.eq(h)}function tr(n,r){if(n==null||r==null)return;let e=s(n),t=s(r);try{return e.div(t)}catch{return e}}function or(n,r){if(n==null||r==null)return;let e=s(n),t=s(r);return e.sub(t)}function ir(n){return n==null?!1:!we(n,0)}function sr(n,r){return Ne(r,n)?r:n}export{s as default,tr as div,we as eq,sr as getMax,Ne as gt,rr as gte,ir as isMeaningfulNumber,er as lt,nr as lte,or as sub,Qn as toFractionWithDecimals};
//# sourceMappingURL=fractionUtil.mjs.map