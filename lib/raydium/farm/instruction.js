var te=Object.create;var S=Object.defineProperty,re=Object.defineProperties,oe=Object.getOwnPropertyDescriptor,ne=Object.getOwnPropertyDescriptors,ae=Object.getOwnPropertyNames,K=Object.getOwnPropertySymbols,se=Object.getPrototypeOf,E=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable;var N=(t,e,r)=>e in t?S(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,L=(t,e)=>{for(var r in e||(e={}))E.call(e,r)&&N(t,r,e[r]);if(K)for(var r of K(e))ue.call(e,r)&&N(t,r,e[r]);return t},h=(t,e)=>re(t,ne(e));var ie=(t,e)=>{for(var r in e)S(t,r,{get:e[r],enumerable:!0})},D=(t,e,r,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of ae(e))!E.call(t,a)&&a!==r&&S(t,a,{get:()=>e[a],enumerable:!(s=oe(e,a))||s.enumerable});return t};var V=(t,e,r)=>(r=t!=null?te(se(t)):{},D(e||!t||!t.__esModule?S(r,"default",{value:t,enumerable:!0}):r,t)),ce=t=>D(S({},"__esModule",{value:!0}),t);var Te={};ie(Te,{createAssociatedLedgerAccountInstruction:()=>he,makeCreateFarmInstruction:()=>_e});module.exports=ce(Te);var g=require("@solana/web3.js"),$=V(require("bn.js"));var _=require("lodash"),k=V(require("dayjs")),G=V(require("dayjs/plugin/utc"));k.default.extend(G.default);var F=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return(0,k.default)().utc().format("YYYY/MM/DD HH:mm:ss UTC")}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let r=e.map(s=>typeof s=="object"?JSON.stringify(s):s).join(", ");throw new Error(r)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},C={},de={};function R(t){let e=(0,_.get)(C,t);if(!e){let r=(0,_.get)(de,t);e=new F({name:t,logLevel:r}),(0,_.set)(C,t,e)}return e}var W=require("@solana/spl-token"),c=require("@solana/web3.js");function i({pubkey:t,isSigner:e=!1,isWritable:r=!0}){return{pubkey:t,isWritable:r,isSigner:e}}var O=[i({pubkey:W.TOKEN_PROGRAM_ID,isWritable:!1}),i({pubkey:c.SystemProgram.programId,isWritable:!1}),i({pubkey:c.SYSVAR_RENT_PUBKEY,isWritable:!1})];var Fe=new c.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),ke=new c.PublicKey("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),Ae=new c.PublicKey("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),Me=new c.PublicKey("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),Ie=new c.PublicKey("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),Ue=new c.PublicKey("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),ve=new c.PublicKey("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),Ke=new c.PublicKey("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),Ne=new c.PublicKey("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),Ee=new c.PublicKey("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),De=new c.PublicKey("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Ce=new c.PublicKey("So11111111111111111111111111111111111111112"),Y=c.PublicKey.default;var z=require("@solana/web3.js"),b=V(require("bn.js"));var n=require("@solana/buffer-layout"),A=n.Layout,j=n.Structure;var q=n.UInt;var X=n.seq;var T=n.blob;var B=class extends A{constructor(r,s,a){super(r,a);this.blob=T(r),this.signed=s}decode(r,s=0){let a=new b.default(this.blob.decode(r,s),10,"le");return this.signed?a.fromTwos(this.span*8).clone():a}encode(r,s,a=0){return typeof r=="number"&&(r=new b.default(r)),this.signed&&(r=r.toTwos(this.span*8)),this.blob.encode(r.toArrayLike(Buffer,"le",this.span),s,a)}};function P(t){return new q(1,t)}function o(t){return new B(8,!1,t)}function f(t){return new B(16,!1,t)}var M=class extends A{constructor(r,s,a,p){super(r.span,p);this.layout=r,this.decoder=s,this.encoder=a}decode(r,s){return this.decoder(this.layout.decode(r,s))}encode(r,s,a){return this.layout.encode(this.encoder(r),s,a)}getSpan(r,s){return this.layout.getSpan(r,s)}};function u(t){return new M(T(32),e=>new z.PublicKey(e),e=>e.toBuffer(),t)}var I=class extends j{decode(e,r){return super.decode(e,r)}};function d(t,e,r){return new I(t,e,r)}function y(t,e,r){let s,a=typeof e=="number"?e:(0,b.isBN)(e)?e.toNumber():new Proxy(e,{get(p,l){if(!s){let m=Reflect.get(p,"count");s=(0,b.isBN)(m)?m.toNumber():m,Reflect.set(p,"count",s)}return Reflect.get(p,l)},set(p,l,m){return l==="count"&&(s=m),Reflect.set(p,l,m)}});return X(t,a,r)}var w=require("@solana/web3.js");var ot=R("Raydium_farm_config"),H="EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q",nt=new w.PublicKey(H),J="9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z",at=new w.PublicKey(J),Z="FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG",st=new w.PublicKey(Z),ut={[H]:3,[J]:5,[Z]:6};var it=new w.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),ct=new w.PublicKey("FrspKwj8i3pNmKwXreTveC4fu7KL5ZbGeXdZBe2XViu1");var Q={"Standard SPL":0,"Option tokens":1};var U=d([P("instruction")]),Pt=d([P("instruction")]),ge=d([o("rewardState"),o("rewardOpenTime"),o("rewardEndTime"),o("rewardLastUpdateTime"),o("totalReward"),o("totalRewardEmissioned"),o("rewardClaimed"),o("rewardPerSecond"),f("accRewardPerShare"),u("rewardVault"),u("rewardMint"),u("rewardSender"),o("rewardType"),y(o(),15,"padding")]),Le=d([o("state"),o("nonce"),u("lpVault"),u("rewardVault"),u(),u(),o(),o(),o("totalReward"),f("perShareReward"),o("lastSlot"),o("perSlotReward")]),xe=d([o("state"),o("nonce"),u("lpVault"),u("rewardVaultA"),o("totalRewardA"),f("perShareRewardA"),o("perSlotRewardA"),P("option"),u("rewardVaultB"),T(7),o("totalRewardB"),f("perShareRewardB"),o("perSlotRewardB"),o("lastSlot"),u()]),be=d([o(),o("state"),o("nonce"),o("validRewardTokenNum"),f("rewardMultiplier"),o("rewardPeriodMax"),o("rewardPeriodMin"),o("rewardPeriodExtend"),u("lpMint"),u("lpVault"),y(ge,5,"rewardInfos"),u("creator"),u(),y(o(),32,"padding")]),ye=new Proxy(Le,{get(t,e,r){return e==="decode"?(...s)=>{let a=t.decode(...s);return h(L({},a),{version:3,rewardInfos:[{rewardVault:a.rewardVault,totalReward:a.totalReward,perSlotReward:a.perSlotReward,perShareReward:a.perShareReward}]})}:Reflect.get(t,e,r)}}),pe=new Proxy(xe,{get(t,e,r){return e==="decode"?(...s)=>{let a=t.decode(...s);return h(L({},a),{version:5,rewardInfos:[{rewardVault:a.rewardVaultA,totalReward:a.totalRewardA,perSlotReward:a.perSlotRewardA,perShareReward:a.perShareRewardA},{rewardVault:a.rewardVaultB,totalReward:a.totalRewardB,perSlotReward:a.perSlotRewardB,perShareReward:a.perShareRewardB}]})}:Reflect.get(t,e,r)}}),me=new Proxy(be,{get(t,e,r){return e==="decode"?(...s)=>{let a=t.decode(...s);return h(L({},a),{version:6,rewardInfos:a.rewardInfos.map(p=>{var l;return h(L({},p),{rewardType:((l=Object.entries(Q).find(m=>String(m[1])===p.rewardType.toString()))!=null?l:["Standard SPL"])[0]})})})}:Reflect.get(t,e,r)}}),we=d([o("isSet"),o("rewardPerSecond"),o("rewardOpenTime"),o("rewardEndTime"),o("rewardType")]),v=d([P("instruction"),o("nonce"),y(we,5,"rewardTimeInfo")]),gt=d([P("instruction"),o("rewardReopenTime"),o("rewardEndTime"),o("rewardPerSecond")]),Lt=d([P("instruction"),o("isSet"),o("rewardPerSecond"),o("rewardOpenTime"),o("rewardEndTime")]),xt=d([o("state"),u("id"),u("owner"),o("deposited"),y(o(),1,"rewardDebts")]),le=d([o("state"),u("id"),u("owner"),o("deposited"),y(f(),1,"rewardDebts"),y(o(),17)]),bt=d([o("state"),u("id"),u("owner"),o("deposited"),y(o(),2,"rewardDebts")]),fe=d([o("state"),u("id"),u("owner"),o("deposited"),y(f(),2,"rewardDebts"),y(o(),17)]),Pe=d([o(),o("state"),u("id"),u("owner"),o("deposited"),y(f(),5,"rewardDebts"),y(o(),16)]),wt=d([P("instruction"),o("amount")]);var Se=R("Raydium_farm_instruction");async function he(t){let{version:e,id:r,ledger:s,programId:a,owner:p}=t,l={3:9,5:10}[e];l||Se.logWithError(`invalid farm pool version: ${e}`);let m=Buffer.alloc(U.span);U.encode({instruction:l},m);let ee=[i({pubkey:r}),i({pubkey:s}),i({pubkey:p,isWritable:!1}),i({pubkey:g.SystemProgram.programId,isWritable:!1}),i({pubkey:g.SYSVAR_RENT_PUBKEY,isWritable:!1})];return new g.TransactionInstruction({programId:a,keys:ee,data:m})}function _e(t){var s;let e=Buffer.alloc(v.span);v.encode({instruction:0,nonce:new $.default(t.nonce),rewardTimeInfo:t.rewardInfoConfig},e);let r=[...O,i({pubkey:t.farmKeyPair.publicKey}),i({pubkey:t.farmAuthority,isWritable:!1}),i({pubkey:t.lpVault}),i({pubkey:t.lpMint,isWritable:!1}),i({pubkey:t.lockVault}),i({pubkey:t.lockMint,isWritable:!1}),i({pubkey:(s=t.lockUserAccount)!=null?s:Y}),i({pubkey:t.owner,isWritable:!1,isSigner:!0})];for(let a of t.rewardInfo)r.push(i({pubkey:a.rewardMint,isWritable:!1}),i({pubkey:a.rewardVault}),i({pubkey:a.userRewardToken}));return new g.TransactionInstruction({programId:t.programId,keys:r,data:e})}0&&(module.exports={createAssociatedLedgerAccountInstruction,makeCreateFarmInstruction});
//# sourceMappingURL=instruction.js.map