var ee=Object.create;var S=Object.defineProperty,te=Object.defineProperties,re=Object.getOwnPropertyDescriptor,oe=Object.getOwnPropertyDescriptors,ne=Object.getOwnPropertyNames,U=Object.getOwnPropertySymbols,ae=Object.getPrototypeOf,v=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var K=(e,t,r)=>t in e?S(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,L=(e,t)=>{for(var r in t||(t={}))v.call(t,r)&&K(e,r,t[r]);if(U)for(var r of U(t))se.call(t,r)&&K(e,r,t[r]);return e},h=(e,t)=>te(e,oe(t));var ue=(e,t)=>{for(var r in t)S(e,r,{get:t[r],enumerable:!0})},N=(e,t,r,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of ne(t))!v.call(e,a)&&a!==r&&S(e,a,{get:()=>t[a],enumerable:!(s=re(t,a))||s.enumerable});return e};var V=(e,t,r)=>(r=e!=null?ee(ae(e)):{},N(t||!e||!e.__esModule?S(r,"default",{value:e,enumerable:!0}):r,e)),ie=e=>N(S({},"__esModule",{value:!0}),e);var Ve={};ue(Ve,{createAssociatedLedgerAccountInstruction:()=>_e,makeCreateFarmInstruction:()=>Te});module.exports=ie(Ve);var x=require("@solana/web3.js"),Q=V(require("bn.js"));var _=require("lodash"),D=V(require("pino")),C=V(require("pino-pretty")),E={},ce={},de=(0,C.default)({colorize:!0,levelFirst:!0,translateTime:"SYS:yyyymmdd HH:MM:ss.l"}),ye=(0,D.default)({base:null,level:"silent"},de);function R(e){let t=(0,_.get)(E,e);if(!t){let r=(0,_.get)(ce,e);t=ye.child({name:e},{level:r}),(0,_.set)(E,e,t)}return t.logWithError=(...r)=>{let s=r.map(a=>typeof a=="object"?JSON.stringify(a):a).join(", ");throw new Error(s)},t}var G=require("@solana/spl-token"),c=require("@solana/web3.js");function i({pubkey:e,isSigner:t=!1,isWritable:r=!0}){return{pubkey:e,isWritable:r,isSigner:t}}var W=[i({pubkey:G.TOKEN_PROGRAM_ID,isWritable:!1}),i({pubkey:c.SystemProgram.programId,isWritable:!1}),i({pubkey:c.SYSVAR_RENT_PUBKEY,isWritable:!1})];var Me=new c.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),Ie=new c.PublicKey("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),Ue=new c.PublicKey("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),Ke=new c.PublicKey("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),ve=new c.PublicKey("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),Ne=new c.PublicKey("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),Ee=new c.PublicKey("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),De=new c.PublicKey("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),Ce=new c.PublicKey("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),Ge=new c.PublicKey("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),We=new c.PublicKey("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Oe=new c.PublicKey("So11111111111111111111111111111111111111112"),O=c.PublicKey.default;var X=require("@solana/web3.js"),g=V(require("bn.js"));var n=require("@solana/buffer-layout"),F=n.Layout,Y=n.Structure;var j=n.UInt;var q=n.seq;var T=n.blob;var B=class extends F{constructor(r,s,a){super(r,a);this.blob=T(r),this.signed=s}decode(r,s=0){let a=new g.default(this.blob.decode(r,s),10,"le");return this.signed?a.fromTwos(this.span*8).clone():a}encode(r,s,a=0){return typeof r=="number"&&(r=new g.default(r)),this.signed&&(r=r.toTwos(this.span*8)),this.blob.encode(r.toArrayLike(Buffer,"le",this.span),s,a)}};function P(e){return new j(1,e)}function o(e){return new B(8,!1,e)}function f(e){return new B(16,!1,e)}var k=class extends F{constructor(r,s,a,p){super(r.span,p);this.layout=r,this.decoder=s,this.encoder=a}decode(r,s){return this.decoder(this.layout.decode(r,s))}encode(r,s,a){return this.layout.encode(this.encoder(r),s,a)}getSpan(r,s){return this.layout.getSpan(r,s)}};function u(e){return new k(T(32),t=>new X.PublicKey(t),t=>t.toBuffer(),e)}var A=class extends Y{decode(t,r){return super.decode(t,r)}};function d(e,t,r){return new A(e,t,r)}function y(e,t,r){let s,a=typeof t=="number"?t:(0,g.isBN)(t)?t.toNumber():new Proxy(t,{get(p,l){if(!s){let m=Reflect.get(p,"count");s=(0,g.isBN)(m)?m.toNumber():m,Reflect.set(p,"count",s)}return Reflect.get(p,l)},set(p,l,m){return l==="count"&&(s=m),Reflect.set(p,l,m)}});return q(e,a,r)}var w=require("@solana/web3.js");var st=R("Raydium_farm_config"),z="EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q",ut=new w.PublicKey(z),H="9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z",it=new w.PublicKey(H),J="FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG",ct=new w.PublicKey(J),dt={[z]:3,[H]:5,[J]:6};var yt=new w.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),pt=new w.PublicKey("FrspKwj8i3pNmKwXreTveC4fu7KL5ZbGeXdZBe2XViu1");var Z={"Standard SPL":0,"Option tokens":1};var M=d([P("instruction")]),bt=d([P("instruction")]),Le=d([o("rewardState"),o("rewardOpenTime"),o("rewardEndTime"),o("rewardLastUpdateTime"),o("totalReward"),o("totalRewardEmissioned"),o("rewardClaimed"),o("rewardPerSecond"),f("accRewardPerShare"),u("rewardVault"),u("rewardMint"),u("rewardSender"),o("rewardType"),y(o(),15,"padding")]),be=d([o("state"),o("nonce"),u("lpVault"),u("rewardVault"),u(),u(),o(),o(),o("totalReward"),f("perShareReward"),o("lastSlot"),o("perSlotReward")]),ge=d([o("state"),o("nonce"),u("lpVault"),u("rewardVaultA"),o("totalRewardA"),f("perShareRewardA"),o("perSlotRewardA"),P("option"),u("rewardVaultB"),T(7),o("totalRewardB"),f("perShareRewardB"),o("perSlotRewardB"),o("lastSlot"),u()]),we=d([o(),o("state"),o("nonce"),o("validRewardTokenNum"),f("rewardMultiplier"),o("rewardPeriodMax"),o("rewardPeriodMin"),o("rewardPeriodExtend"),u("lpMint"),u("lpVault"),y(Le,5,"rewardInfos"),u("creator"),u(),y(o(),32,"padding")]),pe=new Proxy(be,{get(e,t,r){return t==="decode"?(...s)=>{let a=e.decode(...s);return h(L({},a),{version:3,rewardInfos:[{rewardVault:a.rewardVault,totalReward:a.totalReward,perSlotReward:a.perSlotReward,perShareReward:a.perShareReward}]})}:Reflect.get(e,t,r)}}),me=new Proxy(ge,{get(e,t,r){return t==="decode"?(...s)=>{let a=e.decode(...s);return h(L({},a),{version:5,rewardInfos:[{rewardVault:a.rewardVaultA,totalReward:a.totalRewardA,perSlotReward:a.perSlotRewardA,perShareReward:a.perShareRewardA},{rewardVault:a.rewardVaultB,totalReward:a.totalRewardB,perSlotReward:a.perSlotRewardB,perShareReward:a.perShareRewardB}]})}:Reflect.get(e,t,r)}}),le=new Proxy(we,{get(e,t,r){return t==="decode"?(...s)=>{let a=e.decode(...s);return h(L({},a),{version:6,rewardInfos:a.rewardInfos.map(p=>{var l;return h(L({},p),{rewardType:((l=Object.entries(Z).find(m=>String(m[1])===p.rewardType.toString()))!=null?l:["Standard SPL"])[0]})})})}:Reflect.get(e,t,r)}}),Se=d([o("isSet"),o("rewardPerSecond"),o("rewardOpenTime"),o("rewardEndTime"),o("rewardType")]),I=d([P("instruction"),o("nonce"),y(Se,5,"rewardTimeInfo")]),gt=d([P("instruction"),o("rewardReopenTime"),o("rewardEndTime"),o("rewardPerSecond")]),wt=d([P("instruction"),o("isSet"),o("rewardPerSecond"),o("rewardOpenTime"),o("rewardEndTime")]),St=d([o("state"),u("id"),u("owner"),o("deposited"),y(o(),1,"rewardDebts")]),fe=d([o("state"),u("id"),u("owner"),o("deposited"),y(f(),1,"rewardDebts"),y(o(),17)]),ht=d([o("state"),u("id"),u("owner"),o("deposited"),y(o(),2,"rewardDebts")]),Pe=d([o("state"),u("id"),u("owner"),o("deposited"),y(f(),2,"rewardDebts"),y(o(),17)]),xe=d([o(),o("state"),u("id"),u("owner"),o("deposited"),y(f(),5,"rewardDebts"),y(o(),16)]),_t=d([P("instruction"),o("amount")]);var he=R("Raydium_farm_instruction");async function _e(e){let{version:t,id:r,ledger:s,programId:a,owner:p}=e,l={3:9,5:10}[t];l||he.logWithError(`invalid farm pool version: ${t}`);let m=Buffer.alloc(M.span);M.encode({instruction:l},m);let $=[i({pubkey:r}),i({pubkey:s}),i({pubkey:p,isWritable:!1}),i({pubkey:x.SystemProgram.programId,isWritable:!1}),i({pubkey:x.SYSVAR_RENT_PUBKEY,isWritable:!1})];return new x.TransactionInstruction({programId:a,keys:$,data:m})}function Te(e){var s;let t=Buffer.alloc(I.span);I.encode({instruction:0,nonce:new Q.default(e.nonce),rewardTimeInfo:e.rewardInfoConfig},t);let r=[...W,i({pubkey:e.farmKeyPair.publicKey}),i({pubkey:e.farmAuthority,isWritable:!1}),i({pubkey:e.lpVault}),i({pubkey:e.lpMint,isWritable:!1}),i({pubkey:e.lockVault}),i({pubkey:e.lockMint,isWritable:!1}),i({pubkey:(s=e.lockUserAccount)!=null?s:O}),i({pubkey:e.owner,isWritable:!1,isSigner:!0})];for(let a of e.rewardInfo)r.push(i({pubkey:a.rewardMint,isWritable:!1}),i({pubkey:a.rewardVault}),i({pubkey:a.userRewardToken}));return new x.TransactionInstruction({programId:e.programId,keys:r,data:t})}0&&(module.exports={createAssociatedLedgerAccountInstruction,makeCreateFarmInstruction});
//# sourceMappingURL=instruction.js.map