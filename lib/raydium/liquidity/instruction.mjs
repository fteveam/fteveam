var xe=Object.defineProperty,Pe=Object.defineProperties;var ke=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var te=(t,e,r)=>e in t?xe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,S=(t,e)=>{for(var r in e||(e={}))ne.call(e,r)&&te(t,r,e[r]);if(D)for(var r of D(e))re.call(e,r)&&te(t,r,e[r]);return t},E=(t,e)=>Pe(t,ke(e));var oe=(t,e)=>{var r={};for(var i in t)ne.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&D)for(var i of D(t))e.indexOf(i)<0&&re.call(t,i)&&(r[i]=t[i]);return r};import{TOKEN_PROGRAM_ID as ee}from"@solana/spl-token";import{SystemProgram as Ke,TransactionInstruction as h}from"@solana/web3.js";import y from"bn.js";import _e from"big.js";import ft from"bn.js";import{get as ie,set as he}from"lodash";import Le from"pino";import Se from"pino-pretty";var ue={},we={},Te=Se({colorize:!0,levelFirst:!0,translateTime:"SYS:yyyymmdd HH:MM:ss.l"}),Be=Le({base:null,level:"silent"},Te);function k(t){let e=ie(ue,t);if(!e){let r=ie(we,t);e=Be.child({name:t},{level:r}),he(ue,t,e)}return e.logWithError=(...r)=>{let i=r.map(u=>typeof u=="object"?JSON.stringify(u):u).join(", ");throw new Error(i)},e}import Ne from"toformat";var We=Ne,w=We;import _ from"big.js";import Ie from"decimal.js-light";var q=k("module/fraction"),F=w(_),T=w(Ie),De={[0]:T.ROUND_DOWN,[1]:T.ROUND_HALF_UP,[2]:T.ROUND_UP},Ee={[0]:_.roundDown,[1]:_.roundHalfUp,[2]:_.roundUp},m=class{constructor(e,r=ae){this.numerator=p(e),this.denominator=p(r)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new m(this.denominator,this.numerator)}add(e){let r=e instanceof m?e:new m(p(e));return this.denominator.eq(r.denominator)?new m(this.numerator.add(r.numerator),this.denominator):new m(this.numerator.mul(r.denominator).add(r.numerator.mul(this.denominator)),this.denominator.mul(r.denominator))}sub(e){let r=e instanceof m?e:new m(p(e));return this.denominator.eq(r.denominator)?new m(this.numerator.sub(r.numerator),this.denominator):new m(this.numerator.mul(r.denominator).sub(r.numerator.mul(this.denominator)),this.denominator.mul(r.denominator))}mul(e){let r=e instanceof m?e:new m(p(e));return new m(this.numerator.mul(r.numerator),this.denominator.mul(r.denominator))}div(e){let r=e instanceof m?e:new m(p(e));return new m(this.numerator.mul(r.denominator),this.denominator.mul(r.numerator))}toSignificant(e,r={groupSeparator:""},i=1){Number.isInteger(e)||q.logWithError(`${e} is not an integer.`),e<=0&&q.logWithError(`${e} is not positive.`),T.set({precision:e+1,rounding:De[i]});let u=new T(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return u.toFormat(u.decimalPlaces(),r)}toFixed(e,r={groupSeparator:""},i=1){return Number.isInteger(e)||q.logWithError(`${e} is not an integer.`),e<0&&q.logWithError(`${e} is negative.`),F.DP=e,F.RM=Ee[i]||1,new F(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,r)}isZero(){return this.numerator.isZero()}};var wt=k("Raydium_amount"),Tt=w(_e);import{PublicKey as Ae}from"@solana/web3.js";var se={symbol:"SOL",name:"Solana",decimals:9},L={symbol:"WSOL",name:"Wrapped SOL",mint:"So11111111111111111111111111111111111111112",decimals:9,extensions:{coingeckoId:"solana"}},Wt={isQuantumSOL:!0,isLp:!1,official:!0,mint:new Ae(L.mint),decimals:9,symbol:"SOL",id:"sol",name:"solana",icon:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",extensions:{coingeckoId:"solana"}};import{PublicKey as v}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Me}from"@solana/spl-token";import{PublicKey as b,SystemProgram as Ue,SYSVAR_RENT_PUBKEY as Fe}from"@solana/web3.js";function n({pubkey:t,isSigner:e=!1,isWritable:r=!0}){return{pubkey:t,isWritable:r,isSigner:e}}var R=[n({pubkey:Me,isWritable:!1}),n({pubkey:Ue.programId,isWritable:!1}),n({pubkey:Fe,isWritable:!1})];function me({publicKey:t,transformSol:e}){if(t instanceof b)return e&&t.equals(B)?ce:t;if(e&&t===B.toBase58())return ce;if(typeof t=="string")try{return new b(t)}catch{throw new Error("invalid public key")}throw new Error("invalid public key")}var _t=new b("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),Ot=new b("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),At=new b("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),Mt=new b("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),Ut=new b("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),Ft=new b("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),Rt=new b("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),vt=new b("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),Vt=new b("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),Ct=new b("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),jt=new b("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),ce=new b("So11111111111111111111111111111111111111112"),B=b.default;var V=class{constructor({mint:e,decimals:r,symbol:i="UNKNOWN",name:u="UNKNOWN",skipMint:s=!1}){if(e===B.toBase58()||e instanceof v&&B.equals(e)){this.decimals=L.decimals,this.symbol=L.symbol,this.name=L.name,this.mint=new v(L.mint);return}this.decimals=r,this.symbol=i,this.name=u,this.mint=s?v.default:me({publicKey:e})}equals(e){return this===e?!0:this.mint.equals(e.mint)}},N=V;N.WSOL=new V(L);var j=class{constructor({decimals:e,symbol:r="UNKNOWN",name:i="UNKNOWN"}){this.decimals=e,this.symbol=r,this.name=i}equals(e){return this===e}},C=j;C.SOL=new j(se);var nn=new m(pe);var mn=k("Raydium_price");var O=k("Raydium_bignumber");var Nn=new y(0),ae=new y(1),Wn=new y(2),In=new y(3),Dn=new y(5),Oe=new y(10),pe=new y(100),En=new y(1e3),qn=new y(1e4),le=9007199254740991;function p(t){if(t instanceof y)return t;if(typeof t=="string"){if(t.match(/^-?[0-9]+$/))return new y(t);O.logWithError(`invalid BigNumberish string: ${t}`)}return typeof t=="number"?(t%1&&O.logWithError(`BigNumberish number underflow: ${t}`),(t>=le||t<=-le)&&O.logWithError(`BigNumberish number overflow: ${t}`),new y(String(t))):typeof t=="bigint"?new y(t.toString()):(O.logWithError(`invalid BigNumberish value: ${t}`),new y(0))}import{PublicKey as Ye}from"@solana/web3.js";import fe,{isBN as ge}from"bn.js";import{bits as An,BitStructure as Mn,blob as Re,Blob as Un,cstr as Fn,f32 as Rn,f32be as vn,f64 as Vn,f64be as Cn,greedy as jn,Layout as ve,ns64 as Yn,ns64be as Qn,nu64 as zn,nu64be as Hn,offset as Kn,s16 as Xn,s16be as Gn,s24 as Zn,s24be as Jn,s32 as $n,s32be as er,s40 as tr,s40be as nr,s48 as rr,s48be as or,s8 as ir,seq as Ve,struct as ur,Structure as Ce,u16 as ar,u16be as sr,u24 as cr,u24be as mr,u32 as pr,u32be as lr,u40 as dr,u40be as br,u48 as yr,u48be as fr,u8 as gr,UInt as je,union as xr,Union as Pr,unionLayoutDiscriminator as kr,utf8 as hr}from"@solana/buffer-layout";var Y=ve,de=Ce;var be=je;var ye=Ve;var Q=Re;var A=class extends Y{constructor(r,i,u){super(r,u);this.blob=Q(r),this.signed=i}decode(r,i=0){let u=new fe(this.blob.decode(r,i),10,"le");return this.signed?u.fromTwos(this.span*8).clone():u}encode(r,i,u=0){return typeof r=="number"&&(r=new fe(r)),this.signed&&(r=r.toTwos(this.span*8)),this.blob.encode(r.toArrayLike(Buffer,"le",this.span),i,u)}};function x(t){return new be(1,t)}function o(t){return new A(8,!1,t)}function P(t){return new A(16,!1,t)}var z=class extends Y{constructor(r,i,u,s){super(r.span,s);this.layout=r,this.decoder=i,this.encoder=u}decode(r,i){return this.decoder(this.layout.decode(r,i))}encode(r,i,u){return this.layout.encode(this.encoder(r),i,u)}getSpan(r,i){return this.layout.getSpan(r,i)}};function c(t){return new z(Q(32),e=>new Ye(e),e=>e.toBuffer(),t)}var H=class extends de{decode(e,r){return super.decode(e,r)}};function f(t,e,r){return new H(t,e,r)}function W(t,e,r){let i,u=typeof e=="number"?e:ge(e)?e.toNumber():new Proxy(e,{get(s,a){if(!i){let g=Reflect.get(s,"count");i=ge(g)?g.toNumber():g,Reflect.set(s,"count",i)}return Reflect.get(s,a)},set(s,a,g){return a==="count"&&(i=g),Reflect.set(s,a,g)}});return ye(t,u,r)}var K=f([x("instruction"),o("amountIn"),o("minAmountOut")]),X=f([x("instruction"),o("maxAmountIn"),o("amountOut")]),G=f([x("instruction"),x("nonce")]),Z=f([x("instruction"),x("nonce"),o("startTime")]),Ur=f([o("status"),o("nonce"),o("maxOrder"),o("depth"),o("baseDecimal"),o("quoteDecimal"),o("state"),o("resetFlag"),o("minSize"),o("volMaxCutRatio"),o("amountWaveRatio"),o("baseLotSize"),o("quoteLotSize"),o("minPriceMultiplier"),o("maxPriceMultiplier"),o("systemDecimalValue"),o("minSeparateNumerator"),o("minSeparateDenominator"),o("tradeFeeNumerator"),o("tradeFeeDenominator"),o("pnlNumerator"),o("pnlDenominator"),o("swapFeeNumerator"),o("swapFeeDenominator"),o("baseNeedTakePnl"),o("quoteNeedTakePnl"),o("quoteTotalPnl"),o("baseTotalPnl"),P("quoteTotalDeposited"),P("baseTotalDeposited"),P("swapBaseInAmount"),P("swapQuoteOutAmount"),o("swapBase2QuoteFee"),P("swapQuoteInAmount"),P("swapBaseOutAmount"),o("swapQuote2BaseFee"),c("baseVault"),c("quoteVault"),c("baseMint"),c("quoteMint"),c("lpMint"),c("openOrders"),c("marketId"),c("marketProgramId"),c("targetOrders"),c("withdrawQueue"),c("lpVault"),c("owner"),o("lpReserve"),W(o(),3,"padding")]),Fr=f([o("accountType"),o("status"),o("nonce"),o("maxOrder"),o("depth"),o("baseDecimal"),o("quoteDecimal"),o("state"),o("resetFlag"),o("minSize"),o("volMaxCutRatio"),o("amountWaveRatio"),o("baseLotSize"),o("quoteLotSize"),o("minPriceMultiplier"),o("maxPriceMultiplier"),o("systemDecimalsValue"),o("abortTradeFactor"),o("priceTickMultiplier"),o("priceTick"),o("minSeparateNumerator"),o("minSeparateDenominator"),o("tradeFeeNumerator"),o("tradeFeeDenominator"),o("pnlNumerator"),o("pnlDenominator"),o("swapFeeNumerator"),o("swapFeeDenominator"),o("baseNeedTakePnl"),o("quoteNeedTakePnl"),o("quoteTotalPnl"),o("baseTotalPnl"),o("poolOpenTime"),o("punishPcAmount"),o("punishCoinAmount"),o("orderbookToInitTime"),P("swapBaseInAmount"),P("swapQuoteOutAmount"),P("swapQuoteInAmount"),P("swapBaseOutAmount"),o("swapQuote2BaseFee"),o("swapBase2QuoteFee"),c("baseVault"),c("quoteVault"),c("baseMint"),c("quoteMint"),c("lpMint"),c("modelDataAccount"),c("openOrders"),c("marketId"),c("marketProgramId"),c("targetOrders"),c("owner"),W(o(),64,"padding")]),J=f([x("instruction"),o("baseAmountIn"),o("quoteAmountIn"),o("fixedSide")]),$=f([x("instruction"),o("amountIn")]);import{PublicKey as Qe}from"@solana/web3.js";var I=new Qe("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),ze=5e4,He=f([o("x"),o("y"),o("price")]),jr=f([o("accountType"),o("status"),o("multiplier"),o("validDataCount"),W(He,ze,"DataElement")]);var M=k("Raydium_liquidity_instruction");function eo(t){let{poolKeys:e,userKeys:r,amountIn:i,amountOut:u,fixedSide:s}=t,{version:a}=e;if(a===4||a===5){let g={poolKeys:e,userKeys:r};if(s==="in")return Xe(E(S({},g),{amountIn:i,minAmountOut:u}),a);if(s==="out")return Ge(E(S({},g),{maxAmountIn:i,amountOut:u}),a);M.logWithError("invalid params","params",t)}throw M.logWithError("invalid version","poolKeys.version",a),new Error("invalid version")}function to(t){let e=f([x("instruction"),x("simulateType")]),r=Buffer.alloc(e.span);e.encode({instruction:12,simulateType:0},r);let i=[n({pubkey:t.id,isWritable:!1}),n({pubkey:t.authority,isWritable:!1}),n({pubkey:t.openOrders,isWritable:!1}),n({pubkey:t.baseVault,isWritable:!1}),n({pubkey:t.quoteVault,isWritable:!1}),n({pubkey:t.lpMint,isWritable:!1}),n({pubkey:t.marketId,isWritable:!1})];return new h({programId:t.programId,keys:i,data:r})}function Xe({poolKeys:t,userKeys:e,amountIn:r,minAmountOut:i},u){let s=Buffer.alloc(K.span);K.encode({instruction:9,amountIn:p(r),minAmountOut:p(i)},s);let a=[n({pubkey:ee,isWritable:!1}),n({pubkey:t.id}),n({pubkey:t.authority,isWritable:!1}),n({pubkey:t.openOrders})];return u===4&&a.push(n({pubkey:t.targetOrders})),a.push(n({pubkey:t.baseVault}),n({pubkey:t.quoteVault})),u===5&&a.push(n({pubkey:I})),a.push(n({pubkey:t.marketProgramId,isWritable:!1}),n({pubkey:t.marketId}),n({pubkey:t.marketBids}),n({pubkey:t.marketAsks}),n({pubkey:t.marketEventQueue}),n({pubkey:t.marketBaseVault}),n({pubkey:t.marketQuoteVault}),n({pubkey:t.marketAuthority,isWritable:!1}),n({pubkey:e.tokenAccountIn}),n({pubkey:e.tokenAccountOut}),n({pubkey:e.owner,isWritable:!1})),new h({programId:t.programId,keys:a,data:s})}function Ge({poolKeys:t,userKeys:e,maxAmountIn:r,amountOut:i},u){let s=Buffer.alloc(X.span);X.encode({instruction:11,maxAmountIn:p(r),amountOut:p(i)},s);let a=[n({pubkey:Ke.programId,isWritable:!1}),n({pubkey:t.id}),n({pubkey:t.authority,isWritable:!1}),n({pubkey:t.openOrders}),n({pubkey:t.targetOrders}),n({pubkey:t.baseVault}),n({pubkey:t.quoteVault})];return u===5&&a.push(n({pubkey:I})),a.push(n({pubkey:t.marketProgramId,isWritable:!1}),n({pubkey:t.marketId}),n({pubkey:t.marketBids}),n({pubkey:t.marketAsks}),n({pubkey:t.marketEventQueue}),n({pubkey:t.marketBaseVault}),n({pubkey:t.marketQuoteVault}),n({pubkey:t.marketAuthority,isWritable:!1}),n({pubkey:e.tokenAccountIn}),n({pubkey:e.tokenAccountOut}),n({pubkey:e.owner,isWritable:!1,isSigner:!0})),new h({programId:t.programId,keys:a,data:s})}function no(t){let s=t,{owner:e}=s,r=oe(s,["owner"]),i=Buffer.alloc(G.span);G.encode({instruction:10,nonce:r.nonce},i);let u=[...R,n({pubkey:r.targetOrders}),n({pubkey:r.withdrawQueue}),n({pubkey:r.authority,isWritable:!1}),n({pubkey:r.lpMint}),n({pubkey:r.baseMint,isWritable:!1}),n({pubkey:r.quoteMint,isWritable:!1}),n({pubkey:r.baseVault}),n({pubkey:r.quoteVault}),n({pubkey:r.lpVault}),n({pubkey:r.marketId,isWritable:!1}),n({pubkey:e,isSigner:!0})];return new h({programId:r.programId,keys:u,data:i})}function ro(t){let{poolKeys:e,userKeys:r,startTime:i}=t,u=Buffer.alloc(Z.span);Z.encode({instruction:0,nonce:e.nonce,startTime:p(i)},u);let s=[...R,n({pubkey:e.id}),n({pubkey:e.authority,isWritable:!1}),n({pubkey:e.openOrders}),n({pubkey:e.lpMint}),n({pubkey:e.baseMint,isWritable:!1}),n({pubkey:e.quoteMint,isWritable:!1}),n({pubkey:e.baseVault,isWritable:!1}),n({pubkey:e.quoteVault,isWritable:!1}),n({pubkey:e.withdrawQueue}),n({pubkey:e.targetOrders}),n({pubkey:r.lpTokenAccount}),n({pubkey:e.lpVault,isWritable:!1}),n({pubkey:e.marketProgramId,isWritable:!1}),n({pubkey:e.marketId,isWritable:!1}),n({pubkey:r.payer,isSigner:!0})];return new h({programId:e.programId,keys:s,data:u})}function oo(t){let{poolKeys:e,userKeys:r,baseAmountIn:i,quoteAmountIn:u,fixedSide:s}=t,{version:a}=e;if(a===4||a===5){let g=Buffer.alloc(J.span);J.encode({instruction:3,baseAmountIn:p(i),quoteAmountIn:p(u),fixedSide:p(s==="base"?0:1)},g);let U=[n({pubkey:ee,isWritable:!1}),n({pubkey:e.id}),n({pubkey:e.authority,isWritable:!1}),n({pubkey:e.openOrders,isWritable:!1}),n({pubkey:e.targetOrders}),n({pubkey:e.lpMint}),n({pubkey:e.baseVault}),n({pubkey:e.quoteVault})];return a===5&&U.push(n({pubkey:I})),U.push(n({pubkey:e.marketId,isWritable:!1}),n({pubkey:r.baseTokenAccount}),n({pubkey:r.quoteTokenAccount}),n({pubkey:r.lpTokenAccount}),n({pubkey:r.owner,isWritable:!1,isSigner:!0})),new h({programId:e.programId,keys:U,data:g})}return M.logWithError("invalid version","poolKeys.version",a),new h({programId:e.programId,keys:[]})}function io(t){let{poolKeys:e,userKeys:r,amountIn:i}=t,{version:u}=e;if(u===4||u===5){let s=Buffer.alloc($.span);$.encode({instruction:4,amountIn:p(i)},s);let a=[n({pubkey:ee,isWritable:!1}),n({pubkey:e.id}),n({pubkey:e.authority,isWritable:!1}),n({pubkey:e.openOrders}),n({pubkey:e.targetOrders}),n({pubkey:e.lpMint}),n({pubkey:e.baseVault}),n({pubkey:e.quoteVault})];return u===5?a.push(n({pubkey:I})):a.push(n({pubkey:e.withdrawQueue}),n({pubkey:e.lpVault})),a.push(n({pubkey:e.marketProgramId,isWritable:!1}),n({pubkey:e.marketId}),n({pubkey:e.marketBaseVault}),n({pubkey:e.marketQuoteVault}),n({pubkey:e.marketAuthority,isWritable:!1}),n({pubkey:r.lpTokenAccount}),n({pubkey:r.baseTokenAccount}),n({pubkey:r.quoteTokenAccount}),n({pubkey:r.owner,isWritable:!1,isSigner:!0}),n({pubkey:e.marketEventQueue}),n({pubkey:e.marketBids}),n({pubkey:e.marketAsks})),new h({programId:e.programId,keys:a,data:s})}return M.logWithError("invalid version","poolKeys.version",u),new h({programId:e.programId,keys:[]})}export{eo as makeAMMSwapInstruction,oo as makeAddLiquidityInstruction,no as makeCreatePoolInstruction,ro as makeInitPoolInstruction,io as makeRemoveLiquidityInstruction,to as makeSimulatePoolInfoInstruction,Xe as makeSwapFixedInInstruction,Ge as makeSwapFixedOutInstruction};
//# sourceMappingURL=instruction.mjs.map