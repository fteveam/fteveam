var he=Object.defineProperty,ke=Object.defineProperties;var Le=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var ne=(t,e,r)=>e in t?he(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,S=(t,e)=>{for(var r in e||(e={}))re.call(e,r)&&ne(t,r,e[r]);if(D)for(var r of D(e))oe.call(e,r)&&ne(t,r,e[r]);return t},E=(t,e)=>ke(t,Le(e));var ie=(t,e)=>{var r={};for(var i in t)re.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&D)for(var i of D(t))e.indexOf(i)<0&&oe.call(t,i)&&(r[i]=t[i]);return r};import{TOKEN_PROGRAM_ID as te}from"@solana/spl-token";import{SystemProgram as He,TransactionInstruction as k}from"@solana/web3.js";import y from"bn.js";import qe from"big.js";import dt from"bn.js";import{get as ue,set as Se}from"lodash";import se from"dayjs";import we from"dayjs/plugin/utc";se.extend(we);var v=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:3,this.name=e.name}set level(e){this.logLevel=e}get time(){return se().utc().format("YYYY/MM/DD HH:mm:ss UTC")}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let r=e.map(i=>typeof i=="object"?JSON.stringify(i):i).join(", ");throw new Error(r)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},ae={},Te={};function h(t){let e=ue(ae,t);if(!e){let r=ue(Te,t);e=new v({name:t,logLevel:r}),Se(ae,t,e)}return e}import Be from"toformat";var Ne=Be,w=Ne;import _ from"big.js";import We from"decimal.js-light";var q=h("module/fraction"),F=w(_),T=w(We),Ie={[0]:T.ROUND_DOWN,[1]:T.ROUND_HALF_UP,[2]:T.ROUND_UP},De={[0]:_.roundDown,[1]:_.roundHalfUp,[2]:_.roundUp},m=class{constructor(e,r=ce){this.numerator=p(e),this.denominator=p(r)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new m(this.denominator,this.numerator)}add(e){let r=e instanceof m?e:new m(p(e));return this.denominator.eq(r.denominator)?new m(this.numerator.add(r.numerator),this.denominator):new m(this.numerator.mul(r.denominator).add(r.numerator.mul(this.denominator)),this.denominator.mul(r.denominator))}sub(e){let r=e instanceof m?e:new m(p(e));return this.denominator.eq(r.denominator)?new m(this.numerator.sub(r.numerator),this.denominator):new m(this.numerator.mul(r.denominator).sub(r.numerator.mul(this.denominator)),this.denominator.mul(r.denominator))}mul(e){let r=e instanceof m?e:new m(p(e));return new m(this.numerator.mul(r.numerator),this.denominator.mul(r.denominator))}div(e){let r=e instanceof m?e:new m(p(e));return new m(this.numerator.mul(r.denominator),this.denominator.mul(r.numerator))}toSignificant(e,r={groupSeparator:""},i=1){Number.isInteger(e)||q.logWithError(`${e} is not an integer.`),e<=0&&q.logWithError(`${e} is not positive.`),T.set({precision:e+1,rounding:Ie[i]});let u=new T(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return u.toFormat(u.decimalPlaces(),r)}toFixed(e,r={groupSeparator:""},i=1){return Number.isInteger(e)||q.logWithError(`${e} is not an integer.`),e<0&&q.logWithError(`${e} is negative.`),F.DP=e,F.RM=De[i]||1,new F(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,r)}isZero(){return this.numerator.isZero()}};var kt=h("Raydium_amount"),Lt=w(qe);import{PublicKey as Oe}from"@solana/web3.js";var me={symbol:"SOL",name:"Solana",decimals:9},L={symbol:"WSOL",name:"Wrapped SOL",mint:"So11111111111111111111111111111111111111112",decimals:9,extensions:{coingeckoId:"solana"}},Tt={isQuantumSOL:!0,isLp:!1,official:!0,mint:new Oe(L.mint),decimals:9,symbol:"SOL",id:"sol",name:"solana",icon:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",extensions:{coingeckoId:"solana"}};import{PublicKey as V}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Ae}from"@solana/spl-token";import{PublicKey as b,SystemProgram as Me,SYSVAR_RENT_PUBKEY as Ue}from"@solana/web3.js";function n({pubkey:t,isSigner:e=!1,isWritable:r=!0}){return{pubkey:t,isWritable:r,isSigner:e}}var R=[n({pubkey:Ae,isWritable:!1}),n({pubkey:Me.programId,isWritable:!1}),n({pubkey:Ue,isWritable:!1})];function le({publicKey:t,transformSol:e}){if(t instanceof b)return e&&t.equals(B)?pe:t;if(e&&t===B.toBase58())return pe;if(typeof t=="string")try{return new b(t)}catch{throw new Error("invalid public key")}throw new Error("invalid public key")}var Dt=new b("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),Et=new b("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),qt=new b("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),_t=new b("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),Ot=new b("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),At=new b("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),Mt=new b("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),Ut=new b("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),vt=new b("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),Ft=new b("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),Rt=new b("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),pe=new b("So11111111111111111111111111111111111111112"),B=b.default;var C=class{constructor({mint:e,decimals:r,symbol:i="UNKNOWN",name:u="UNKNOWN",skipMint:s=!1}){if(e===B.toBase58()||e instanceof V&&B.equals(e)){this.decimals=L.decimals,this.symbol=L.symbol,this.name=L.name,this.mint=new V(L.mint);return}this.decimals=r,this.symbol=i,this.name=u,this.mint=s?V.default:le({publicKey:e})}equals(e){return this===e?!0:this.mint.equals(e.mint)}},N=C;N.WSOL=new C(L);var Y=class{constructor({decimals:e,symbol:r="UNKNOWN",name:i="UNKNOWN"}){this.decimals=e,this.symbol=r,this.name=i}equals(e){return this===e}},j=Y;j.SOL=new Y(me);var $t=new m(de);var an=h("Raydium_price");var O=h("Raydium_bignumber");var wn=new y(0),ce=new y(1),Tn=new y(2),Bn=new y(3),Nn=new y(5),_e=new y(10),de=new y(100),Wn=new y(1e3),In=new y(1e4),be=9007199254740991;function p(t){if(t instanceof y)return t;if(typeof t=="string"){if(t.match(/^-?[0-9]+$/))return new y(t);O.logWithError(`invalid BigNumberish string: ${t}`)}return typeof t=="number"?(t%1&&O.logWithError(`BigNumberish number underflow: ${t}`),(t>=be||t<=-be)&&O.logWithError(`BigNumberish number overflow: ${t}`),new y(String(t))):typeof t=="bigint"?new y(t.toString()):(O.logWithError(`invalid BigNumberish value: ${t}`),new y(0))}import{PublicKey as je}from"@solana/web3.js";import xe,{isBN as Pe}from"bn.js";import{bits as qn,BitStructure as _n,blob as ve,Blob as On,cstr as An,f32 as Mn,f32be as Un,f64 as vn,f64be as Fn,greedy as Rn,Layout as Fe,ns64 as Vn,ns64be as Cn,nu64 as jn,nu64be as Yn,offset as Qn,s16 as zn,s16be as Hn,s24 as Kn,s24be as Xn,s32 as Gn,s32be as Zn,s40 as Jn,s40be as $n,s48 as er,s48be as tr,s8 as nr,seq as Re,struct as rr,Structure as Ve,u16 as or,u16be as ir,u24 as ur,u24be as ar,u32 as sr,u32be as cr,u40 as mr,u40be as pr,u48 as lr,u48be as dr,u8 as br,UInt as Ce,union as yr,Union as fr,unionLayoutDiscriminator as gr,utf8 as xr}from"@solana/buffer-layout";var Q=Fe,ye=Ve;var fe=Ce;var ge=Re;var z=ve;var A=class extends Q{constructor(r,i,u){super(r,u);this.blob=z(r),this.signed=i}decode(r,i=0){let u=new xe(this.blob.decode(r,i),10,"le");return this.signed?u.fromTwos(this.span*8).clone():u}encode(r,i,u=0){return typeof r=="number"&&(r=new xe(r)),this.signed&&(r=r.toTwos(this.span*8)),this.blob.encode(r.toArrayLike(Buffer,"le",this.span),i,u)}};function x(t){return new fe(1,t)}function o(t){return new A(8,!1,t)}function P(t){return new A(16,!1,t)}var H=class extends Q{constructor(r,i,u,s){super(r.span,s);this.layout=r,this.decoder=i,this.encoder=u}decode(r,i){return this.decoder(this.layout.decode(r,i))}encode(r,i,u){return this.layout.encode(this.encoder(r),i,u)}getSpan(r,i){return this.layout.getSpan(r,i)}};function c(t){return new H(z(32),e=>new je(e),e=>e.toBuffer(),t)}var K=class extends ye{decode(e,r){return super.decode(e,r)}};function f(t,e,r){return new K(t,e,r)}function W(t,e,r){let i,u=typeof e=="number"?e:Pe(e)?e.toNumber():new Proxy(e,{get(s,a){if(!i){let g=Reflect.get(s,"count");i=Pe(g)?g.toNumber():g,Reflect.set(s,"count",i)}return Reflect.get(s,a)},set(s,a,g){return a==="count"&&(i=g),Reflect.set(s,a,g)}});return ge(t,u,r)}var X=f([x("instruction"),o("amountIn"),o("minAmountOut")]),G=f([x("instruction"),o("maxAmountIn"),o("amountOut")]),Z=f([x("instruction"),x("nonce")]),J=f([x("instruction"),x("nonce"),o("startTime")]),Or=f([o("status"),o("nonce"),o("maxOrder"),o("depth"),o("baseDecimal"),o("quoteDecimal"),o("state"),o("resetFlag"),o("minSize"),o("volMaxCutRatio"),o("amountWaveRatio"),o("baseLotSize"),o("quoteLotSize"),o("minPriceMultiplier"),o("maxPriceMultiplier"),o("systemDecimalValue"),o("minSeparateNumerator"),o("minSeparateDenominator"),o("tradeFeeNumerator"),o("tradeFeeDenominator"),o("pnlNumerator"),o("pnlDenominator"),o("swapFeeNumerator"),o("swapFeeDenominator"),o("baseNeedTakePnl"),o("quoteNeedTakePnl"),o("quoteTotalPnl"),o("baseTotalPnl"),P("quoteTotalDeposited"),P("baseTotalDeposited"),P("swapBaseInAmount"),P("swapQuoteOutAmount"),o("swapBase2QuoteFee"),P("swapQuoteInAmount"),P("swapBaseOutAmount"),o("swapQuote2BaseFee"),c("baseVault"),c("quoteVault"),c("baseMint"),c("quoteMint"),c("lpMint"),c("openOrders"),c("marketId"),c("marketProgramId"),c("targetOrders"),c("withdrawQueue"),c("lpVault"),c("owner"),o("lpReserve"),W(o(),3,"padding")]),Ar=f([o("accountType"),o("status"),o("nonce"),o("maxOrder"),o("depth"),o("baseDecimal"),o("quoteDecimal"),o("state"),o("resetFlag"),o("minSize"),o("volMaxCutRatio"),o("amountWaveRatio"),o("baseLotSize"),o("quoteLotSize"),o("minPriceMultiplier"),o("maxPriceMultiplier"),o("systemDecimalsValue"),o("abortTradeFactor"),o("priceTickMultiplier"),o("priceTick"),o("minSeparateNumerator"),o("minSeparateDenominator"),o("tradeFeeNumerator"),o("tradeFeeDenominator"),o("pnlNumerator"),o("pnlDenominator"),o("swapFeeNumerator"),o("swapFeeDenominator"),o("baseNeedTakePnl"),o("quoteNeedTakePnl"),o("quoteTotalPnl"),o("baseTotalPnl"),o("poolOpenTime"),o("punishPcAmount"),o("punishCoinAmount"),o("orderbookToInitTime"),P("swapBaseInAmount"),P("swapQuoteOutAmount"),P("swapQuoteInAmount"),P("swapBaseOutAmount"),o("swapQuote2BaseFee"),o("swapBase2QuoteFee"),c("baseVault"),c("quoteVault"),c("baseMint"),c("quoteMint"),c("lpMint"),c("modelDataAccount"),c("openOrders"),c("marketId"),c("marketProgramId"),c("targetOrders"),c("owner"),W(o(),64,"padding")]),$=f([x("instruction"),o("baseAmountIn"),o("quoteAmountIn"),o("fixedSide")]),ee=f([x("instruction"),o("amountIn")]);import{PublicKey as Ye}from"@solana/web3.js";var I=new Ye("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Qe=5e4,ze=f([o("x"),o("y"),o("price")]),Rr=f([o("accountType"),o("status"),o("multiplier"),o("validDataCount"),W(ze,Qe,"DataElement")]);var M=h("Raydium_liquidity_instruction");function Zr(t){let{poolKeys:e,userKeys:r,amountIn:i,amountOut:u,fixedSide:s}=t,{version:a}=e;if(a===4||a===5){let g={poolKeys:e,userKeys:r};if(s==="in")return Ke(E(S({},g),{amountIn:i,minAmountOut:u}),a);if(s==="out")return Xe(E(S({},g),{maxAmountIn:i,amountOut:u}),a);M.logWithError("invalid params","params",t)}throw M.logWithError("invalid version","poolKeys.version",a),new Error("invalid version")}function Jr(t){let e=f([x("instruction"),x("simulateType")]),r=Buffer.alloc(e.span);e.encode({instruction:12,simulateType:0},r);let i=[n({pubkey:t.id,isWritable:!1}),n({pubkey:t.authority,isWritable:!1}),n({pubkey:t.openOrders,isWritable:!1}),n({pubkey:t.baseVault,isWritable:!1}),n({pubkey:t.quoteVault,isWritable:!1}),n({pubkey:t.lpMint,isWritable:!1}),n({pubkey:t.marketId,isWritable:!1})];return new k({programId:t.programId,keys:i,data:r})}function Ke({poolKeys:t,userKeys:e,amountIn:r,minAmountOut:i},u){let s=Buffer.alloc(X.span);X.encode({instruction:9,amountIn:p(r),minAmountOut:p(i)},s);let a=[n({pubkey:te,isWritable:!1}),n({pubkey:t.id}),n({pubkey:t.authority,isWritable:!1}),n({pubkey:t.openOrders})];return u===4&&a.push(n({pubkey:t.targetOrders})),a.push(n({pubkey:t.baseVault}),n({pubkey:t.quoteVault})),u===5&&a.push(n({pubkey:I})),a.push(n({pubkey:t.marketProgramId,isWritable:!1}),n({pubkey:t.marketId}),n({pubkey:t.marketBids}),n({pubkey:t.marketAsks}),n({pubkey:t.marketEventQueue}),n({pubkey:t.marketBaseVault}),n({pubkey:t.marketQuoteVault}),n({pubkey:t.marketAuthority,isWritable:!1}),n({pubkey:e.tokenAccountIn}),n({pubkey:e.tokenAccountOut}),n({pubkey:e.owner,isWritable:!1})),new k({programId:t.programId,keys:a,data:s})}function Xe({poolKeys:t,userKeys:e,maxAmountIn:r,amountOut:i},u){let s=Buffer.alloc(G.span);G.encode({instruction:11,maxAmountIn:p(r),amountOut:p(i)},s);let a=[n({pubkey:He.programId,isWritable:!1}),n({pubkey:t.id}),n({pubkey:t.authority,isWritable:!1}),n({pubkey:t.openOrders}),n({pubkey:t.targetOrders}),n({pubkey:t.baseVault}),n({pubkey:t.quoteVault})];return u===5&&a.push(n({pubkey:I})),a.push(n({pubkey:t.marketProgramId,isWritable:!1}),n({pubkey:t.marketId}),n({pubkey:t.marketBids}),n({pubkey:t.marketAsks}),n({pubkey:t.marketEventQueue}),n({pubkey:t.marketBaseVault}),n({pubkey:t.marketQuoteVault}),n({pubkey:t.marketAuthority,isWritable:!1}),n({pubkey:e.tokenAccountIn}),n({pubkey:e.tokenAccountOut}),n({pubkey:e.owner,isWritable:!1,isSigner:!0})),new k({programId:t.programId,keys:a,data:s})}function $r(t){let s=t,{owner:e}=s,r=ie(s,["owner"]),i=Buffer.alloc(Z.span);Z.encode({instruction:10,nonce:r.nonce},i);let u=[...R,n({pubkey:r.targetOrders}),n({pubkey:r.withdrawQueue}),n({pubkey:r.authority,isWritable:!1}),n({pubkey:r.lpMint}),n({pubkey:r.baseMint,isWritable:!1}),n({pubkey:r.quoteMint,isWritable:!1}),n({pubkey:r.baseVault}),n({pubkey:r.quoteVault}),n({pubkey:r.lpVault}),n({pubkey:r.marketId,isWritable:!1}),n({pubkey:e,isSigner:!0})];return new k({programId:r.programId,keys:u,data:i})}function eo(t){let{poolKeys:e,userKeys:r,startTime:i}=t,u=Buffer.alloc(J.span);J.encode({instruction:0,nonce:e.nonce,startTime:p(i)},u);let s=[...R,n({pubkey:e.id}),n({pubkey:e.authority,isWritable:!1}),n({pubkey:e.openOrders}),n({pubkey:e.lpMint}),n({pubkey:e.baseMint,isWritable:!1}),n({pubkey:e.quoteMint,isWritable:!1}),n({pubkey:e.baseVault,isWritable:!1}),n({pubkey:e.quoteVault,isWritable:!1}),n({pubkey:e.withdrawQueue}),n({pubkey:e.targetOrders}),n({pubkey:r.lpTokenAccount}),n({pubkey:e.lpVault,isWritable:!1}),n({pubkey:e.marketProgramId,isWritable:!1}),n({pubkey:e.marketId,isWritable:!1}),n({pubkey:r.payer,isSigner:!0})];return new k({programId:e.programId,keys:s,data:u})}function to(t){let{poolKeys:e,userKeys:r,baseAmountIn:i,quoteAmountIn:u,fixedSide:s}=t,{version:a}=e;if(a===4||a===5){let g=Buffer.alloc($.span);$.encode({instruction:3,baseAmountIn:p(i),quoteAmountIn:p(u),fixedSide:p(s==="base"?0:1)},g);let U=[n({pubkey:te,isWritable:!1}),n({pubkey:e.id}),n({pubkey:e.authority,isWritable:!1}),n({pubkey:e.openOrders,isWritable:!1}),n({pubkey:e.targetOrders}),n({pubkey:e.lpMint}),n({pubkey:e.baseVault}),n({pubkey:e.quoteVault})];return a===5&&U.push(n({pubkey:I})),U.push(n({pubkey:e.marketId,isWritable:!1}),n({pubkey:r.baseTokenAccount}),n({pubkey:r.quoteTokenAccount}),n({pubkey:r.lpTokenAccount}),n({pubkey:r.owner,isWritable:!1,isSigner:!0})),new k({programId:e.programId,keys:U,data:g})}return M.logWithError("invalid version","poolKeys.version",a),new k({programId:e.programId,keys:[]})}function no(t){let{poolKeys:e,userKeys:r,amountIn:i}=t,{version:u}=e;if(u===4||u===5){let s=Buffer.alloc(ee.span);ee.encode({instruction:4,amountIn:p(i)},s);let a=[n({pubkey:te,isWritable:!1}),n({pubkey:e.id}),n({pubkey:e.authority,isWritable:!1}),n({pubkey:e.openOrders}),n({pubkey:e.targetOrders}),n({pubkey:e.lpMint}),n({pubkey:e.baseVault}),n({pubkey:e.quoteVault})];return u===5?a.push(n({pubkey:I})):a.push(n({pubkey:e.withdrawQueue}),n({pubkey:e.lpVault})),a.push(n({pubkey:e.marketProgramId,isWritable:!1}),n({pubkey:e.marketId}),n({pubkey:e.marketBaseVault}),n({pubkey:e.marketQuoteVault}),n({pubkey:e.marketAuthority,isWritable:!1}),n({pubkey:r.lpTokenAccount}),n({pubkey:r.baseTokenAccount}),n({pubkey:r.quoteTokenAccount}),n({pubkey:r.owner,isWritable:!1,isSigner:!0}),n({pubkey:e.marketEventQueue}),n({pubkey:e.marketBids}),n({pubkey:e.marketAsks})),new k({programId:e.programId,keys:a,data:s})}return M.logWithError("invalid version","poolKeys.version",u),new k({programId:e.programId,keys:[]})}export{Zr as makeAMMSwapInstruction,to as makeAddLiquidityInstruction,$r as makeCreatePoolInstruction,eo as makeInitPoolInstruction,no as makeRemoveLiquidityInstruction,Jr as makeSimulatePoolInfoInstruction,Ke as makeSwapFixedInInstruction,Xe as makeSwapFixedOutInstruction};
//# sourceMappingURL=instruction.mjs.map