var it=Object.create;var G=Object.defineProperty;var st=Object.getOwnPropertyDescriptor;var at=Object.getOwnPropertyNames;var ut=Object.getPrototypeOf,ct=Object.prototype.hasOwnProperty;var mt=(n,e)=>{for(var t in e)G(n,t,{get:e[t],enumerable:!0})},ke=(n,e,t,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of at(e))!ct.call(n,i)&&i!==t&&G(n,i,{get:()=>e[i],enumerable:!(o=st(e,i))||o.enumerable});return n};var w=(n,e,t)=>(t=n!=null?it(ut(n)):{},ke(e||!n||!n.__esModule?G(t,"default",{value:n,enumerable:!0}):t,n)),lt=n=>ke(G({},"__esModule",{value:!0}),n);var jt={};mt(jt,{getAmountSide:()=>Mt,getAmountsSide:()=>Ct,getAssociatedPoolKeys:()=>Ft,getLiquidityAssociatedAuthority:()=>nt,getLiquidityAssociatedId:()=>_,getLiquidityInfo:()=>Qt,getLiquidityProgramId:()=>tt,getLiquidityStateLayout:()=>Ut,getPoolEnabledFeatures:()=>Vt,getTokenSide:()=>xe,getTokensSide:()=>rt,includesToken:()=>vt,isValidFixedSide:()=>Yt,makeSimulationPoolInfo:()=>Kt});module.exports=lt(jt);var et=require("@project-serum/serum"),M=w(require("bn.js"));var V=require("lodash"),ne=w(require("dayjs")),we=w(require("dayjs/plugin/utc"));ne.default.extend(we.default);var te=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:3,this.name=e.name}set level(e){this.logLevel=e}get time(){return(0,ne.default)().utc().format("YYYY/MM/DD HH:mm:ss UTC")}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let t=e.map(o=>typeof o=="object"?JSON.stringify(o):o).join(", ");throw new Error(t)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},Le={},pt={};function y(n){let e=(0,V.get)(Le,n);if(!e){let t=(0,V.get)(pt,n);e=new te({name:n,logLevel:t}),(0,V.set)(Le,n,e)}return e}var Se=require("@solana/spl-token"),b=require("@solana/web3.js");function T({pubkey:n,isSigner:e=!1,isWritable:t=!0}){return{pubkey:n,isWritable:t,isSigner:e}}var dt=[T({pubkey:Se.TOKEN_PROGRAM_ID,isWritable:!1}),T({pubkey:b.SystemProgram.programId,isWritable:!1}),T({pubkey:b.SYSVAR_RENT_PUBKEY,isWritable:!1})];function O({publicKey:n,transformSol:e}){if(n instanceof b.PublicKey)return e&&n.equals(U)?Te:n;if(e&&n===U.toBase58())return Te;if(typeof n=="string")try{return new b.PublicKey(n)}catch{throw new Error("invalid public key")}throw new Error("invalid public key")}var Xt=new b.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),$t=new b.PublicKey("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),Jt=new b.PublicKey("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),Zt=new b.PublicKey("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),en=new b.PublicKey("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),tn=new b.PublicKey("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),nn=new b.PublicKey("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),rn=new b.PublicKey("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),on=new b.PublicKey("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),sn=new b.PublicKey("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),an=new b.PublicKey("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Te=new b.PublicKey("So11111111111111111111111111111111111111112"),U=b.PublicKey.default;var I=require("@solana/web3.js");var q=y("Raydium_txTool");function bt(n,e){n.length<1&&q.logWithError(`no instructions provided: ${n.toString()}`),e.length<1&&q.logWithError(`no signers provided:, ${e.toString()}`);let t=new I.Transaction;t.recentBlockhash="11111111111111111111111111111111",t.feePayer=e[0],t.add(...n);let o=t.compileMessage().serialize();return e.length+e.length*64+o.length}async function Ie(n,e,t){let o=new I.PublicKey("RaydiumSimuLateTransaction11111111111111111"),i=[],s=new I.Transaction;s.feePayer=o;for(let m of e)bt([...s.instructions,m],[o])>I.PACKET_DATA_SIZE&&(i.push(s),s=new I.Transaction,s.feePayer=o),s.add(m);s.instructions.length>0&&i.push(s);let l=[];try{l=await Promise.all(i.map(m=>n.simulateTransaction(m)))}catch(m){m instanceof Error&&q.logWithError(`failed to simulate for instructions, RPC_ERROR, ${m.message}`)}let p=[];for(let m of l){let{value:x}=m;if(q.debug(`simulate result: ${JSON.stringify(m)}`),x.logs){let k=x.logs.filter(L=>L&&L.includes(t));q.debug(`filteredLog: ${JSON.stringify(p)}`),k.length||q.logWithError(` "simulate log not match keyword, keyword: ${t}`),p.push(...k)}}return p}function Be(n,e){let t=n.match(/{["\w:,]+}/g);return!t||t.length!==1?q.logWithError(`simulate log fail to match json, keyword: ${e}`):t[0]}function B(n,e){let o=new RegExp(`"${e}":(\\d+)`,"g").exec(n);return!o||o.length!==2?q.logWithError(`simulate log fail to match key", key: ${e}`):o[1]}async function re(n,e){let[t,o]=await I.PublicKey.findProgramAddress(n,e);return{publicKey:t,nonce:o}}var Re=w(require("big.js")),Y=w(require("bn.js"));var f=w(require("bn.js"));var z=y("Raydium_bignumber");var xn=new f.default(0),qe=new f.default(1),Pn=new f.default(2),hn=new f.default(3),kn=new f.default(5),Ae=new f.default(10),De=new f.default(100),Ln=new f.default(1e3),wn=new f.default(1e4),_e=9007199254740991;function P(n){if(n instanceof f.default)return n;if(typeof n=="string"){if(n.match(/^-?[0-9]+$/))return new f.default(n);z.logWithError(`invalid BigNumberish string: ${n}`)}return typeof n=="number"?(n%1&&z.logWithError(`BigNumberish number underflow: ${n}`),(n>=_e||n<=-_e)&&z.logWithError(`BigNumberish number overflow: ${n}`),new f.default(String(n))):typeof n=="bigint"?new f.default(n.toString()):(z.logWithError(`invalid BigNumberish value: ${n}`),new f.default(0))}var Ee=w(require("toformat")),ft=Ee.default,F=ft;var K=w(require("big.js")),We=w(require("decimal.js-light"));var H=y("module/fraction"),oe=F(K.default),C=F(We.default),xt={[0]:C.ROUND_DOWN,[1]:C.ROUND_HALF_UP,[2]:C.ROUND_UP},Pt={[0]:K.default.roundDown,[1]:K.default.roundHalfUp,[2]:K.default.roundUp},u=class{constructor(e,t=qe){this.numerator=P(e),this.denominator=P(t)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new u(this.denominator,this.numerator)}add(e){let t=e instanceof u?e:new u(P(e));return this.denominator.eq(t.denominator)?new u(this.numerator.add(t.numerator),this.denominator):new u(this.numerator.mul(t.denominator).add(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}sub(e){let t=e instanceof u?e:new u(P(e));return this.denominator.eq(t.denominator)?new u(this.numerator.sub(t.numerator),this.denominator):new u(this.numerator.mul(t.denominator).sub(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}mul(e){let t=e instanceof u?e:new u(P(e));return new u(this.numerator.mul(t.numerator),this.denominator.mul(t.denominator))}div(e){let t=e instanceof u?e:new u(P(e));return new u(this.numerator.mul(t.denominator),this.denominator.mul(t.numerator))}toSignificant(e,t={groupSeparator:""},o=1){Number.isInteger(e)||H.logWithError(`${e} is not an integer.`),e<=0&&H.logWithError(`${e} is not positive.`),C.set({precision:e+1,rounding:xt[o]});let i=new C(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return i.toFormat(i.decimalPlaces(),t)}toFixed(e,t={groupSeparator:""},o=1){return Number.isInteger(e)||H.logWithError(`${e} is not an integer.`),e<0&&H.logWithError(`${e} is negative.`),oe.DP=e,oe.RM=Pt[o]||1,new oe(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,t)}isZero(){return this.numerator.isZero()}};var ht=y("Raydium_amount"),Oe=F(Re.default);function kt(n,e){let t="0",o="0";if(n.includes(".")){let i=n.split(".");i.length===2?([t,o]=i,o=o.padEnd(e,"0")):ht.logWithError(`invalid number string, num: ${n}`)}else t=n;return[t,o.slice(0,e)||o]}var A=class extends u{constructor(t,o,i=!0,s){let l=new Y.default(0),p=Ae.pow(new Y.default(t.decimals));if(i)l=P(o);else{let m=new Y.default(0),x=new Y.default(0);if(typeof o=="string"||typeof o=="number"||typeof o=="bigint"){let[k,L]=kt(o.toString(),t.decimals);m=P(k),x=P(L)}m=m.mul(p),l=m.add(x)}super(l,p);this.logger=y(s||"Amount"),this.token=t}get raw(){return this.numerator}isZero(){return this.raw.isZero()}gt(t){return this.token.equals(t.token)||this.logger.logWithError("gt token not equals"),this.raw.gt(t.raw)}lt(t){return this.token.equals(t.token)||this.logger.logWithError("lt token not equals"),this.raw.lt(t.raw)}add(t){return this.token.equals(t.token)||this.logger.logWithError("add token not equals"),new A(this.token,this.raw.add(t.raw))}subtract(t){return this.token.equals(t.token)||this.logger.logWithError("sub token not equals"),new A(this.token,this.raw.sub(t.raw))}toSignificant(t=this.token.decimals,o,i=0){return super.toSignificant(t,o,i)}toFixed(t=this.token.decimals,o,i=0){return t>this.token.decimals&&this.logger.logWithError("decimals overflow"),super.toFixed(t,o,i)}toExact(t={groupSeparator:""}){return Oe.DP=this.token.decimals,new Oe(this.numerator.toString()).div(this.denominator.toString()).toFormat(t)}};var Me=require("@solana/web3.js"),ve={symbol:"SOL",name:"Solana",decimals:9},E={symbol:"WSOL",name:"Wrapped SOL",mint:"So11111111111111111111111111111111111111112",decimals:9,extensions:{coingeckoId:"solana"}},Kn={isQuantumSOL:!0,isLp:!1,official:!0,mint:new Me.PublicKey(E.mint),decimals:9,symbol:"SOL",id:"sol",name:"solana",icon:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",extensions:{coingeckoId:"solana"}};var X=require("@solana/web3.js");var ie=class{constructor({mint:e,decimals:t,symbol:o="UNKNOWN",name:i="UNKNOWN",skipMint:s=!1}){if(e===U.toBase58()||e instanceof X.PublicKey&&U.equals(e)){this.decimals=E.decimals,this.symbol=E.symbol,this.name=E.name,this.mint=new X.PublicKey(E.mint);return}this.decimals=t,this.symbol=o,this.name=i,this.mint=s?X.PublicKey.default:O({publicKey:e})}equals(e){return this===e?!0:this.mint.equals(e.mint)}},D=ie;D.WSOL=new ie(E);var ae=class{constructor({decimals:e,symbol:t="UNKNOWN",name:o="UNKNOWN"}){this.decimals=e,this.symbol=t,this.name=o}equals(e){return this===e}},se=ae;se.SOL=new ae(ve);var er=new u(De);var ur=y("Raydium_price");var ue=require("@solana/web3.js"),ce=w(require("bn.js"));var xr=new ce.default(25),Pr=new ce.default(1e4),Ve="675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8",Lt=new ue.PublicKey(Ve),Ue="5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h",wt=new ue.PublicKey(Ue),hr={[Ve]:4,[Ue]:5},Fe={4:Lt,5:wt},Ke={4:3,5:3};var Wt=require("@solana/spl-token"),ye=require("@solana/web3.js");var je=require("@solana/web3.js"),R=w(require("bn.js"));var a=require("@solana/buffer-layout"),me=a.Layout,Ce=a.Structure;var Ye=a.UInt;var Qe=a.seq;var le=a.blob;var $=class extends me{constructor(t,o,i){super(t,i);this.blob=le(t),this.signed=o}decode(t,o=0){let i=new R.default(this.blob.decode(t,o),10,"le");return this.signed?i.fromTwos(this.span*8).clone():i}encode(t,o,i=0){return typeof t=="number"&&(t=new R.default(t)),this.signed&&(t=t.toTwos(this.span*8)),this.blob.encode(t.toArrayLike(Buffer,"le",this.span),o,i)}};function h(n){return new Ye(1,n)}function r(n){return new $(8,!1,n)}function S(n){return new $(16,!1,n)}var pe=class extends me{constructor(t,o,i,s){super(t.span,s);this.layout=t,this.decoder=o,this.encoder=i}decode(t,o){return this.decoder(this.layout.decode(t,o))}encode(t,o,i){return this.layout.encode(this.encoder(t),o,i)}getSpan(t,o){return this.layout.getSpan(t,o)}};function c(n){return new pe(le(32),e=>new je.PublicKey(e),e=>e.toBuffer(),n)}var de=class extends Ce{decode(e,t){return super.decode(e,t)}};function g(n,e,t){return new de(n,e,t)}function Q(n,e,t){let o,i=typeof e=="number"?e:(0,R.isBN)(e)?e.toNumber():new Proxy(e,{get(s,l){if(!o){let p=Reflect.get(s,"count");o=(0,R.isBN)(p)?p.toNumber():p,Reflect.set(s,"count",o)}return Reflect.get(s,l)},set(s,l,p){return l==="count"&&(o=p),Reflect.set(s,l,p)}});return Qe(n,i,t)}var Tt=g([h("instruction"),r("amountIn"),r("minAmountOut")]),St=g([h("instruction"),r("maxAmountIn"),r("amountOut")]),It=g([h("instruction"),h("nonce")]),Bt=g([h("instruction"),h("nonce"),r("startTime")]),be=g([r("status"),r("nonce"),r("maxOrder"),r("depth"),r("baseDecimal"),r("quoteDecimal"),r("state"),r("resetFlag"),r("minSize"),r("volMaxCutRatio"),r("amountWaveRatio"),r("baseLotSize"),r("quoteLotSize"),r("minPriceMultiplier"),r("maxPriceMultiplier"),r("systemDecimalValue"),r("minSeparateNumerator"),r("minSeparateDenominator"),r("tradeFeeNumerator"),r("tradeFeeDenominator"),r("pnlNumerator"),r("pnlDenominator"),r("swapFeeNumerator"),r("swapFeeDenominator"),r("baseNeedTakePnl"),r("quoteNeedTakePnl"),r("quoteTotalPnl"),r("baseTotalPnl"),S("quoteTotalDeposited"),S("baseTotalDeposited"),S("swapBaseInAmount"),S("swapQuoteOutAmount"),r("swapBase2QuoteFee"),S("swapQuoteInAmount"),S("swapBaseOutAmount"),r("swapQuote2BaseFee"),c("baseVault"),c("quoteVault"),c("baseMint"),c("quoteMint"),c("lpMint"),c("openOrders"),c("marketId"),c("marketProgramId"),c("targetOrders"),c("withdrawQueue"),c("lpVault"),c("owner"),r("lpReserve"),Q(r(),3,"padding")]),_t=g([r("accountType"),r("status"),r("nonce"),r("maxOrder"),r("depth"),r("baseDecimal"),r("quoteDecimal"),r("state"),r("resetFlag"),r("minSize"),r("volMaxCutRatio"),r("amountWaveRatio"),r("baseLotSize"),r("quoteLotSize"),r("minPriceMultiplier"),r("maxPriceMultiplier"),r("systemDecimalsValue"),r("abortTradeFactor"),r("priceTickMultiplier"),r("priceTick"),r("minSeparateNumerator"),r("minSeparateDenominator"),r("tradeFeeNumerator"),r("tradeFeeDenominator"),r("pnlNumerator"),r("pnlDenominator"),r("swapFeeNumerator"),r("swapFeeDenominator"),r("baseNeedTakePnl"),r("quoteNeedTakePnl"),r("quoteTotalPnl"),r("baseTotalPnl"),r("poolOpenTime"),r("punishPcAmount"),r("punishCoinAmount"),r("orderbookToInitTime"),S("swapBaseInAmount"),S("swapQuoteOutAmount"),S("swapQuoteInAmount"),S("swapBaseOutAmount"),r("swapQuote2BaseFee"),r("swapBase2QuoteFee"),c("baseVault"),c("quoteVault"),c("baseMint"),c("quoteMint"),c("lpMint"),c("modelDataAccount"),c("openOrders"),c("marketId"),c("marketProgramId"),c("targetOrders"),c("owner"),Q(r(),64,"padding")]),Nt=g([h("instruction"),r("baseAmountIn"),r("quoteAmountIn"),r("fixedSide")]),qt=g([h("instruction"),r("amountIn")]),Ge={4:be,5:_t};var ze=require("@solana/web3.js");var At=new ze.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Dt=5e4,Et=g([r("x"),r("y"),r("price")]),vr=g([r("accountType"),r("status"),r("multiplier"),r("validDataCount"),Q(Et,Dt,"DataElement")]);var zr=y("Raydium_liquidity_instruction");function He(n){let e=g([h("instruction"),h("simulateType")]),t=Buffer.alloc(e.span);e.encode({instruction:12,simulateType:0},t);let o=[T({pubkey:n.id,isWritable:!1}),T({pubkey:n.authority,isWritable:!1}),T({pubkey:n.openOrders,isWritable:!1}),T({pubkey:n.baseVault,isWritable:!1}),T({pubkey:n.quoteVault,isWritable:!1}),T({pubkey:n.lpMint,isWritable:!1}),T({pubkey:n.marketId,isWritable:!1})];return new ye.TransactionInstruction({programId:n.programId,keys:o,data:t})}var fe=require("@solana/web3.js");var ge=y("Raydium_liquidity_serum"),Xe="9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin",Ot=new fe.PublicKey(Xe),Jr={[Xe]:3},Rt={3:Ot};function $e(n){let e=Ke[n];return e||ge.logWithError("invalid version","version",n),e}function Je(n){let e=Rt[n];return e||ge.logWithError("invalid version","version",n),e}async function Ze({programId:n,marketId:e}){let t=[e.toBuffer()],o=0,i;for(;o<100;){try{let s=t.concat(Buffer.from([o]),Buffer.alloc(7));i=await fe.PublicKey.createProgramAddress(s,n)}catch(s){if(s instanceof TypeError)throw s;o++;continue}return{publicKey:i,nonce:o}}throw ge.logWithError("unable to find a viable program address nonce","params",{programId:n,marketId:e}),new Error("unable to find a viable program address nonce")}var J=y("Raydium_liquidity_util");function Mt(n,e){let t=n instanceof A?n.token:D.WSOL,{baseMint:o,quoteMint:i}=e;if(t.mint.equals(o))return"base";if(t.mint.equals(i))return"quote";let s=`liquidity getTokenSide - token not match with pool, params: ${JSON.stringify({token:t.mint,baseMint:o,quoteMint:i})}`;throw console.error(s),new Error(s)}function vt(n,e){let{baseMint:t,quoteMint:o}=e;return n.mint.equals(t)||n.mint.equals(o)}function Vt(n){let{status:e,startTime:t}=n,o=e.toNumber();return{[0]:{swap:!1,addLiquidity:!1,removeLiquidity:!1},[1]:{swap:!0,addLiquidity:!0,removeLiquidity:!0},[2]:{swap:!1,addLiquidity:!1,removeLiquidity:!1},[3]:{swap:!1,addLiquidity:!1,removeLiquidity:!0},[4]:{swap:!1,addLiquidity:!0,removeLiquidity:!0},[5]:{swap:!1,addLiquidity:!0,removeLiquidity:!0},[6]:{swap:!0,addLiquidity:!0,removeLiquidity:!0},[7]:{swap:Date.now()/1e3>=t.toNumber(),addLiquidity:!0,removeLiquidity:!0}}[o]||{swap:!1,addLiquidity:!1,removeLiquidity:!1}}function Ut(n){let e=Ge[n];return e||J.logWithError("invalid version","version",n),e}function tt(n){let e=Fe[n];return e||J.logWithError("invalid version","version",n),e}async function _({name:n,programId:e,marketId:t}){let{publicKey:o}=await re([e.toBuffer(),t.toBuffer(),Buffer.from(n,"utf-8")],e);return o}async function nt({programId:n}){return re([Buffer.from([97,109,109,32,97,117,116,104,111,114,105,116,121])],n)}async function Ft({version:n,marketId:e,baseMint:t,quoteMint:o}){let i=tt(n),[s,l,p]=[O({publicKey:e}),O({publicKey:t,transformSol:!0}),O({publicKey:o,transformSol:!0})],m=await _({name:"amm_associated_seed",programId:i,marketId:s}),x=await _({name:"lp_mint_associated_seed",programId:i,marketId:s}),{publicKey:k,nonce:L}=await nt({programId:i}),W=await _({name:"coin_vault_associated_seed",programId:i,marketId:s}),N=await _({name:"pc_vault_associated_seed",programId:i,marketId:s}),v=await _({name:"temp_lp_token_associated_seed",programId:i,marketId:s}),j=await _({name:"open_order_associated_seed",programId:i,marketId:s}),Z=await _({name:"target_associated_seed",programId:i,marketId:s}),ee=await _({name:"withdraw_associated_seed",programId:i,marketId:s}),Pe=$e(n),he=Je(Pe),{publicKey:ot}=await Ze({programId:he,marketId:s});return{id:m,baseMint:l,quoteMint:p,lpMint:x,version:n,programId:i,authority:k,nonce:L,baseVault:W,quoteVault:N,lpVault:v,openOrders:j,targetOrders:Z,withdrawQueue:ee,marketVersion:Pe,marketProgramId:he,marketId:s,marketAuthority:ot}}async function Kt({connection:n,pools:e}){let t=e.map(i=>He(i));return(await Ie(n,t,"GetPoolData")).map(i=>{let s=Be(i,"GetPoolData"),l=new M.default(B(s,"status")),p=Number(B(s,"coin_decimals")),m=Number(B(s,"pc_decimals")),x=Number(B(s,"lp_decimals")),k=new M.default(B(s,"pool_coin_amount")),L=new M.default(B(s,"pool_pc_amount")),W=new M.default(B(s,"pool_lp_supply")),N="0";try{N=B(s,"pool_open_time")}catch{N="0"}return{status:l,baseDecimals:p,quoteDecimals:m,lpDecimals:x,baseReserve:k,quoteReserve:L,lpSupply:W,startTime:new M.default(N)}})}function Ct(n,e,t){return rt(n.token,e.token,t)}function rt(n,e,t){let{baseMint:o,quoteMint:i}=t,s=xe(n,t),l=xe(e,t);return s===l&&J.logWithError("tokens not match with pool","params",{tokenA:n.mint,tokenB:e.mint,baseMint:o,quoteMint:i}),[s,l]}function xe(n,e){let{baseMint:t,quoteMint:o}=e;return n.mint.equals(t)?"base":n.mint.equals(o)?"quote":(J.logWithError("token not match with pool","params",{token:n.mint,baseMint:t,quoteMint:o}),"base")}var Yt=n=>n==="a"||n==="b";async function Qt(n,e,t){let o=await n.getAccountInfo(e);if(o===null)return null;let i=be.decode(o.data),s=await n.getTokenAccountBalance(i.baseVault),l=await n.getTokenAccountBalance(i.quoteVault),p=await et.OpenOrders.load(n,i.openOrders,t),m=10**i.baseDecimal.toNumber(),x=10**i.quoteDecimal.toNumber(),k=p.baseTokenTotal.toNumber()/m,L=p.quoteTokenTotal.toNumber()/x,W=i.baseNeedTakePnl.toNumber()/m,N=i.quoteNeedTakePnl.toNumber()/x,v=s.value.uiAmount+k-W,j=l.value.uiAmount+L-N,Z=parseFloat(i.lpReserve.toString()),ee=v/j;return{baseAmount:v,quoteAmount:j,lpSupply:Z,baseVaultKey:i.baseVault,quoteVaultKey:i.quoteVault,baseVaultBalance:s.value.uiAmount,quoteVaultBalance:l.value.uiAmount,openOrdersKey:i.openOrders,openOrdersTotalBase:k,openOrdersTotalQuote:L,basePnl:W,quotePnl:N,priceInQuote:ee}}0&&(module.exports={getAmountSide,getAmountsSide,getAssociatedPoolKeys,getLiquidityAssociatedAuthority,getLiquidityAssociatedId,getLiquidityInfo,getLiquidityProgramId,getLiquidityStateLayout,getPoolEnabledFeatures,getTokenSide,getTokensSide,includesToken,isValidFixedSide,makeSimulationPoolInfo});
//# sourceMappingURL=util.js.map