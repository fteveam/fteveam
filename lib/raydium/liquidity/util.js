var ot=Object.create;var z=Object.defineProperty;var it=Object.getOwnPropertyDescriptor;var st=Object.getOwnPropertyNames;var at=Object.getPrototypeOf,ut=Object.prototype.hasOwnProperty;var ct=(n,t)=>{for(var e in t)z(n,e,{get:t[e],enumerable:!0})},Pe=(n,t,e,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of st(t))!ut.call(n,i)&&i!==e&&z(n,i,{get:()=>t[i],enumerable:!(o=it(t,i))||o.enumerable});return n};var T=(n,t,e)=>(e=n!=null?ot(at(n)):{},Pe(t||!n||!n.__esModule?z(e,"default",{value:n,enumerable:!0}):e,n)),mt=n=>Pe(z({},"__esModule",{value:!0}),n);var zt={};ct(zt,{getAmountSide:()=>vt,getAmountsSide:()=>Yt,getAssociatedPoolKeys:()=>Kt,getLiquidityAssociatedAuthority:()=>tt,getLiquidityAssociatedId:()=>_,getLiquidityInfo:()=>jt,getLiquidityProgramId:()=>et,getLiquidityStateLayout:()=>Ft,getPoolEnabledFeatures:()=>Ut,getTokenSide:()=>fe,getTokensSide:()=>nt,includesToken:()=>Vt,isValidFixedSide:()=>Qt,makeSimulationPoolInfo:()=>Ct});module.exports=mt(zt);var Ze=require("@project-serum/serum"),M=T(require("bn.js"));var V=require("lodash"),ke=T(require("pino")),we=T(require("pino-pretty")),he={},lt={},pt=(0,we.default)({colorize:!0,levelFirst:!0,translateTime:"SYS:yyyymmdd HH:MM:ss.l"}),dt=(0,ke.default)({base:null,level:"silent"},pt);function y(n){let t=(0,V.get)(he,n);if(!t){let e=(0,V.get)(lt,n);t=dt.child({name:n},{level:e}),(0,V.set)(he,n,t)}return t.logWithError=(...e)=>{let o=e.map(i=>typeof i=="object"?JSON.stringify(i):i).join(", ");throw new Error(o)},t}var Se=require("@solana/spl-token"),b=require("@solana/web3.js");function S({pubkey:n,isSigner:t=!1,isWritable:e=!0}){return{pubkey:n,isWritable:e,isSigner:t}}var bt=[S({pubkey:Se.TOKEN_PROGRAM_ID,isWritable:!1}),S({pubkey:b.SystemProgram.programId,isWritable:!1}),S({pubkey:b.SYSVAR_RENT_PUBKEY,isWritable:!1})];function O({publicKey:n,transformSol:t}){if(n instanceof b.PublicKey)return t&&n.equals(U)?Te:n;if(t&&n===U.toBase58())return Te;if(typeof n=="string")try{return new b.PublicKey(n)}catch{throw new Error("invalid public key")}throw new Error("invalid public key")}var Zt=new b.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),en=new b.PublicKey("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),tn=new b.PublicKey("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),nn=new b.PublicKey("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),rn=new b.PublicKey("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),on=new b.PublicKey("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),sn=new b.PublicKey("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),an=new b.PublicKey("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),un=new b.PublicKey("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),cn=new b.PublicKey("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),mn=new b.PublicKey("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Te=new b.PublicKey("So11111111111111111111111111111111111111112"),U=b.PublicKey.default;var I=require("@solana/web3.js");var q=y("Raydium_txTool");function yt(n,t){n.length<1&&q.logWithError(`no instructions provided: ${n.toString()}`),t.length<1&&q.logWithError(`no signers provided:, ${t.toString()}`);let e=new I.Transaction;e.recentBlockhash="11111111111111111111111111111111",e.feePayer=t[0],e.add(...n);let o=e.compileMessage().serialize();return t.length+t.length*64+o.length}async function Le(n,t,e){let o=new I.PublicKey("RaydiumSimuLateTransaction11111111111111111"),i=[],s=new I.Transaction;s.feePayer=o;for(let m of t)yt([...s.instructions,m],[o])>I.PACKET_DATA_SIZE&&(i.push(s),s=new I.Transaction,s.feePayer=o),s.add(m);s.instructions.length>0&&i.push(s);let l=[];try{l=await Promise.all(i.map(m=>n.simulateTransaction(m)))}catch(m){m instanceof Error&&q.logWithError(`failed to simulate for instructions, RPC_ERROR, ${m.message}`)}let p=[];for(let m of l){let{value:x}=m;if(q.debug(`simulate result: ${JSON.stringify(m)}`),x.logs){let k=x.logs.filter(w=>w&&w.includes(e));q.debug(`filteredLog: ${JSON.stringify(p)}`),k.length||q.logWithError(` "simulate log not match keyword, keyword: ${e}`),p.push(...k)}}return p}function Ie(n,t){let e=n.match(/{["\w:,]+}/g);return!e||e.length!==1?q.logWithError(`simulate log fail to match json, keyword: ${t}`):e[0]}function B(n,t){let o=new RegExp(`"${t}":(\\d+)`,"g").exec(n);return!o||o.length!==2?q.logWithError(`simulate log fail to match key", key: ${t}`):o[1]}async function te(n,t){let[e,o]=await I.PublicKey.findProgramAddress(n,t);return{publicKey:e,nonce:o}}var Oe=T(require("big.js")),Y=T(require("bn.js"));var f=T(require("bn.js"));var G=y("Raydium_bignumber");var kn=new f.default(0),Ne=new f.default(1),wn=new f.default(2),Tn=new f.default(3),Sn=new f.default(5),qe=new f.default(10),Ae=new f.default(100),Ln=new f.default(1e3),In=new f.default(1e4),Be=9007199254740991;function P(n){if(n instanceof f.default)return n;if(typeof n=="string"){if(n.match(/^-?[0-9]+$/))return new f.default(n);G.logWithError(`invalid BigNumberish string: ${n}`)}return typeof n=="number"?(n%1&&G.logWithError(`BigNumberish number underflow: ${n}`),(n>=Be||n<=-Be)&&G.logWithError(`BigNumberish number overflow: ${n}`),new f.default(String(n))):typeof n=="bigint"?new f.default(n.toString()):(G.logWithError(`invalid BigNumberish value: ${n}`),new f.default(0))}var De=T(require("toformat")),gt=De.default,F=gt;var K=T(require("big.js")),Ee=T(require("decimal.js-light"));var H=y("module/fraction"),ne=F(K.default),C=F(Ee.default),Pt={[0]:C.ROUND_DOWN,[1]:C.ROUND_HALF_UP,[2]:C.ROUND_UP},ht={[0]:K.default.roundDown,[1]:K.default.roundHalfUp,[2]:K.default.roundUp},u=class{constructor(t,e=Ne){this.numerator=P(t),this.denominator=P(e)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new u(this.denominator,this.numerator)}add(t){let e=t instanceof u?t:new u(P(t));return this.denominator.eq(e.denominator)?new u(this.numerator.add(e.numerator),this.denominator):new u(this.numerator.mul(e.denominator).add(e.numerator.mul(this.denominator)),this.denominator.mul(e.denominator))}sub(t){let e=t instanceof u?t:new u(P(t));return this.denominator.eq(e.denominator)?new u(this.numerator.sub(e.numerator),this.denominator):new u(this.numerator.mul(e.denominator).sub(e.numerator.mul(this.denominator)),this.denominator.mul(e.denominator))}mul(t){let e=t instanceof u?t:new u(P(t));return new u(this.numerator.mul(e.numerator),this.denominator.mul(e.denominator))}div(t){let e=t instanceof u?t:new u(P(t));return new u(this.numerator.mul(e.denominator),this.denominator.mul(e.numerator))}toSignificant(t,e={groupSeparator:""},o=1){Number.isInteger(t)||H.logWithError(`${t} is not an integer.`),t<=0&&H.logWithError(`${t} is not positive.`),C.set({precision:t+1,rounding:Pt[o]});let i=new C(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(t);return i.toFormat(i.decimalPlaces(),e)}toFixed(t,e={groupSeparator:""},o=1){return Number.isInteger(t)||H.logWithError(`${t} is not an integer.`),t<0&&H.logWithError(`${t} is negative.`),ne.DP=t,ne.RM=ht[o]||1,new ne(this.numerator.toString()).div(this.denominator.toString()).toFormat(t,e)}isZero(){return this.numerator.isZero()}};var kt=y("Raydium_amount"),We=F(Oe.default);function wt(n,t){let e="0",o="0";if(n.includes(".")){let i=n.split(".");i.length===2?([e,o]=i,o=o.padEnd(t,"0")):kt.logWithError(`invalid number string, num: ${n}`)}else e=n;return[e,o.slice(0,t)||o]}var A=class extends u{constructor(e,o,i=!0,s){let l=new Y.default(0),p=qe.pow(new Y.default(e.decimals));if(i)l=P(o);else{let m=new Y.default(0),x=new Y.default(0);if(typeof o=="string"||typeof o=="number"||typeof o=="bigint"){let[k,w]=wt(o.toString(),e.decimals);m=P(k),x=P(w)}m=m.mul(p),l=m.add(x)}super(l,p);this.logger=y(s||"Amount"),this.token=e}get raw(){return this.numerator}isZero(){return this.raw.isZero()}gt(e){return this.token.equals(e.token)||this.logger.logWithError("gt token not equals"),this.raw.gt(e.raw)}lt(e){return this.token.equals(e.token)||this.logger.logWithError("lt token not equals"),this.raw.lt(e.raw)}add(e){return this.token.equals(e.token)||this.logger.logWithError("add token not equals"),new A(this.token,this.raw.add(e.raw))}subtract(e){return this.token.equals(e.token)||this.logger.logWithError("sub token not equals"),new A(this.token,this.raw.sub(e.raw))}toSignificant(e=this.token.decimals,o,i=0){return super.toSignificant(e,o,i)}toFixed(e=this.token.decimals,o,i=0){return e>this.token.decimals&&this.logger.logWithError("decimals overflow"),super.toFixed(e,o,i)}toExact(e={groupSeparator:""}){return We.DP=this.token.decimals,new We(this.numerator.toString()).div(this.denominator.toString()).toFormat(e)}};var Re=require("@solana/web3.js"),Me={symbol:"SOL",name:"Solana",decimals:9},E={symbol:"WSOL",name:"Wrapped SOL",mint:"So11111111111111111111111111111111111111112",decimals:9,extensions:{coingeckoId:"solana"}},Qn={isQuantumSOL:!0,isLp:!1,official:!0,mint:new Re.PublicKey(E.mint),decimals:9,symbol:"SOL",id:"sol",name:"solana",icon:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",extensions:{coingeckoId:"solana"}};var X=require("@solana/web3.js");var re=class{constructor({mint:t,decimals:e,symbol:o="UNKNOWN",name:i="UNKNOWN",skipMint:s=!1}){if(t===U.toBase58()||t instanceof X.PublicKey&&U.equals(t)){this.decimals=E.decimals,this.symbol=E.symbol,this.name=E.name,this.mint=new X.PublicKey(E.mint);return}this.decimals=e,this.symbol=o,this.name=i,this.mint=s?X.PublicKey.default:O({publicKey:t})}equals(t){return this===t?!0:this.mint.equals(t.mint)}},D=re;D.WSOL=new re(E);var ie=class{constructor({decimals:t,symbol:e="UNKNOWN",name:o="UNKNOWN"}){this.decimals=t,this.symbol=e,this.name=o}equals(t){return this===t}},oe=ie;oe.SOL=new ie(Me);var rr=new u(Ae);var lr=y("Raydium_price");var se=require("@solana/web3.js"),ae=T(require("bn.js"));var kr=new ae.default(25),wr=new ae.default(1e4),ve="675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8",Tt=new se.PublicKey(ve),Ve="5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h",St=new se.PublicKey(Ve),Tr={[ve]:4,[Ve]:5},Ue={4:Tt,5:St},Fe={4:3,5:3};var Ot=require("@solana/spl-token"),de=require("@solana/web3.js");var Qe=require("@solana/web3.js"),R=T(require("bn.js"));var a=require("@solana/buffer-layout"),ue=a.Layout,Ke=a.Structure;var Ce=a.UInt;var Ye=a.seq;var ce=a.blob;var $=class extends ue{constructor(e,o,i){super(e,i);this.blob=ce(e),this.signed=o}decode(e,o=0){let i=new R.default(this.blob.decode(e,o),10,"le");return this.signed?i.fromTwos(this.span*8).clone():i}encode(e,o,i=0){return typeof e=="number"&&(e=new R.default(e)),this.signed&&(e=e.toTwos(this.span*8)),this.blob.encode(e.toArrayLike(Buffer,"le",this.span),o,i)}};function h(n){return new Ce(1,n)}function r(n){return new $(8,!1,n)}function L(n){return new $(16,!1,n)}var me=class extends ue{constructor(e,o,i,s){super(e.span,s);this.layout=e,this.decoder=o,this.encoder=i}decode(e,o){return this.decoder(this.layout.decode(e,o))}encode(e,o,i){return this.layout.encode(this.encoder(e),o,i)}getSpan(e,o){return this.layout.getSpan(e,o)}};function c(n){return new me(ce(32),t=>new Qe.PublicKey(t),t=>t.toBuffer(),n)}var le=class extends Ke{decode(t,e){return super.decode(t,e)}};function g(n,t,e){return new le(n,t,e)}function Q(n,t,e){let o,i=typeof t=="number"?t:(0,R.isBN)(t)?t.toNumber():new Proxy(t,{get(s,l){if(!o){let p=Reflect.get(s,"count");o=(0,R.isBN)(p)?p.toNumber():p,Reflect.set(s,"count",o)}return Reflect.get(s,l)},set(s,l,p){return l==="count"&&(o=p),Reflect.set(s,l,p)}});return Ye(n,i,e)}var Lt=g([h("instruction"),r("amountIn"),r("minAmountOut")]),It=g([h("instruction"),r("maxAmountIn"),r("amountOut")]),Bt=g([h("instruction"),h("nonce")]),_t=g([h("instruction"),h("nonce"),r("startTime")]),pe=g([r("status"),r("nonce"),r("maxOrder"),r("depth"),r("baseDecimal"),r("quoteDecimal"),r("state"),r("resetFlag"),r("minSize"),r("volMaxCutRatio"),r("amountWaveRatio"),r("baseLotSize"),r("quoteLotSize"),r("minPriceMultiplier"),r("maxPriceMultiplier"),r("systemDecimalValue"),r("minSeparateNumerator"),r("minSeparateDenominator"),r("tradeFeeNumerator"),r("tradeFeeDenominator"),r("pnlNumerator"),r("pnlDenominator"),r("swapFeeNumerator"),r("swapFeeDenominator"),r("baseNeedTakePnl"),r("quoteNeedTakePnl"),r("quoteTotalPnl"),r("baseTotalPnl"),L("quoteTotalDeposited"),L("baseTotalDeposited"),L("swapBaseInAmount"),L("swapQuoteOutAmount"),r("swapBase2QuoteFee"),L("swapQuoteInAmount"),L("swapBaseOutAmount"),r("swapQuote2BaseFee"),c("baseVault"),c("quoteVault"),c("baseMint"),c("quoteMint"),c("lpMint"),c("openOrders"),c("marketId"),c("marketProgramId"),c("targetOrders"),c("withdrawQueue"),c("lpVault"),c("owner"),r("lpReserve"),Q(r(),3,"padding")]),Nt=g([r("accountType"),r("status"),r("nonce"),r("maxOrder"),r("depth"),r("baseDecimal"),r("quoteDecimal"),r("state"),r("resetFlag"),r("minSize"),r("volMaxCutRatio"),r("amountWaveRatio"),r("baseLotSize"),r("quoteLotSize"),r("minPriceMultiplier"),r("maxPriceMultiplier"),r("systemDecimalsValue"),r("abortTradeFactor"),r("priceTickMultiplier"),r("priceTick"),r("minSeparateNumerator"),r("minSeparateDenominator"),r("tradeFeeNumerator"),r("tradeFeeDenominator"),r("pnlNumerator"),r("pnlDenominator"),r("swapFeeNumerator"),r("swapFeeDenominator"),r("baseNeedTakePnl"),r("quoteNeedTakePnl"),r("quoteTotalPnl"),r("baseTotalPnl"),r("poolOpenTime"),r("punishPcAmount"),r("punishCoinAmount"),r("orderbookToInitTime"),L("swapBaseInAmount"),L("swapQuoteOutAmount"),L("swapQuoteInAmount"),L("swapBaseOutAmount"),r("swapQuote2BaseFee"),r("swapBase2QuoteFee"),c("baseVault"),c("quoteVault"),c("baseMint"),c("quoteMint"),c("lpMint"),c("modelDataAccount"),c("openOrders"),c("marketId"),c("marketProgramId"),c("targetOrders"),c("owner"),Q(r(),64,"padding")]),qt=g([h("instruction"),r("baseAmountIn"),r("quoteAmountIn"),r("fixedSide")]),At=g([h("instruction"),r("amountIn")]),je={4:pe,5:Nt};var ze=require("@solana/web3.js");var Dt=new ze.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Et=5e4,Wt=g([r("x"),r("y"),r("price")]),Fr=g([r("accountType"),r("status"),r("multiplier"),r("validDataCount"),Q(Wt,Et,"DataElement")]);var $r=y("Raydium_liquidity_instruction");function Ge(n){let t=g([h("instruction"),h("simulateType")]),e=Buffer.alloc(t.span);t.encode({instruction:12,simulateType:0},e);let o=[S({pubkey:n.id,isWritable:!1}),S({pubkey:n.authority,isWritable:!1}),S({pubkey:n.openOrders,isWritable:!1}),S({pubkey:n.baseVault,isWritable:!1}),S({pubkey:n.quoteVault,isWritable:!1}),S({pubkey:n.lpMint,isWritable:!1}),S({pubkey:n.marketId,isWritable:!1})];return new de.TransactionInstruction({programId:n.programId,keys:o,data:e})}var be=require("@solana/web3.js");var ye=y("Raydium_liquidity_serum"),He="9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin",Rt=new be.PublicKey(He),to={[He]:3},Mt={3:Rt};function Xe(n){let t=Fe[n];return t||ye.logWithError("invalid version","version",n),t}function $e(n){let t=Mt[n];return t||ye.logWithError("invalid version","version",n),t}async function Je({programId:n,marketId:t}){let e=[t.toBuffer()],o=0,i;for(;o<100;){try{let s=e.concat(Buffer.from([o]),Buffer.alloc(7));i=await be.PublicKey.createProgramAddress(s,n)}catch(s){if(s instanceof TypeError)throw s;o++;continue}return{publicKey:i,nonce:o}}throw ye.logWithError("unable to find a viable program address nonce","params",{programId:n,marketId:t}),new Error("unable to find a viable program address nonce")}var J=y("Raydium_liquidity_util");function vt(n,t){let e=n instanceof A?n.token:D.WSOL,{baseMint:o,quoteMint:i}=t;if(e.mint.equals(o))return"base";if(e.mint.equals(i))return"quote";let s=`liquidity getTokenSide - token not match with pool, params: ${JSON.stringify({token:e.mint,baseMint:o,quoteMint:i})}`;throw console.error(s),new Error(s)}function Vt(n,t){let{baseMint:e,quoteMint:o}=t;return n.mint.equals(e)||n.mint.equals(o)}function Ut(n){let{status:t,startTime:e}=n,o=t.toNumber();return{[0]:{swap:!1,addLiquidity:!1,removeLiquidity:!1},[1]:{swap:!0,addLiquidity:!0,removeLiquidity:!0},[2]:{swap:!1,addLiquidity:!1,removeLiquidity:!1},[3]:{swap:!1,addLiquidity:!1,removeLiquidity:!0},[4]:{swap:!1,addLiquidity:!0,removeLiquidity:!0},[5]:{swap:!1,addLiquidity:!0,removeLiquidity:!0},[6]:{swap:!0,addLiquidity:!0,removeLiquidity:!0},[7]:{swap:Date.now()/1e3>=e.toNumber(),addLiquidity:!0,removeLiquidity:!0}}[o]||{swap:!1,addLiquidity:!1,removeLiquidity:!1}}function Ft(n){let t=je[n];return t||J.logWithError("invalid version","version",n),t}function et(n){let t=Ue[n];return t||J.logWithError("invalid version","version",n),t}async function _({name:n,programId:t,marketId:e}){let{publicKey:o}=await te([t.toBuffer(),e.toBuffer(),Buffer.from(n,"utf-8")],t);return o}async function tt({programId:n}){return te([Buffer.from([97,109,109,32,97,117,116,104,111,114,105,116,121])],n)}async function Kt({version:n,marketId:t,baseMint:e,quoteMint:o}){let i=et(n),[s,l,p]=[O({publicKey:t}),O({publicKey:e,transformSol:!0}),O({publicKey:o,transformSol:!0})],m=await _({name:"amm_associated_seed",programId:i,marketId:s}),x=await _({name:"lp_mint_associated_seed",programId:i,marketId:s}),{publicKey:k,nonce:w}=await tt({programId:i}),W=await _({name:"coin_vault_associated_seed",programId:i,marketId:s}),N=await _({name:"pc_vault_associated_seed",programId:i,marketId:s}),v=await _({name:"temp_lp_token_associated_seed",programId:i,marketId:s}),j=await _({name:"open_order_associated_seed",programId:i,marketId:s}),Z=await _({name:"target_associated_seed",programId:i,marketId:s}),ee=await _({name:"withdraw_associated_seed",programId:i,marketId:s}),ge=Xe(n),xe=$e(ge),{publicKey:rt}=await Je({programId:xe,marketId:s});return{id:m,baseMint:l,quoteMint:p,lpMint:x,version:n,programId:i,authority:k,nonce:w,baseVault:W,quoteVault:N,lpVault:v,openOrders:j,targetOrders:Z,withdrawQueue:ee,marketVersion:ge,marketProgramId:xe,marketId:s,marketAuthority:rt}}async function Ct({connection:n,pools:t}){let e=t.map(i=>Ge(i));return(await Le(n,e,"GetPoolData")).map(i=>{let s=Ie(i,"GetPoolData"),l=new M.default(B(s,"status")),p=Number(B(s,"coin_decimals")),m=Number(B(s,"pc_decimals")),x=Number(B(s,"lp_decimals")),k=new M.default(B(s,"pool_coin_amount")),w=new M.default(B(s,"pool_pc_amount")),W=new M.default(B(s,"pool_lp_supply")),N="0";try{N=B(s,"pool_open_time")}catch{N="0"}return{status:l,baseDecimals:p,quoteDecimals:m,lpDecimals:x,baseReserve:k,quoteReserve:w,lpSupply:W,startTime:new M.default(N)}})}function Yt(n,t,e){return nt(n.token,t.token,e)}function nt(n,t,e){let{baseMint:o,quoteMint:i}=e,s=fe(n,e),l=fe(t,e);return s===l&&J.logWithError("tokens not match with pool","params",{tokenA:n.mint,tokenB:t.mint,baseMint:o,quoteMint:i}),[s,l]}function fe(n,t){let{baseMint:e,quoteMint:o}=t;return n.mint.equals(e)?"base":n.mint.equals(o)?"quote":(J.logWithError("token not match with pool","params",{token:n.mint,baseMint:e,quoteMint:o}),"base")}var Qt=n=>n==="a"||n==="b";async function jt(n,t,e){let o=await n.getAccountInfo(t);if(o===null)return null;let i=pe.decode(o.data),s=await n.getTokenAccountBalance(i.baseVault),l=await n.getTokenAccountBalance(i.quoteVault),p=await Ze.OpenOrders.load(n,i.openOrders,e),m=10**i.baseDecimal.toNumber(),x=10**i.quoteDecimal.toNumber(),k=p.baseTokenTotal.toNumber()/m,w=p.quoteTokenTotal.toNumber()/x,W=i.baseNeedTakePnl.toNumber()/m,N=i.quoteNeedTakePnl.toNumber()/x,v=s.value.uiAmount+k-W,j=l.value.uiAmount+w-N,Z=parseFloat(i.lpReserve.toString()),ee=v/j;return{baseAmount:v,quoteAmount:j,lpSupply:Z,baseVaultKey:i.baseVault,quoteVaultKey:i.quoteVault,baseVaultBalance:s.value.uiAmount,quoteVaultBalance:l.value.uiAmount,openOrdersKey:i.openOrders,openOrdersTotalBase:k,openOrdersTotalQuote:w,basePnl:W,quotePnl:N,priceInQuote:ee}}0&&(module.exports={getAmountSide,getAmountsSide,getAssociatedPoolKeys,getLiquidityAssociatedAuthority,getLiquidityAssociatedId,getLiquidityInfo,getLiquidityProgramId,getLiquidityStateLayout,getPoolEnabledFeatures,getTokenSide,getTokensSide,includesToken,isValidFixedSide,makeSimulationPoolInfo});
//# sourceMappingURL=util.js.map