var Gi=Object.create;var at=Object.defineProperty,Ji=Object.defineProperties,$i=Object.getOwnPropertyDescriptor,ji=Object.getOwnPropertyDescriptors,Yi=Object.getOwnPropertyNames,Nt=Object.getOwnPropertySymbols,Qi=Object.getPrototypeOf,hn=Object.prototype.hasOwnProperty,ur=Object.prototype.propertyIsEnumerable;var sr=(n,t,e)=>t in n?at(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,L=(n,t)=>{for(var e in t||(t={}))hn.call(t,e)&&sr(n,e,t[e]);if(Nt)for(var e of Nt(t))ur.call(t,e)&&sr(n,e,t[e]);return n},K=(n,t)=>Ji(n,ji(t));var ne=(n,t)=>{var e={};for(var o in n)hn.call(n,o)&&t.indexOf(o)<0&&(e[o]=n[o]);if(n!=null&&Nt)for(var o of Nt(n))t.indexOf(o)<0&&ur.call(n,o)&&(e[o]=n[o]);return e};var Hi=(n,t)=>{for(var e in t)at(n,e,{get:t[e],enumerable:!0})},cr=(n,t,e,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of Yi(t))!hn.call(n,r)&&r!==e&&at(n,r,{get:()=>t[r],enumerable:!(o=$i(t,r))||o.enumerable});return n};var H=(n,t,e)=>(e=n!=null?Gi(Qi(n)):{},cr(t||!n||!n.__esModule?at(e,"default",{value:n,enumerable:!0}):e,n)),zi=n=>cr(at({},"__esModule",{value:!0}),n);var Da={};Hi(Da,{DataElement:()=>wi,FARM_LOCK_MINT:()=>jn,FARM_LOCK_VAULT:()=>Yn,FARM_PROGRAMID_TO_VERSION:()=>Jn,FARM_PROGRAM_ID_V3:()=>Wn,FARM_PROGRAM_ID_V3_PUBKEY:()=>ai,FARM_PROGRAM_ID_V5:()=>Un,FARM_PROGRAM_ID_V5_PUBKEY:()=>si,FARM_PROGRAM_ID_V6:()=>Gn,FARM_PROGRAM_ID_V6_PUBKEY:()=>ui,FARM_VERSION_TO_LEDGER_LAYOUT:()=>Hn,FARM_VERSION_TO_PROGRAMID:()=>$n,FARM_VERSION_TO_STATE_LAYOUT:()=>Qn,LIQUIDITY_FEES_DENOMINATOR:()=>fo,LIQUIDITY_FEES_NUMERATOR:()=>po,LIQUIDITY_PROGRAMID_TO_VERSION:()=>Aa,LIQUIDITY_PROGRAM_ID_V4:()=>yi,LIQUIDITY_PROGRAM_ID_V5:()=>bi,LIQUIDITY_VERSION_TO_PROGRAM_ID:()=>go,LIQUIDITY_VERSION_TO_SERUM_VERSION:()=>Po,LIQUIDITY_VERSION_TO_STATE_LAYOUT:()=>wo,LiquidityPoolStatus:()=>lo,MODEL_DATA_PUBKEY:()=>Pe,ROUTE_PROGRAM_ID_V1:()=>et,Raydium:()=>Mt,SERUM_PROGRAMID_TO_VERSION:()=>Ka,SERUM_PROGRAM_ID_V3:()=>Si,SERUM_VERSION_TO_PROGRAM_ID:()=>Li,SPL_MINT_LAYOUT:()=>gn,StableLayout:()=>kt,TOKEN_SOL:()=>In,TOKEN_WSOL:()=>$,_LIQUIDITY_PROGRAM_ID_V4:()=>yo,_LIQUIDITY_PROGRAM_ID_V5:()=>bo,_ROUTE_PROGRAM_ID_V1:()=>qi,_SERUM_PROGRAM_ID_V3:()=>Ko,addLiquidityLayout:()=>cn,associatedLedgerAccountLayout:()=>Yt,calFarmRewardAmount:()=>tn,calculateFarmPoolAprList:()=>uo,closeAccountInstruction:()=>Ke,createAssociatedLedgerAccountInstruction:()=>eo,createPoolV4Layout:()=>an,createWSolAccountInstructions:()=>xe,defaultRoutes:()=>Vo,dwLayout:()=>ze,farmAddRewardLayout:()=>Zt,farmDespotVersionToInstruction:()=>zn,farmLedgerLayoutV3_1:()=>Pa,farmLedgerLayoutV3_2:()=>En,farmLedgerLayoutV5_1:()=>wa,farmLedgerLayoutV5_2:()=>Vn,farmLedgerLayoutV6_1:()=>Cn,farmRewardInfoToConfig:()=>ro,farmRewardLayout:()=>Ht,farmRewardRestartLayout:()=>zt,farmRewardTimeInfoLayout:()=>ri,farmStateV3Layout:()=>vn,farmStateV5Layout:()=>Dn,farmStateV6Layout:()=>He,farmWithdrawVersionToInstruction:()=>Zn,fetchMultipleFarmInfoAndUpdate:()=>fi,fixedSwapInLayout:()=>on,fixedSwapOutLayout:()=>rn,formatLayout:()=>Ai,getAmountSide:()=>fn,getAmountsSide:()=>Do,getAssociatedAuthority:()=>no,getAssociatedLedgerAccount:()=>en,getAssociatedLedgerPoolAccount:()=>wt,getAssociatedMiddleStatusAccount:()=>Uo,getAssociatedPoolKeys:()=>bn,getDxByDyBaseIn:()=>To,getDyByDxBaseIn:()=>ko,getFarmLedgerLayout:()=>li,getFarmProgramId:()=>oo,getFarmStateLayout:()=>di,getFarmVersion:()=>mi,getLiquidityAssociatedAuthority:()=>Mi,getLiquidityAssociatedId:()=>Se,getLiquidityInfo:()=>qa,getLiquidityProgramId:()=>Ri,getLiquidityStateLayout:()=>Oa,getPoolEnabledFeatures:()=>yn,getSPLTokenInfo:()=>Na,getSerumAssociatedAuthority:()=>Fo,getSerumProgramId:()=>qo,getSerumVersion:()=>Oo,getStablePrice:()=>Ao,getTokenSide:()=>No,getTokensSide:()=>Bi,groupPools:()=>jo,includesToken:()=>Ge,initPoolLayout:()=>sn,initTokenAccountInstruction:()=>zr,isValidFarmVersion:()=>Xt,isValidFixedSide:()=>Eo,judgeFarmType:()=>ao,liquidityStateV4Layout:()=>un,liquidityStateV5Layout:()=>gi,makeAMMSwapInstruction:()=>Io,makeAddLiquidityInstruction:()=>_o,makeCreateFarmInstruction:()=>to,makeCreatePoolInstruction:()=>So,makeInitPoolInstruction:()=>Lo,makeRemoveLiquidityInstruction:()=>Ro,makeRouteSwapInstruction:()=>Wo,makeSimulatePoolInfoInstruction:()=>xo,makeSimulationPoolInfo:()=>vo,makeSwapFixedInInstruction:()=>Ii,makeSwapFixedOutInstruction:()=>xi,makeSwapInFixedInInstruction:()=>Fi,makeSwapOutFixedInInstruction:()=>Ni,makeTransferInstruction:()=>Ve,mergeSdkFarmInfo:()=>io,modelDataInfoLayout:()=>hi,parseTokenAccountResp:()=>Nn,poolTypeV6:()=>gt,quantumSOLHydratedTokenJsonInfo:()=>$e,realFarmStateV3Layout:()=>ti,realFarmStateV5Layout:()=>ni,realFarmV6Layout:()=>oi,removeLiquidityLayout:()=>mn,routeSwapInLayout:()=>At,routeSwapOutLayout:()=>It,sortTokens:()=>Jo,splAccountLayout:()=>ge,swapRouteMiddleMints:()=>Co,unionArr:()=>va,updateFarmPoolInfo:()=>pi,validateFarmRewards:()=>Xn,whetherIsStakeFarmPool:()=>so,withdrawRewardLayout:()=>Qt});module.exports=zi(Da);var Di=require("lodash");var Jr=H(require("axios"));var st=require("lodash"),lr=H(require("pino")),dr=H(require("pino-pretty")),mr={},Zi={},Xi=(0,dr.default)({colorize:!0,levelFirst:!0,translateTime:"SYS:yyyymmdd HH:MM:ss.l"}),ea=(0,lr.default)({base:null,level:"silent"},Xi);function M(n){let t=(0,st.get)(mr,n);if(!t){let e=(0,st.get)(Zi,n);t=ea.child({name:n},{level:e}),(0,st.set)(mr,n,t)}return t.logWithError=(...e)=>{let o=e.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(o)},t}var Kr=require("@solana/web3.js"),Or=H(require("bn.js"));var hr=H(require("big.js")),pt=H(require("bn.js"));var V=H(require("bn.js"));var vt=M("Raydium_bignumber");var ue=new V.default(0),be=new V.default(1),Ja=new V.default(2),$a=new V.default(3),ja=new V.default(5),Te=new V.default(10),yr=new V.default(100),Ya=new V.default(1e3),Qa=new V.default(1e4),pr=9007199254740991;function I(n){if(n instanceof V.default)return n;if(typeof n=="string"){if(n.match(/^-?[0-9]+$/))return new V.default(n);vt.logWithError(`invalid BigNumberish string: ${n}`)}return typeof n=="number"?(n%1&&vt.logWithError(`BigNumberish number underflow: ${n}`),(n>=pr||n<=-pr)&&vt.logWithError(`BigNumberish number overflow: ${n}`),new V.default(String(n))):typeof n=="bigint"?new V.default(n.toString()):(vt.logWithError(`invalid BigNumberish value: ${n}`),new V.default(0))}function kn(n){return Te.pow(I(n))}function ce(n){var u;if(n===void 0)return{denominator:"1",numerator:"0"};if(n instanceof V.default)return{numerator:n.toString(),denominator:"1"};if(n instanceof A)return{denominator:n.denominator.toString(),numerator:n.numerator.toString()};let t=String(n),[,e="",o="",r=""]=(u=t.replace(",","").match(/(-?)(\d*)\.?(\d*)/))!=null?u:[],i="1"+"0".repeat(r.length),a=e+(o==="0"?"":o)+r||"0";return{denominator:i,numerator:a,sign:e,int:o,dec:r}}function Tn(n,t){let e=n.divmod(t);return e.mod.isZero()?e.div:e.div.negative!==0?e.div.isubn(1):e.div.iaddn(1)}function ta(n){var o;let[,t="",e=""]=(o=n.toFixed(2).match(/(-?)(\d*)\.?(\d*)/))!=null?o:[];return`${t}${e}`}function _e(n,t=0){return n instanceof V.default?n:new V.default(ta(ve(n).mul(Te.pow(new V.default(String(t))))))}function ve(n){if(n instanceof re)return new A(n.numerator,n.denominator);if(n instanceof Z)return n.adjusted;if(n instanceof O)try{return ve(n.toExact())}catch{return new A(ue)}if(n instanceof A)return n;let t=String(n),e=ce(t);return new A(e.numerator,e.denominator)}function Dt(n,t){let{numerator:e,denominator:o}=ce(n);return new re(new V.default(e),new V.default(o).mul(t!=null&&t.alreadyDecimaled?new V.default(100):new V.default(1)))}function ut(n){let{token:t,numberPrice:e,decimalDone:o}=n,r=new J({mint:"",decimals:6,symbol:"usd",name:"usd",skipMint:!0}),{numerator:i,denominator:a}=ce(e),u=o?new V.default(i).mul(Te.pow(new V.default(t.decimals))):i,c=new V.default(a).mul(Te.pow(new V.default(r.decimals)));return new Z({baseToken:r,denominator:c.toString(),quoteToken:new J(K(L({},t),{skipMint:!0,mint:""})),numerator:u.toString()})}function br(n,t){if(n==null||t==null)return;let e=ve(n),o=ve(t);return e.mul(o)}function fr(n){let t=new J({mint:"",decimals:6,symbol:"usd",name:"usd",skipMint:!0}),e=_e(br(n,10**t.decimals));return new O(t,e)}function ct(n,t){return fr(!t||!n?0:br(n,t))}var gr=H(require("toformat")),na=gr.default,mt=na;var lt=H(require("big.js")),Pr=H(require("decimal.js-light"));var Et=M("module/fraction"),An=mt(lt.default),dt=mt(Pr.default),ra={[0]:dt.ROUND_DOWN,[1]:dt.ROUND_HALF_UP,[2]:dt.ROUND_UP},ia={[0]:lt.default.roundDown,[1]:lt.default.roundHalfUp,[2]:lt.default.roundUp},A=class{constructor(t,e=be){this.numerator=I(t),this.denominator=I(e)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new A(this.denominator,this.numerator)}add(t){let e=t instanceof A?t:new A(I(t));return this.denominator.eq(e.denominator)?new A(this.numerator.add(e.numerator),this.denominator):new A(this.numerator.mul(e.denominator).add(e.numerator.mul(this.denominator)),this.denominator.mul(e.denominator))}sub(t){let e=t instanceof A?t:new A(I(t));return this.denominator.eq(e.denominator)?new A(this.numerator.sub(e.numerator),this.denominator):new A(this.numerator.mul(e.denominator).sub(e.numerator.mul(this.denominator)),this.denominator.mul(e.denominator))}mul(t){let e=t instanceof A?t:new A(I(t));return new A(this.numerator.mul(e.numerator),this.denominator.mul(e.denominator))}div(t){let e=t instanceof A?t:new A(I(t));return new A(this.numerator.mul(e.denominator),this.denominator.mul(e.numerator))}toSignificant(t,e={groupSeparator:""},o=1){Number.isInteger(t)||Et.logWithError(`${t} is not an integer.`),t<=0&&Et.logWithError(`${t} is not positive.`),dt.set({precision:t+1,rounding:ra[o]});let r=new dt(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(t);return r.toFormat(r.decimalPlaces(),e)}toFixed(t,e={groupSeparator:""},o=1){return Number.isInteger(t)||Et.logWithError(`${t} is not an integer.`),t<0&&Et.logWithError(`${t} is negative.`),An.DP=t,An.RM=ia[o]||1,new An(this.numerator.toString()).div(this.denominator.toString()).toFormat(t,e)}isZero(){return this.numerator.isZero()}};var aa=M("Raydium_amount"),wr=mt(hr.default);function sa(n,t){let e="0",o="0";if(n.includes(".")){let r=n.split(".");r.length===2?([e,o]=r,o=o.padEnd(t,"0")):aa.logWithError(`invalid number string, num: ${n}`)}else e=n;return[e,o.slice(0,t)||o]}var O=class extends A{constructor(e,o,r=!0,i){let a=new pt.default(0),u=Te.pow(new pt.default(e.decimals));if(r)a=I(o);else{let c=new pt.default(0),m=new pt.default(0);if(typeof o=="string"||typeof o=="number"||typeof o=="bigint"){let[d,p]=sa(o.toString(),e.decimals);c=I(d),m=I(p)}c=c.mul(u),a=c.add(m)}super(a,u);this.logger=M(i||"Amount"),this.token=e}get raw(){return this.numerator}isZero(){return this.raw.isZero()}gt(e){return this.token.equals(e.token)||this.logger.logWithError("gt token not equals"),this.raw.gt(e.raw)}lt(e){return this.token.equals(e.token)||this.logger.logWithError("lt token not equals"),this.raw.lt(e.raw)}add(e){return this.token.equals(e.token)||this.logger.logWithError("add token not equals"),new O(this.token,this.raw.add(e.raw))}subtract(e){return this.token.equals(e.token)||this.logger.logWithError("sub token not equals"),new O(this.token,this.raw.sub(e.raw))}toSignificant(e=this.token.decimals,o,r=0){return super.toSignificant(e,o,r)}toFixed(e=this.token.decimals,o,r=0){return e>this.token.decimals&&this.logger.logWithError("decimals overflow"),super.toFixed(e,o,r)}toExact(e={groupSeparator:""}){return wr.DP=this.token.decimals,new wr(this.numerator.toString()).div(this.denominator.toString()).toFormat(e)}};var kr=require("@solana/web3.js"),In={symbol:"SOL",name:"Solana",decimals:9},$={symbol:"WSOL",name:"Wrapped SOL",mint:"So11111111111111111111111111111111111111112",decimals:9,extensions:{coingeckoId:"solana"}},$e={isQuantumSOL:!0,isLp:!1,official:!0,mint:new kr.PublicKey($.mint),decimals:9,symbol:"SOL",id:"sol",name:"solana",icon:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",extensions:{coingeckoId:"solana"}};var Ct=require("@solana/web3.js");var Tr=require("@solana/spl-token"),j=require("@solana/web3.js");function s({pubkey:n,isSigner:t=!1,isWritable:e=!0}){return{pubkey:n,isWritable:e,isSigner:t}}var De=[s({pubkey:Tr.TOKEN_PROGRAM_ID,isWritable:!1}),s({pubkey:j.SystemProgram.programId,isWritable:!1}),s({pubkey:j.SYSVAR_RENT_PUBKEY,isWritable:!1})];function C({publicKey:n,transformSol:t}){if(n instanceof j.PublicKey)return t&&n.equals(U)?Re:n;if(t&&n===U.toBase58())return Re;if(typeof n=="string")try{return new j.PublicKey(n)}catch{throw new Error("invalid public key")}throw new Error("invalid public key")}function Ar(n){try{return new j.PublicKey(n)}catch{return n}}var Vt=new j.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),Ir=new j.PublicKey("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),fs=new j.PublicKey("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),xr=new j.PublicKey("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),Sr=new j.PublicKey("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),Lr=new j.PublicKey("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),_r=new j.PublicKey("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),Rr=new j.PublicKey("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),ys=new j.PublicKey("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),bs=new j.PublicKey("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),Mr=new j.PublicKey("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Re=new j.PublicKey("So11111111111111111111111111111111111111112"),U=j.PublicKey.default;var xn=class{constructor({mint:t,decimals:e,symbol:o="UNKNOWN",name:r="UNKNOWN",skipMint:i=!1}){if(t===U.toBase58()||t instanceof Ct.PublicKey&&U.equals(t)){this.decimals=$.decimals,this.symbol=$.symbol,this.name=$.name,this.mint=new Ct.PublicKey($.mint);return}this.decimals=e,this.symbol=o,this.name=r,this.mint=i?Ct.PublicKey.default:C({publicKey:t})}equals(t){return this===t?!0:this.mint.equals(t.mint)}},J=xn;J.WSOL=new xn($);var Ln=class{constructor({decimals:t,symbol:e="UNKNOWN",name:o="UNKNOWN"}){this.decimals=t,this.symbol=e,this.name=o}equals(t){return this===t}},Sn=Ln;Sn.SOL=new Ln(In);var Br=new A(yr),re=class extends A{toSignificant(t=5,e,o){return this.mul(Br).toSignificant(t,e,o)}toFixed(t=2,e,o){return this.mul(Br).toFixed(t,e,o)}};var ua=M("Raydium_price"),Z=class extends A{constructor(e){let{baseToken:o,quoteToken:r,numerator:i,denominator:a}=e;super(i,a);this.baseToken=o,this.quoteToken=r,this.scalar=new A(kn(o.decimals),kn(r.decimals))}get raw(){return new A(this.numerator,this.denominator)}get adjusted(){return super.mul(this.scalar)}invert(){return new Z({baseToken:this.quoteToken,quoteToken:this.baseToken,denominator:this.numerator,numerator:this.denominator})}mul(e){this.quoteToken!==e.baseToken&&ua.logWithError("mul token not equals");let o=super.mul(e);return new Z({baseToken:this.baseToken,quoteToken:e.quoteToken,denominator:o.denominator,numerator:o.numerator})}toSignificant(e=this.quoteToken.decimals,o,r){return this.adjusted.toSignificant(e,o,r)}toFixed(e=this.quoteToken.decimals,o,r){return this.adjusted.toFixed(e,o,r)}};var ca=[J,O,Kr.PublicKey,A,Or.default,Z,re];function ma(n){return typeof n=="object"&&n!==null&&!ca.some(t=>typeof t=="object"&&n instanceof t)}function pe(n){return typeof n=="string"?Ar(n):Array.isArray(n)?n.map(t=>pe(t)):ma(n)?Object.fromEntries(Object.entries(n).map(([t,e])=>[t,pe(e)])):n}var se=require("@solana/web3.js");var Me=M("Raydium_txTool"),Wt=class{constructor(t){this.instructions=[];this.endInstructions=[];this.signers=[];this.connection=t.connection,this.feePayer=t.feePayer,this.signAllTransactions=t.signAllTransactions,this.owner=t.owner}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers}}get allInstructions(){return[...this.instructions,...this.endInstructions]}addInstruction({instructions:t=[],endInstructions:e=[],signers:o=[]}){return this.instructions.push(...t),this.endInstructions.push(...e),this.signers.push(...o),this}build(t){let e=new se.Transaction;return this.allInstructions.length&&e.add(...this.allInstructions),e.feePayer=this.feePayer,{transaction:e,signers:this.signers,execute:async()=>{var r;let o=await qr(this.connection);if(e.recentBlockhash=o,(r=this.owner)!=null&&r.isKeyPair)return(0,se.sendAndConfirmTransaction)(this.connection,e,this.signers);if(this.signAllTransactions){this.signers.length&&e.partialSign(...this.signers);let i=await this.signAllTransactions([e]);return await this.connection.sendRawTransaction(i[0].serialize(),{skipPreflight:!0})}throw new Error("please connect wallet first")},extInfo:t||{}}}buildMultiTx(t){let{extraPreBuildData:e=[],extInfo:o}=t,{transaction:r}=this.build(o),i=e.filter(c=>c.transaction.instructions.length>0),a=[...i.map(c=>c.transaction),r],u=[...i.map(c=>c.signers),this.signers];return{transactions:a,signers:u,execute:async()=>{var m;let c=await qr(this.connection);if((m=this.owner)!=null&&m.isKeyPair)return await Promise.all(a.map(async(d,p)=>(d.recentBlockhash=c,await(0,se.sendAndConfirmTransaction)(this.connection,d,u[p]))));if(this.signAllTransactions){let d=a.map((f,b)=>(f.recentBlockhash=c,u[b].length&&f.partialSign(...u[b]),f)),p=await this.signAllTransactions(d),y=[];for(let f=0;f<p.length;f+=1){let b=await this.connection.sendRawTransaction(p[f].serialize(),{skipPreflight:!0});y.push(b)}return y}throw new Error("please connect wallet first")},extInfo:o||{}}}};async function qr(n){var t,e;try{return((e=await((t=n.getLatestBlockhash)==null?void 0:t.call(n)))==null?void 0:e.blockhash)||(await n.getRecentBlockhash()).blockhash}catch{return(await n.getRecentBlockhash()).blockhash}}function la(n,t){n.length<1&&Me.logWithError(`no instructions provided: ${n.toString()}`),t.length<1&&Me.logWithError(`no signers provided:, ${t.toString()}`);let e=new se.Transaction;e.recentBlockhash="11111111111111111111111111111111",e.feePayer=t[0],e.add(...n);let o=e.compileMessage().serialize();return t.length+t.length*64+o.length}async function Fr(n,t,e){let o=new se.PublicKey("RaydiumSimuLateTransaction11111111111111111"),r=[],i=new se.Transaction;i.feePayer=o;for(let c of t)la([...i.instructions,c],[o])>se.PACKET_DATA_SIZE&&(r.push(i),i=new se.Transaction,i.feePayer=o),i.add(c);i.instructions.length>0&&r.push(i);let a=[];try{a=await Promise.all(r.map(c=>n.simulateTransaction(c)))}catch(c){c instanceof Error&&Me.logWithError(`failed to simulate for instructions, RPC_ERROR, ${c.message}`)}let u=[];for(let c of a){let{value:m}=c;if(Me.debug(`simulate result: ${JSON.stringify(c)}`),m.logs){let d=m.logs.filter(p=>p&&p.includes(e));Me.debug(`filteredLog: ${JSON.stringify(u)}`),d.length||Me.logWithError(` "simulate log not match keyword, keyword: ${e}`),u.push(...d)}}return u}function Nr(n,t){let e=n.match(/{["\w:,]+}/g);return!e||e.length!==1?Me.logWithError(`simulate log fail to match json, keyword: ${t}`):e[0]}function Ae(n,t){let o=new RegExp(`"${t}":(\\d+)`,"g").exec(n);return!o||o.length!==2?Me.logWithError(`simulate log fail to match key", key: ${t}`):o[1]}async function Ie(n,t){let[e,o]=await se.PublicKey.findProgramAddress(n,t);return{publicKey:e,nonce:o}}var fe=class{constructor(t){this._owner=t}get publicKey(){return fe.isKeyPair(this._owner)?this._owner.publicKey:this._owner}get signer(){return fe.isKeyPair(this._owner)?this._owner:void 0}get isKeyPair(){return fe.isKeyPair(this._owner)}get isPublicKey(){return fe.isPublicKey(this._owner)}static isKeyPair(t){return t.secretKey!==void 0}static isPublicKey(t){return!fe.isKeyPair(t)}};function vr(n,t=1,e=[]){let o=[...n];if(t<=0)return e;for(;o.length;)e.push(o.splice(0,t));return e}var Dr=require("@solana/web3.js");var _n=M("Raydium_accountInfo_util");async function da(n,t,e){let{batchRequest:o,commitment:r}=L({batchRequest:!1},e),i=vr(t,100),a=new Array(i.length).fill([]);if(o){let u=i.map(m=>{let d=n._buildArgs([m.map(p=>p.toBase58())],r,"base64");return{methodName:"getMultipleAccounts",args:d}});a=(await n._rpcBatchRequest(u)).map(m=>(m.error&&_n.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${m.error.message}`),m.result.value.map(d=>{if(d){let{data:p,executable:y,lamports:f,owner:b,rentEpoch:w}=d;return p.length!==2&&p[1]!=="base64"&&_n.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(p[0],"base64"),executable:y,lamports:f,owner:new Dr.PublicKey(b),rentEpoch:w}}return null})))}else try{a=await Promise.all(i.map(u=>n.getMultipleAccountsInfo(u,r)))}catch(u){u instanceof Error&&_n.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${u.message}`)}return a.flat()}async function Er(n,t,e){let o=await da(n,t.map(r=>r.pubkey),e);return t.map((r,i)=>K(L({},r),{accountInfo:o[i]}))}function me(n){if(n instanceof re)return new A(n.numerator,n.denominator);if(n instanceof Z)return n.adjusted;if(n instanceof O)try{return me(n.toExact())}catch{return new A(ue)}if(n instanceof A)return n;let t=String(n),e=ce(t);return new A(e.numerator,e.denominator)}function pa(n,t){if(n==null||t==null)return!1;let e=me(n),o=me(t);return e.sub(o).numerator.gt(ue)}function Vr(n,t){if(n==null||t==null)return!1;let e=me(n),o=me(t);return e.sub(o).numerator.gte(ue)}function fa(n,t){if(n==null||t==null)return!1;let e=me(n),o=me(t);return e.sub(o).numerator.eq(ue)}function Rn(n,t){if(n==null||t==null)return;let e=me(n),o=me(t);try{return e.div(o)}catch{return e}}function Cr(n,t){if(n==null||t==null)return;let e=me(n),o=me(t);return e.sub(o)}function Ut(n){return n==null?!1:!fa(n,0)}function Wr(n,t){return pa(t,n)?t:n}var Ur=n=>typeof n=="number",Gr=n=>n?new Date(n):new Date,ya=n=>Gr(n).getTime();function ft(n,t,e){let o=Ur(t)?t*((e==null?void 0:e.unit)==="s"?1e3:1):t;return new Date(n).getTime()<=o}function je(n,t,e){let o=Ur(t)?t*((e==null?void 0:e.unit)==="s"?1e3:1):t;return new Date(n).getTime()>o}function Mn(n,t){let o=ya(n)+(t.days?t.days*24*60*60*1e3:0)+(t.hours?t.hours*60*60*1e3:0)+(t.minutes?t.minutes*60*1e3:0)+(t.seconds?t.seconds*1e3:0)+(t.milliseconds?t.milliseconds:0);return Gr(o)}var Gt=M("Raydium_Api");var Jt=class{constructor({cluster:t,timeout:e}){this.cluster=t,this.api=Jr.default.create({baseURL:"https://api.raydium.io/v2",timeout:e}),this.api.interceptors.request.use(o=>{let{method:r,baseURL:i,url:a}=o;return Gt.debug(`${r==null?void 0:r.toUpperCase()} ${i}${a}`),o},o=>(Gt.error("Request failed"),Promise.reject(o))),this.api.interceptors.response.use(o=>{let{config:r,data:i,status:a}=o,{method:u,baseURL:c,url:m}=r;return Gt.debug(`${u==null?void 0:u.toUpperCase()} ${c}${m}  ${a}`),i},o=>{let{config:r,response:i={}}=o,{status:a}=i,{method:u,baseURL:c,url:m}=r;return Gt.error(`${u.toUpperCase()} ${c}${m} ${a||o.message}`),Promise.reject(o)})}async getTokens(){return this.api.get("/sdk/token/raydium.mainnet.json")}async getLiquidityPools(){return this.api.get(`/sdk/liquidity/${this.cluster}.json`)}async getPairsInfo(){return this.api.get("https://api.raydium.io/v2/main/pairs")}async getFarmPools(){return this.api.get(`/sdk/farm-v2/${this.cluster}.json`)}async getCoingeckoPrice(t){return this.api.get(`https://api.coingecko.com/api/v3/simple/price?ids=${t.join(",")}&vs_currencies=usd`)}async getRaydiumTokenPrice(){return this.api.get("https://api.raydium.io/v2/main/price")}async getBlockSlotCountForSecond(t){if(!t)return 2;let o=(await this.api.post(t,{id:"getRecentPerformanceSamples",jsonrpc:"2.0",method:"getRecentPerformanceSamples",params:[4]})).result.map(r=>r.numSlots);return o.reduce((r,i)=>r+i,0)/o.length/60}};var $t="please provide owner in load() initialization or you can set by calling raydium.setOwner(owner)",$r="please provide connection in load() initialization or set it by raydium.setConnection(connection)";var Oe=require("@solana/spl-token"),ei=require("@solana/web3.js");var Bn=(...n)=>n.map(t=>{try{return typeof t=="object"?JSON.stringify(t):t}catch{return t}}).join(", "),ie=class{constructor({scope:t,moduleName:e}){this.disabled=!1;this.scope=t,this.logger=M(e)}createTxBuilder(t){return this.scope.checkOwner(),new Wt({connection:this.scope.connection,feePayer:t||this.scope.ownerPubKey,owner:this.scope.owner,signAllTransactions:this.scope.signAllTransactions})}logDebug(...t){this.logger.debug(Bn(t))}logInfo(...t){this.logger.info(Bn(t))}logAndCreateError(...t){let e=Bn(t);throw new Error(e)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};var Be=require("@solana/spl-token"),Qe=require("@solana/web3.js"),Hr=H(require("bn.js"));var Qr=require("@solana/web3.js"),Ye=H(require("bn.js"));var x=require("@solana/buffer-layout"),Kn=x.Layout,jr=x.Structure;var On=x.UInt;var Yr=x.seq;var yt=x.blob;var jt=class extends Kn{constructor(e,o,r){super(e,r);this.blob=yt(e),this.signed=o}decode(e,o=0){let r=new Ye.default(this.blob.decode(e,o),10,"le");return this.signed?r.fromTwos(this.span*8).clone():r}encode(e,o,r=0){return typeof e=="number"&&(e=new Ye.default(e)),this.signed&&(e=e.toTwos(this.span*8)),this.blob.encode(e.toArrayLike(Buffer,"le",this.span),o,r)}};function D(n){return new On(1,n)}function Ee(n){return new On(4,n)}function l(n){return new jt(8,!1,n)}function z(n){return new jt(16,!1,n)}var qn=class extends Kn{constructor(e,o,r,i){super(e.span,i);this.layout=e,this.decoder=o,this.encoder=r}decode(e,o){return this.decoder(this.layout.decode(e,o))}encode(e,o,r){return this.layout.encode(this.encoder(e),o,r)}getSpan(e,o){return this.layout.getSpan(e,o)}};function h(n){return new qn(yt(32),t=>new Qr.PublicKey(t),t=>t.toBuffer(),n)}var Fn=class extends jr{decode(t,e){return super.decode(t,e)}};function R(n,t,e){return new Fn(n,t,e)}function ee(n,t,e){let o,r=typeof t=="number"?t:(0,Ye.isBN)(t)?t.toNumber():new Proxy(t,{get(i,a){if(!o){let u=Reflect.get(i,"count");o=(0,Ye.isBN)(u)?u.toNumber():u,Reflect.set(i,"count",o)}return Reflect.get(i,a)},set(i,a,u){return a==="count"&&(o=u),Reflect.set(i,a,u)}});return Yr(n,r,e)}var ge=R([h("mint"),h("owner"),l("amount"),Ee("delegateOption"),h("delegate"),D("state"),Ee("isNativeOption"),l("isNative"),l("delegatedAmount"),Ee("closeAuthorityOption"),h("closeAuthority")]);function zr(n){let{mint:t,tokenAccount:e,owner:o}=n;return(0,Be.createInitializeAccountInstruction)(e,t,o)}function Ke(n){let{tokenAccount:t,payer:e,multiSigners:o=[],owner:r}=n;return(0,Be.createCloseAccountInstruction)(t,e,r,o)}async function xe(n){let{connection:t,amount:e,commitment:o,payer:r,owner:i,skipCloseAccount:a}=n,u=await t.getMinimumBalanceForRentExemption(ge.span,o),c=I(e).add(new Hr.default(u)),m=Qe.Keypair.generate();return{signers:[m],instructions:[Qe.SystemProgram.createAccount({fromPubkey:r,newAccountPubkey:m.publicKey,lamports:c.toNumber(),space:ge.span,programId:Be.TOKEN_PROGRAM_ID}),zr({mint:new Qe.PublicKey($.mint),tokenAccount:m.publicKey,owner:i})],endInstructions:a?[]:[Ke({tokenAccount:m.publicKey,payer:r,owner:i})]}}function Ve({source:n,destination:t,owner:e,amount:o,multiSigners:r=[]}){return(0,Be.createTransferInstruction)(n,t,e,I(o).toNumber(),r)}var Zr=require("@solana/web3.js"),Xr=H(require("bn.js"));var ba=M("Raydium_Util");function Nn({solAccountResp:n,tokenAccountResp:t}){let e=[],o=[];for(let{pubkey:r,account:i}of t.value){if(i.data.length!==ge.span)throw ba.error("invalid token account layout length","publicKey",r.toBase58()),new Error("invalid token account layout length");let a=ge.decode(i.data),{mint:u,amount:c}=a;e.push({publicKey:r,mint:u,amount:c,isNative:!1}),o.push({pubkey:r,accountInfo:a})}return n&&e.push({mint:Zr.PublicKey.default,amount:new Xr.default(n.lamports),isNative:!0}),{tokenAccounts:e,tokenAccountRawInfos:o}}var bt=class extends ie{constructor(e){super(e);this._tokenAccounts=[];this._tokenAccountRawInfos=[];this._ataCache=new Map;this._accountListener=[];this._clientOwnedToken=!1;let{tokenAccounts:o,tokenAccountRawInfos:r}=e;this._tokenAccounts=o||[],this._tokenAccountRawInfos=r||[],this._clientOwnedToken=!!(o||r)}get tokenAccounts(){return this._tokenAccounts}get tokenAccountRawInfos(){return this._tokenAccountRawInfos}updateTokenAccount({tokenAccounts:e,tokenAccountRawInfos:o}){return e&&(this._tokenAccounts=e),o&&(this._tokenAccountRawInfos=o),this._accountChangeListenerId&&this.scope.connection.removeAccountChangeListener(this._accountChangeListenerId),this._accountChangeListenerId=void 0,this._clientOwnedToken=!0,this}addAccountChangeListener(e){return this._accountListener.push(e),this}removeAccountChangeListener(e){return this._accountListener=this._accountListener.filter(o=>o!==e),this}async getAssociatedTokenAccount(e){this.scope.checkOwner();let o=`${this.scope.ownerPubKey.toBase58()}_${e.toBase58()}`;if(this._ataCache.has(o))return this._ataCache.get(o);let r=await(0,Oe.getAssociatedTokenAddress)(e,this.scope.ownerPubKey,!0);return this._ataCache.set(o,r),r}async fetchWalletTokenAccounts(e){if(this._clientOwnedToken||!(e!=null&&e.forceUpdate)&&this._tokenAccounts.length)return{tokenAccounts:this._tokenAccounts,tokenAccountRawInfos:this._tokenAccountRawInfos};this.scope.checkOwner();let r=L(L({},{}),e),i=await this.scope.connection.getAccountInfo(this.scope.ownerPubKey,r.commitment),a=await this.scope.connection.getTokenAccountsByOwner(this.scope.ownerPubKey,{programId:Oe.TOKEN_PROGRAM_ID},r.commitment),{tokenAccounts:u,tokenAccountRawInfos:c}=Nn({solAccountResp:i,tokenAccountResp:a});return this._tokenAccounts=u,this._tokenAccountRawInfos=c,this._accountChangeListenerId&&this.scope.connection.removeAccountChangeListener(this._accountChangeListenerId),this._accountChangeListenerId=this.scope.connection.onAccountChange(this.scope.ownerPubKey,()=>this.fetchWalletTokenAccounts({forceUpdate:!0}),"confirmed"),{tokenAccounts:u,tokenAccountRawInfos:c}}async getCreatedTokenAccount({mint:e,associatedOnly:o=!0}){await this.fetchWalletTokenAccounts();let r=this._tokenAccounts.filter(({mint:a})=>a==null?void 0:a.equals(e)).sort((a,u)=>a.amount.lt(u.amount)?1:-1),i=await this.getAssociatedTokenAccount(e);for(let a of r){let{publicKey:u}=a;if(u)return o&&i.equals(u),u}}async checkOrCreateAta({mint:e,autoUnwrapWSOLToSOL:o}){var u;await this.fetchWalletTokenAccounts();let r=(u=this.scope.account.tokenAccounts.find(({mint:c})=>(c==null?void 0:c.toBase58())===e.toBase58()))==null?void 0:u.publicKey,i=this.scope.ownerPubKey,a={};if(!r){let c=await this.getAssociatedTokenAccount(e),m=await(0,Oe.createAssociatedTokenAccountInstruction)(i,c,i,e);a.instructions=[m],r=c}return o&&$.mint===e.toBase58()&&(a.endInstructions=[Ke({owner:i,payer:i,tokenAccount:r})]),{pubKey:r,newInstructions:a}}async handleTokenAccount(e){let{side:o,amount:r,mint:i,tokenAccount:a,payer:u=this.scope.ownerPubKey,bypassAssociatedCheck:c,skipCloseAccount:m}=e,d=this.createTxBuilder(),p=await(0,Oe.getAssociatedTokenAddress)(i,this.scope.ownerPubKey,!0);if(new ei.PublicKey($.mint).equals(i)){let y=await xe({connection:this.scope.connection,owner:this.scope.ownerPubKey,payer:u,amount:r,skipCloseAccount:m});return d.addInstruction(y),L({tokenAccount:y.signers[0].publicKey},y)}else if(!a||o==="out"&&!p.equals(a)&&!c)return{tokenAccount:p,instructions:[(0,Oe.createAssociatedTokenAccountInstruction)(this.scope.ownerPubKey,p,this.scope.ownerPubKey,i)]};return{tokenAccount:a}}};var qe=require("@solana/spl-token"),q=require("@solana/web3.js"),nn=H(require("bn.js"));var Ze=require("@solana/web3.js");var Yt=R([D("instruction")]),Qt=R([D("instruction")]),ga=R([l("rewardState"),l("rewardOpenTime"),l("rewardEndTime"),l("rewardLastUpdateTime"),l("totalReward"),l("totalRewardEmissioned"),l("rewardClaimed"),l("rewardPerSecond"),z("accRewardPerShare"),h("rewardVault"),h("rewardMint"),h("rewardSender"),l("rewardType"),ee(l(),15,"padding")]),ti=R([l("state"),l("nonce"),h("lpVault"),h("rewardVault"),h(),h(),l(),l(),l("totalReward"),z("perShareReward"),l("lastSlot"),l("perSlotReward")]),ni=R([l("state"),l("nonce"),h("lpVault"),h("rewardVaultA"),l("totalRewardA"),z("perShareRewardA"),l("perSlotRewardA"),D("option"),h("rewardVaultB"),yt(7),l("totalRewardB"),z("perShareRewardB"),l("perSlotRewardB"),l("lastSlot"),h()]),oi=R([l(),l("state"),l("nonce"),l("validRewardTokenNum"),z("rewardMultiplier"),l("rewardPeriodMax"),l("rewardPeriodMin"),l("rewardPeriodExtend"),h("lpMint"),h("lpVault"),ee(ga,5,"rewardInfos"),h("creator"),h(),ee(l(),32,"padding")]),vn=new Proxy(ti,{get(n,t,e){return t==="decode"?(...o)=>{let r=n.decode(...o);return K(L({},r),{version:3,rewardInfos:[{rewardVault:r.rewardVault,totalReward:r.totalReward,perSlotReward:r.perSlotReward,perShareReward:r.perShareReward}]})}:Reflect.get(n,t,e)}}),Dn=new Proxy(ni,{get(n,t,e){return t==="decode"?(...o)=>{let r=n.decode(...o);return K(L({},r),{version:5,rewardInfos:[{rewardVault:r.rewardVaultA,totalReward:r.totalRewardA,perSlotReward:r.perSlotRewardA,perShareReward:r.perShareRewardA},{rewardVault:r.rewardVaultB,totalReward:r.totalRewardB,perSlotReward:r.perSlotRewardB,perShareReward:r.perShareRewardB}]})}:Reflect.get(n,t,e)}}),He=new Proxy(oi,{get(n,t,e){return t==="decode"?(...o)=>{let r=n.decode(...o);return K(L({},r),{version:6,rewardInfos:r.rewardInfos.map(i=>{var a;return K(L({},i),{rewardType:((a=Object.entries(gt).find(u=>String(u[1])===i.rewardType.toString()))!=null?a:["Standard SPL"])[0]})})})}:Reflect.get(n,t,e)}}),ri=R([l("isSet"),l("rewardPerSecond"),l("rewardOpenTime"),l("rewardEndTime"),l("rewardType")]),Ht=R([D("instruction"),l("nonce"),ee(ri,5,"rewardTimeInfo")]),zt=R([D("instruction"),l("rewardReopenTime"),l("rewardEndTime"),l("rewardPerSecond")]),Zt=R([D("instruction"),l("isSet"),l("rewardPerSecond"),l("rewardOpenTime"),l("rewardEndTime")]),Pa=R([l("state"),h("id"),h("owner"),l("deposited"),ee(l(),1,"rewardDebts")]),En=R([l("state"),h("id"),h("owner"),l("deposited"),ee(z(),1,"rewardDebts"),ee(l(),17)]),wa=R([l("state"),h("id"),h("owner"),l("deposited"),ee(l(),2,"rewardDebts")]),Vn=R([l("state"),h("id"),h("owner"),l("deposited"),ee(z(),2,"rewardDebts"),ee(l(),17)]),Cn=R([l(),l("state"),h("id"),h("owner"),l("deposited"),ee(z(),5,"rewardDebts"),ee(l(),16)]),ze=R([D("instruction"),l("amount")]);var ii=M("Raydium_farm_config"),Wn="EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q",ai=new Ze.PublicKey(Wn),Un="9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z",si=new Ze.PublicKey(Un),Gn="FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG",ui=new Ze.PublicKey(Gn),Jn={[Wn]:3,[Un]:5,[Gn]:6},$n={3:ai,5:si,6:ui},jn=new Ze.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),Yn=new Ze.PublicKey("FrspKwj8i3pNmKwXreTveC4fu7KL5ZbGeXdZBe2XViu1"),Qn={3:vn,5:Dn,6:He},Hn={3:En,5:Vn,6:Cn},Xt=n=>[3,5,6].indexOf(n)!==-1,ha={3:10,5:11,6:1},zn=n=>{let t=ha[n];return t||ii.logWithError("invalid deposit farm version"),t},ka={3:11,5:12,6:2},Zn=n=>{let t=ka[n];return t||ii.logWithError("invalid withdraw farm version"),t},Xn=n=>{var a;let{version:t,rewardInfos:e,rewardTokenAccountsPublicKeys:o}=n,r=`rewardInfo:${JSON.stringify(e)}, rewardAccount:${JSON.stringify(o)}`,i={3:()=>{if(e.length!==1||o.length!==1)return`rewardInfos or rewardTokenAccounts lengths not equal 1: ${r}`},5:()=>{if(e.length!==o.length)return`rewardInfos and rewardTokenAccounts lengths not equal: ${r}`},6:()=>{if(!o.length||e.length!==o.length)return`no rewardTokenAccounts or rewardInfos and rewardTokenAccounts lengths not equal: ${r}`}};return(a=i[t])==null?void 0:a.call(i)},gt={"Standard SPL":0,"Option tokens":1};var Ce=require("@solana/web3.js"),ci=H(require("bn.js"));var Ta=M("Raydium_farm_instruction");async function eo(n){let{version:t,id:e,ledger:o,programId:r,owner:i}=n,a={3:9,5:10}[t];a||Ta.logWithError(`invalid farm pool version: ${t}`);let u=Buffer.alloc(Yt.span);Yt.encode({instruction:a},u);let c=[s({pubkey:e}),s({pubkey:o}),s({pubkey:i,isWritable:!1}),s({pubkey:Ce.SystemProgram.programId,isWritable:!1}),s({pubkey:Ce.SYSVAR_RENT_PUBKEY,isWritable:!1})];return new Ce.TransactionInstruction({programId:r,keys:c,data:u})}function to(n){var o;let t=Buffer.alloc(Ht.span);Ht.encode({instruction:0,nonce:new ci.default(n.nonce),rewardTimeInfo:n.rewardInfoConfig},t);let e=[...De,s({pubkey:n.farmKeyPair.publicKey}),s({pubkey:n.farmAuthority,isWritable:!1}),s({pubkey:n.lpVault}),s({pubkey:n.lpMint,isWritable:!1}),s({pubkey:n.lockVault}),s({pubkey:n.lockMint,isWritable:!1}),s({pubkey:(o=n.lockUserAccount)!=null?o:U}),s({pubkey:n.owner,isWritable:!1,isSigner:!0})];for(let r of n.rewardInfo)e.push(s({pubkey:r.rewardMint,isWritable:!1}),s({pubkey:r.rewardVault}),s({pubkey:r.userRewardToken}));return new Ce.TransactionInstruction({programId:n.programId,keys:e,data:t})}var X=H(require("bn.js"));var Pt=M("Raydium.farm.util");async function wt({programId:n,poolId:t,mint:e,type:o}){let{publicKey:r}=await Ie([t.toBuffer(),e.toBuffer(),Buffer.from(o==="lpVault"?"lp_vault_associated_seed":o==="rewardVault"?"reward_vault_associated_seed":"","utf-8")],n);return r}function mi(n){let e=C({publicKey:n}).toBase58();return Jn[e]}async function en({programId:n,poolId:t,owner:e}){let{publicKey:o}=await Ie([t.toBuffer(),e.toBuffer(),Buffer.from(mi(n)===6?"farmer_info_associated_seed":"staker_info_v2_associated_seed","utf-8")],n);return o}var no=async({programId:n,poolId:t})=>await Ie([t.toBuffer()],n);function oo(n){return $n[n]}function ro(n){return{isSet:new X.default(1),rewardPerSecond:I(n.rewardPerSecond),rewardOpenTime:I(n.rewardOpenTime),rewardEndTime:I(n.rewardEndTime),rewardType:I(n.rewardType)}}function tn(n){return I(n.rewardEndTime).sub(I(n.rewardOpenTime)).mul(I(n.rewardPerSecond))}function li(n){let t=Hn[n];return t||Pt.logWithError("invalid version",n),t}function di(n){let t=Qn[n];return t||Pt.logWithError("invalid version",n),t}function pi(n,t,e,o){if(n.version===3||n.version===5){if(n.lastSlot.gte(new X.default(e)))return n;let r=new X.default(e).sub(n.lastSlot);n.lastSlot=new X.default(e);for(let i of n.rewardInfos){if(t.amount.eq(new X.default(0)))continue;let a=i.perSlotReward.mul(r);i.perShareReward=i.perShareReward.add(a.mul(new X.default(10).pow(new X.default(n.version===3?9:15))).div(t.amount)),i.totalReward=i.totalReward.add(a)}}else if(n.version===6)for(let r of n.rewardInfos){if(r.rewardState.eq(new X.default(0)))continue;let i=X.default.min(new X.default(o),r.rewardEndTime);if(r.rewardOpenTime.gte(i))continue;let u=i.sub(r.rewardLastUpdateTime).mul(r.rewardPerSecond),c=r.totalReward.sub(r.totalRewardEmissioned);c.lt(u)?(u=c,r.rewardLastUpdateTime=r.rewardLastUpdateTime.add(c.div(r.rewardPerSecond))):r.rewardLastUpdateTime=i,!t.amount.eq(new X.default(0))&&(r.accRewardPerShare=r.accRewardPerShare.add(u.mul(n.rewardMultiplier).div(t.amount)),r.totalRewardEmissioned=r.totalRewardEmissioned.add(u))}return n}async function fi({connection:n,farmPools:t,owner:e,config:o}){var y;let r=!1,i=!1,a=new X.default(10),u=[];for(let f of t){let b=pe(f);b.version===6?i=!0:r=!0,u.push({pubkey:b.id,version:b.version,key:"state",poolId:b.id},{pubkey:b.lpVault,version:b.version,key:"lpVault",poolId:b.id}),e&&u.push({pubkey:await en({programId:b.programId,poolId:b.id,owner:e}),version:b.version,key:"ledger",poolId:b.id})}let c={},m=await Er(n,u,o);for(let{pubkey:f,version:b,key:w,poolId:S,accountInfo:g}of m){let k=S.toBase58();if(c[k]=L({},c[k]),w==="state"){let _=di(b);(!g||!g.data||g.data.length!==_.span)&&Pt.logWithError(`invalid farm state account info, pools.id, ${f}`),c[k].state=_.decode(g.data)}else if(w==="lpVault")(!g||!g.data||g.data.length!==ge.span)&&Pt.logWithError(`invalid farm lp vault account info, pools.lpVault, ${f}`),c[k].lpVault=ge.decode(g.data);else if(w==="ledger"){let _=li(b);g&&g.data&&(g.data.length!==_.span&&Pt.logWithError(`invalid farm ledger account info, ledger, ${f}`),c[k].ledger=_.decode(g.data))}}let d=i||r?await n.getSlot():0,p=i&&(y=await n.getBlockTime(d))!=null?y:0;for(let f of Object.keys(c))c[f].state=pi(c[f].state,c[f].lpVault,d,p);for(let[f,{state:b,ledger:w}]of Object.entries(c))if(w){let S=b.version===6?b.rewardMultiplier:b.rewardInfos.length===1?a.pow(new X.default(9)):a.pow(new X.default(15)),g=b.rewardInfos.map((k,_)=>{let T=w.rewardDebts[_];return w.deposited.mul(b.version===6?k.accRewardPerShare:k.perShareReward).div(S).sub(T)});c[f].wrapped=K(L({},c[f].wrapped),{pendingRewards:g})}return c}async function io(n){let{farmPools:t}=n,e=await fi(n);return t.map((r,i)=>K(L(L(L({},t[i]),pe(r)),e[r.id]),{jsonInfo:t[i]}))}function ao(n,t=Date.now()){if(n.version===6){let e=n.state.rewardInfos;if(e.every(({rewardOpenTime:o})=>ft(t,o.toNumber(),{unit:"s"})))return"upcoming pool";if(e.every(({rewardEndTime:o})=>je(t,o.toNumber(),{unit:"s"})))return"closed pool"}else{let e=n.state.rewardInfos.map(({perSlotReward:o})=>o);if(e.length===2){if(String(e[0])==="0"&&String(e[1])!=="0")return"normal fusion pool";if(String(e[0])!=="0"&&String(e[1])!=="0")return"dual fusion pool";if(String(e[0])==="0"&&String(e[1])==="0")return"closed pool"}else if(e.length===1&&String(e[0])==="0")return"closed pool"}}function so(n){return n.state.rewardInfos.length===1&&String(n.lpMint)===Vt.toBase58()}function uo(n,t){return n.version===6?n.state.rewardInfos.map(({rewardPerSecond:e,rewardOpenTime:o,rewardEndTime:r},i)=>{var y;let a=ft(t.currentBlockChainDate,o.toNumber(),{unit:"s"}),u=je(t.currentBlockChainDate,r.toNumber(),{unit:"s"});if(a||u)return;let c=t.rewardTokens[i];if(!c)return;let m=t.rewardTokenPrices[i];if(!m)return;let d=ct(new A(e,be).div(Te.pow(new X.default(c.decimals||1))).mul(new X.default(60*60*24*365)),m);return t.tvl?t.tvl.isZero()?ve(0):d.div((y=t.tvl)!=null?y:be):void 0}):n.state.rewardInfos.map(({perSlotReward:o},r)=>{var m;let i=t.rewardTokens[r];if(!i)return;let a=t.rewardTokenPrices[r];if(!a)return;let u=ct(new A(o,be).div(Te.pow(new X.default(i.decimals||1))).mul(new X.default(t.blockSlotCountForSecond*60*60*24*365)),a);return t.tvl?t.tvl.isZero()?ve(0):u.div((m=t.tvl)!=null?m:be):void 0})}var ht=class extends ie{constructor(){super(...arguments);this._farmPools=[];this._hydratedFarmPools=[];this._hydratedFarmMap=new Map;this._sdkParsedFarmPools=[];this._lpTokenInfoMap=new Map}async load(e){var r;await this.scope.liquidity.load(e),await this.scope.fetchFarms(e==null?void 0:e.forceUpdate);let o=((r=this.scope.apiData.farmPools)==null?void 0:r.data)||{};this._farmPools=Object.keys(o||{}).reduce((i,a)=>{var u,c;return i.concat(((c=(u=o[a]).map)==null?void 0:c.call(u,m=>{let d=this.scope.token.allTokenMap.get(m.baseMint),p=this.scope.token.allTokenMap.get(m.quoteMint);return d&&p&&this._lpTokenInfoMap.set(m.lpMint,new J({mint:m.lpMint,decimals:d.decimals,symbol:`${d.symbol} - ${p.name}`,name:`${d.symbol} - ${p.name} LP`})),K(L({},m),{name:m.symbol,category:a})}))||[])},[]),await this.fetchSdkFarmInfo()}async fetchSdkFarmInfo(){var e;this._sdkParsedFarmPools=await io({connection:this.scope.connection,farmPools:this._farmPools,owner:(e=this.scope.owner)==null?void 0:e.publicKey,config:{commitment:"confirmed"}})}async loadHydratedFarmInfo(e){let{forceUpdate:o,skipPrice:r}=e||{};if(this._hydratedFarmPools.length&&!o)return this._hydratedFarmPools;await this.scope.farm.load(),!r&&await this.scope.token.fetchTokenPrices(),await this.scope.liquidity.loadPairs();let i=await this.scope.chainTimeOffset(),a=Mn(Date.now()+i,{minutes:0}),u=await this.scope.api.getBlockSlotCountForSecond(this.scope.connection.rpcEndpoint),c=Object.fromEntries(this.scope.liquidity.allPairs.map(m=>[m.ammId,{apr30d:m.apr30d,apr7d:m.apr7d,apr24h:m.apr24h}]));return this._hydratedFarmPools=this._sdkParsedFarmPools.map(m=>{let d=this.hydrateFarmInfo({farmInfo:m,blockSlotCountForSecond:u,farmAprs:c,currentBlockChainDate:a,chainTimeOffset:i});return this._hydratedFarmMap.set(m.id.toBase58(),d),d}),this._hydratedFarmPools}get allFarms(){return this._farmPools}get allParsedFarms(){return this._sdkParsedFarmPools}get allHydratedFarms(){return this._hydratedFarmPools}get allHydratedFarmMap(){return this._hydratedFarmMap}getFarm(e){let o=C({publicKey:e}),r=this.allFarms.find(i=>i.id===o.toBase58());return r||this.logAndCreateError("invalid farm id"),r}getParsedFarm(e){let o=C({publicKey:e}),r=this.allParsedFarms.find(i=>o.equals(i.id));return r||this.logAndCreateError("invalid farm id"),r}getLpTokenInfo(e){let o=C({publicKey:e}),r=this._lpTokenInfoMap.get(o.toBase58());return r||this.logAndCreateError("LP Token not found",o.toBase58()),r}lpDecimalAmount({mint:e,amount:o}){let r=ce(o),i=this.getLpTokenInfo(e);return _e(new A(r.numerator,r.denominator).mul(new nn.default(10).pow(new nn.default(i.decimals))))}hydrateFarmInfo(e){var Bt,Kt,nt,ot,rt,Ot,Yo,Qo,Ho,zo,Zo,Xo;let{farmInfo:o,blockSlotCountForSecond:r,farmAprs:i,currentBlockChainDate:a,chainTimeOffset:u=0}=e,c=ao(o,a),m=so(o),d=c==="dual fusion pool",p=c==="normal fusion pool",y=c==="closed pool"&&!o.upcoming,f=o.version!==6?o.upcoming&&y:o.upcoming,b=o.version!==6&&o.upcoming&&!y,w=((Bt=this.scope.liquidity.allPools.find(B=>B.lpMint===o.lpMint.toBase58()))==null?void 0:Bt.version)===5,S=m?this.scope.mintToToken(o.lpMint):this.getLpTokenInfo(o.lpMint),g=this.scope.mintToToken(m?o.lpMint:o.baseMint),k=this.scope.mintToToken(m?o.lpMint:o.quoteMint);g!=null&&g.symbol;let _=m?`${(Kt=g==null?void 0:g.symbol)!=null?Kt:"unknown"}`:`${(nt=g==null?void 0:g.symbol)!=null?nt:"unknown"}-${(ot=k==null?void 0:k.symbol)!=null?ot:"unknown"}`,T=o.jsonInfo.rewardInfos.map(({rewardMint:B})=>this.scope.mintToToken(B)),F=(rt=o.wrapped)==null?void 0:rt.pendingRewards.map((B,W)=>T[W]?new O(T[W],_e(Wr(B,0))):void 0),N=m?this.scope.token.tokenPrices.get(o.lpMint.toBase58()):this.scope.liquidity.lpPriceMap.get(o.lpMint.toBase58()),v=S&&new O(S,o.lpVault.amount),Y=N&&S?ct(new O(S,o.lpVault.amount),N):void 0,E=uo(o,{tvl:Y,currentBlockChainDate:a,rewardTokens:T,rewardTokenPrices:(Ot=o.rewardInfos.map(({rewardMint:B})=>this.scope.token.tokenPrices.get(B.toBase58())))!=null?Ot:[],blockSlotCountForSecond:r}),G=(Yo=this.scope.liquidity.allPools.find(B=>B.lpMint===o.lpMint.toBase58()))==null?void 0:Yo.id,te=G?Dt((Qo=i[G])==null?void 0:Qo.apr7d,{alreadyDecimaled:!0}):void 0,Q=G?Dt((Ho=i[G])==null?void 0:Ho.apr30d,{alreadyDecimaled:!0}):void 0,oe=G?Dt((zo=i[G])==null?void 0:zo.apr24h,{alreadyDecimaled:!0}):void 0,ae=E.reduce((B,W)=>B?W?B.add(W):B:W,te),Le=E.reduce((B,W)=>B?W?B.add(W):B:W,Q),de=E.reduce((B,W)=>B?W?B.add(W):B:W,oe),he=o.version===6?o.state.rewardInfos.map((B,W)=>{var or,rr,ir,ar;let{rewardOpenTime:it,rewardEndTime:qt,rewardPerSecond:Pn}=B,Ne=it.toNumber()?new Date(it.toNumber()*1e3+u):void 0,ke=qt.toNumber()?new Date(qt.toNumber()*1e3+u):void 0,wn=Date.now()+u;if(!Ne&&!ke)return;let Je=this.scope.mintToToken((ir=(rr=B.rewardMint)!=null?rr:(or=o.rewardInfos[W])==null?void 0:or.rewardMint)==null?void 0:ir.toBase58()),er=Boolean(Ne&&ft(wn,Ne)),tr=Boolean(ke&&je(wn,ke)),nr=!Ne&&!ke||!tr&&!er,Ei=nr&&je(wn,Mn(ke,{seconds:-((ar=o.jsonInfo.rewardPeriodExtend)!=null?ar:72*60*60)})),Vi=Je&&this.scope.mintToTokenAmount({mint:Je.mint,amount:Cr(B.totalReward,B.totalRewardEmissioned).toFixed(Je.decimals)}),Ci=F==null?void 0:F[W],Wi=E[W],Ui=Boolean(ke),Ft=o.rewardInfos[W];return K(L(L({},Ft),B),{owner:Ft==null?void 0:Ft.rewardSender,apr:Wi,token:Je,userPendingReward:Ci,userHavedReward:Ui,perSecond:Je&&this.scope.mintToTokenAmount({mint:Je.mint,amount:Pn}).toSignificant(),openTime:Ne,endTime:ke,isOptionToken:B.rewardType==="Option tokens",isRewardBeforeStart:er,isRewardEnded:tr,isRewarding:nr,isRwardingBeforeEnd72h:Ei,claimableRewards:Vi,version:6})}).filter(B=>!!B):o.state.rewardInfos.map((B,W)=>{let it=F==null?void 0:F[W],qt=E[W],Pn=T[W],{perSlotReward:Ne}=B,ke=Ut(it)||Ut(Ne);return K(L({},B),{apr:qt,token:Pn,userPendingReward:it,userHavedReward:ke,version:o.version})}),ye=S&&((Zo=o.ledger)==null?void 0:Zo.deposited)?new O(S,(Xo=o.ledger)==null?void 0:Xo.deposited):void 0;return K(L({},o),{lp:S,lpPrice:N,base:g,quote:k,name:_,isStakePool:m,isDualFusionPool:d,isNormalFusionPool:p,isClosedPool:y,isUpcomingPool:f,isStablePool:w,isNewPool:b,totalApr7d:ae,raydiumFeeApr7d:te,totalApr24h:de,raydiumFeeApr24h:oe,totalApr30d:Le,raydiumFeeApr30d:Q,ammId:G,tvl:Y,userHasStaked:Ut(ye),rewards:he,userStakedLpAmount:ye,stakedLpAmount:v})}async _getUserRewardInfo({payer:e,rewardInfo:o}){if(o.rewardMint.equals(U)){let r=await xe({connection:this.scope.connection,owner:this.scope.ownerPubKey,payer:e,amount:tn(o)});return{rewardPubKey:r.signers[0].publicKey,newInstruction:r}}return{rewardPubKey:await this.scope.account.getCreatedTokenAccount({mint:o.rewardMint})}}async create({poolId:e,rewardInfos:o,payer:r}){this.checkDisabled(),this.scope.checkOwner();let i=C({publicKey:e}),a=this.scope.liquidity.allPools.find(T=>T.id===i.toBase58());a||this.logAndCreateError("invalid pool id");let c={lpMint:new q.PublicKey(a.lpMint),lockInfo:{lockMint:jn,lockVault:Yn},version:6,rewardInfos:o,programId:oo(6)},m=this.createTxBuilder(),d=r!=null?r:this.scope.ownerPubKey,p=q.Keypair.generate(),y=await this.scope.connection.getMinimumBalanceForRentExemption(He.span);m.addInstruction({instructions:[q.SystemProgram.createAccount({fromPubkey:d,newAccountPubkey:p.publicKey,lamports:y,space:He.span,programId:c.programId})],signers:[p]});let{publicKey:f,nonce:b}=await no({programId:c.programId,poolId:p.publicKey}),w=await wt({programId:c.programId,poolId:p.publicKey,mint:c.lpMint,type:"lpVault"}),S=[],g=[];for(let T of c.rewardInfos){T.rewardOpenTime>=T.rewardEndTime&&this.logAndCreateError("start time error","rewardInfo.rewardOpenTime",T.rewardOpenTime.toString()),gt[T.rewardType]||this.logAndCreateError("rewardType error",T.rewardType),T.rewardPerSecond<=0&&this.logAndCreateError("rewardPerSecond error",T.rewardPerSecond.toString()),S.push(ro(T));let{rewardPubKey:F,newInstruction:N}=await this._getUserRewardInfo({rewardInfo:T,payer:d});N&&m.addInstruction(N),F||this.logAndCreateError("cannot found target token accounts",this.scope.account.tokenAccounts);let v=T.rewardMint.equals(U)?new q.PublicKey($.mint):T.rewardMint;g.push({rewardMint:v,rewardVault:await wt({programId:c.programId,poolId:p.publicKey,mint:v,type:"rewardVault"}),userRewardToken:F})}let k=await this.scope.account.getCreatedTokenAccount({mint:c.lockInfo.lockMint});k||this.logAndCreateError("cannot found lock vault","tokenAccounts",this.scope.account.tokenAccounts);let _=to({farmKeyPair:p,owner:this.scope.ownerPubKey,farmAuthority:f,lpVault:w,lpMint:c.lpMint,lockVault:c.lockInfo.lockVault,lockMint:c.lockInfo.lockMint,lockUserAccount:k,programId:c.programId,rewardInfo:g,rewardInfoConfig:S,nonce:b});return await m.addInstruction({instructions:[_]}).build()}async restartReward({farmId:e,payer:o,newRewardInfo:r}){let i=this.getFarm(e);i.version!==6&&this.logAndCreateError("invalid farm version",i.version);let a={id:new q.PublicKey(i.id),rewardInfos:i.rewardInfos,lpVault:new q.PublicKey(i.lpVault),programId:new q.PublicKey(i.programId)};r.rewardOpenTime>=r.rewardEndTime&&this.logAndCreateError("start time error","newRewardInfo",r);let u=o||this.scope.ownerPubKey,c=r.rewardMint.equals(U)?new q.PublicKey($.mint):r.rewardMint,m=a.rewardInfos.find(S=>new q.PublicKey(S.rewardMint).equals(c));m||this.logAndCreateError("configuration does not exist","rewardMint",c);let d=m.rewardVault?new q.PublicKey(m.rewardVault):U,p=this.createTxBuilder(),{rewardPubKey:y,newInstruction:f}=await this._getUserRewardInfo({rewardInfo:r,payer:u});f&&p.addInstruction(f),y||this.logAndCreateError("cannot found target token accounts",this.scope.account.tokenAccounts);let b=Buffer.alloc(zt.span);zt.encode({instruction:3,rewardReopenTime:I(r.rewardOpenTime),rewardEndTime:I(r.rewardEndTime),rewardPerSecond:I(r.rewardPerSecond)},b);let w=[s({pubkey:qe.TOKEN_PROGRAM_ID,isWritable:!1}),s({pubkey:a.id}),s({pubkey:a.lpVault,isWritable:!1}),s({pubkey:d}),s({pubkey:y}),s({pubkey:this.scope.ownerPubKey,isWritable:!1,isSigner:!0})];return await p.addInstruction({instructions:[new q.TransactionInstruction({programId:a.programId,keys:w,data:b})]}).build()}async addNewRewardToken(e){let{farmId:o,newRewardInfo:r,payer:i}=e,a=this.getFarm(o);a.version!==6&&this.logAndCreateError("invalid farm version",a.version);let u=i!=null?i:this.scope.ownerPubKey,c=this.createTxBuilder(),m=await wt({programId:new q.PublicKey(a.programId),poolId:new q.PublicKey(a.id),mint:r.rewardMint,type:"rewardVault"}),{rewardPubKey:d,newInstruction:p}=await this._getUserRewardInfo({rewardInfo:r,payer:u});p&&c.addInstruction(p),d||this.logAndCreateError("annot found target token accounts",this.scope.account.tokenAccounts);let y=r.rewardMint.equals(U)?new q.PublicKey($.mint):r.rewardMint,f=Buffer.alloc(Zt.span);Zt.encode({instruction:4,isSet:new nn.default(1),rewardPerSecond:I(r.rewardPerSecond),rewardOpenTime:I(r.rewardOpenTime),rewardEndTime:I(r.rewardEndTime)},f);let b=[...De,s({pubkey:new q.PublicKey(a.id)}),s({pubkey:new q.PublicKey(a.authority),isWritable:!1}),s({pubkey:y,isWritable:!1}),s({pubkey:m}),s({pubkey:d}),s({pubkey:this.scope.ownerPubKey,isWritable:!1,isSigner:!0})];return await c.addInstruction({instructions:[new q.TransactionInstruction({programId:new q.PublicKey(a.programId),keys:b,data:f})]}).build()}async _prepareFarmAccounts(e){let o=this.createTxBuilder(),{farmInfo:r}=e,{pubKey:i,newInstructions:a}=await this.scope.account.checkOrCreateAta({mint:r.lpMint});o.addInstruction(a);let u=await Promise.all(r.rewardInfos.map(async({rewardMint:d})=>{let{pubKey:p,newInstructions:y}=await this.scope.account.checkOrCreateAta({mint:d,autoUnwrapWSOLToSOL:!0});return o.addInstruction(y),p})),c=await en({programId:new q.PublicKey(r.programId),poolId:new q.PublicKey(r.id),owner:this.scope.ownerPubKey});if(!r.ledger&&r.version<6){let d=await eo({id:r.id,programId:r.programId,version:r.version,ledger:c,owner:this.scope.ownerPubKey});o.addInstruction({instructions:[d]})}let m=[s({pubkey:r.id}),s({pubkey:r.authority,isWritable:!1}),s({pubkey:c}),s({pubkey:this.scope.ownerPubKey,isWritable:!1,isSigner:!0}),s({pubkey:i}),s({pubkey:new q.PublicKey(r.jsonInfo.lpVault)}),s({pubkey:u[0]}),s({pubkey:r.rewardInfos[0].rewardVault}),s({pubkey:q.SYSVAR_CLOCK_PUBKEY,isWritable:!1}),s({pubkey:qe.TOKEN_PROGRAM_ID,isWritable:!1})];return{txBuilder:o,lpTokenAccount:i,rewardTokenAccountsPublicKeys:u,ledgerAddress:c,lowVersionKeys:m}}async deposit(e){this.scope.checkOwner();let{farmId:o,amount:r}=e,i=this.getParsedFarm(o),a=i.lpMint,{version:u,rewardInfos:c}=i;Xt(u)||this.logAndCreateError("invalid farm version:",u);let{txBuilder:m,ledgerAddress:d,lpTokenAccount:p,lowVersionKeys:y,rewardTokenAccountsPublicKeys:f}=await this._prepareFarmAccounts({mint:a,farmInfo:i}),b=Xn({version:u,rewardInfos:c,rewardTokenAccountsPublicKeys:f});b&&this.logAndCreateError(b);let w=Buffer.alloc(ze.span);ze.encode({instruction:zn(u),amount:I(r)},w);let S=u===6?[s({pubkey:qe.TOKEN_PROGRAM_ID,isWritable:!1}),s({pubkey:q.SystemProgram.programId,isWritable:!1}),s({pubkey:i.id}),s({pubkey:i.authority,isWritable:!1}),s({pubkey:i.lpVault.mint}),s({pubkey:d}),s({pubkey:this.scope.ownerPubKey,isWritable:!1,isSigner:!0}),s({pubkey:p})]:y;if(u!==3)for(let k=1;k<c.length;k++)S.push(s({pubkey:f[k]})),S.push(s({pubkey:c[k].rewardVault}));let g=new q.TransactionInstruction({programId:i.programId,keys:S,data:w});return await m.addInstruction({instructions:[g]}).build()}async withdraw(e){this.scope.checkOwner();let{farmId:o,amount:r}=e,i=this.getParsedFarm(o),a=i.lpMint,{version:u,rewardInfos:c}=i;Xt(u)||this.logAndCreateError("invalid farm version:",u);let{txBuilder:m,ledgerAddress:d,lpTokenAccount:p,lowVersionKeys:y,rewardTokenAccountsPublicKeys:f}=await this._prepareFarmAccounts({mint:a,farmInfo:i}),b=Buffer.alloc(ze.span);ze.encode({instruction:Zn(u),amount:I(r)},b);let w=u===6?[s({pubkey:qe.TOKEN_PROGRAM_ID,isWritable:!1}),s({pubkey:i.id}),s({pubkey:i.authority,isWritable:!1}),s({pubkey:i.lpVault.mint}),s({pubkey:d}),s({pubkey:this.scope.ownerPubKey,isWritable:!1,isSigner:!0}),s({pubkey:p})]:y;if(u!==3)for(let g=1;g<c.length;g++)w.push(s({pubkey:f[g]})),w.push(s({pubkey:c[g].rewardVault}));let S=new q.TransactionInstruction({programId:i.programId,keys:w,data:b});return await m.addInstruction({instructions:[S]}).build()}async withdrawFarmReward({farmId:e,withdrawMint:o}){var y;this.scope.checkOwner();let r=this.getParsedFarm(e),{version:i}=r;i!==6&&this.logAndCreateError("invalid farm version",r.version);let a=r.rewardInfos.find(f=>f.rewardMint.equals(o.equals(U)?new q.PublicKey($.mint):o));a||this.logAndCreateError("withdraw mint error","rewardInfos",r);let u=(y=a==null?void 0:a.rewardVault)!=null?y:U,c=this.createTxBuilder(),m;if(this._getUserRewardInfo({payer:this.scope.ownerPubKey,rewardInfo:a}),o.equals(U)){let f=await xe({connection:this.scope.connection,owner:this.scope.ownerPubKey,payer:this.scope.ownerPubKey,amount:tn(a)});m=f.signers[0].publicKey,c.addInstruction(f)}else{let f=await this.scope.account.getCreatedTokenAccount({mint:o});f===null?(m=await this.scope.account.getAssociatedTokenAccount(o),c.addInstruction({instructions:[(0,qe.createAssociatedTokenAccountInstruction)(this.scope.ownerPubKey,m,this.scope.ownerPubKey,o)]})):m=f}let d=Buffer.alloc(Qt.span);Qt.encode({instruction:5},d);let p=[s({pubkey:qe.TOKEN_PROGRAM_ID,isWritable:!1}),s({pubkey:r.id}),s({pubkey:r.authority,isWritable:!1}),s({pubkey:r.lpVault.mint,isWritable:!1}),s({pubkey:u}),s({pubkey:m}),s({pubkey:this.scope.ownerPubKey,isWritable:!1,isSigner:!0})];return await c.addInstruction({instructions:[new q.TransactionInstruction({programId:r.programId,keys:p,data:d})]}).build()}};var Ki=require("@solana/web3.js"),we=H(require("bn.js"));var co=require("@solana/web3.js"),mo=H(require("bn.js")),lo=(c=>(c[c.Uninitialized=0]="Uninitialized",c[c.Initialized=1]="Initialized",c[c.Disabled=2]="Disabled",c[c.RemoveLiquidityOnly=3]="RemoveLiquidityOnly",c[c.LiquidityOnly=4]="LiquidityOnly",c[c.OrderBook=5]="OrderBook",c[c.Swap=6]="Swap",c[c.WaitingForStart=7]="WaitingForStart",c))(lo||{}),po=new mo.default(25),fo=new mo.default(1e4),yo="675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8",yi=new co.PublicKey(yo),bo="5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h",bi=new co.PublicKey(bo),Aa={[yo]:4,[bo]:5},go={4:yi,5:bi},Po={4:3,5:3};var dn=require("@solana/spl-token"),le=require("@solana/web3.js");var on=R([D("instruction"),l("amountIn"),l("minAmountOut")]),rn=R([D("instruction"),l("maxAmountIn"),l("amountOut")]),an=R([D("instruction"),D("nonce")]),sn=R([D("instruction"),D("nonce"),l("startTime")]),un=R([l("status"),l("nonce"),l("maxOrder"),l("depth"),l("baseDecimal"),l("quoteDecimal"),l("state"),l("resetFlag"),l("minSize"),l("volMaxCutRatio"),l("amountWaveRatio"),l("baseLotSize"),l("quoteLotSize"),l("minPriceMultiplier"),l("maxPriceMultiplier"),l("systemDecimalValue"),l("minSeparateNumerator"),l("minSeparateDenominator"),l("tradeFeeNumerator"),l("tradeFeeDenominator"),l("pnlNumerator"),l("pnlDenominator"),l("swapFeeNumerator"),l("swapFeeDenominator"),l("baseNeedTakePnl"),l("quoteNeedTakePnl"),l("quoteTotalPnl"),l("baseTotalPnl"),z("quoteTotalDeposited"),z("baseTotalDeposited"),z("swapBaseInAmount"),z("swapQuoteOutAmount"),l("swapBase2QuoteFee"),z("swapQuoteInAmount"),z("swapBaseOutAmount"),l("swapQuote2BaseFee"),h("baseVault"),h("quoteVault"),h("baseMint"),h("quoteMint"),h("lpMint"),h("openOrders"),h("marketId"),h("marketProgramId"),h("targetOrders"),h("withdrawQueue"),h("lpVault"),h("owner"),l("lpReserve"),ee(l(),3,"padding")]),gi=R([l("accountType"),l("status"),l("nonce"),l("maxOrder"),l("depth"),l("baseDecimal"),l("quoteDecimal"),l("state"),l("resetFlag"),l("minSize"),l("volMaxCutRatio"),l("amountWaveRatio"),l("baseLotSize"),l("quoteLotSize"),l("minPriceMultiplier"),l("maxPriceMultiplier"),l("systemDecimalsValue"),l("abortTradeFactor"),l("priceTickMultiplier"),l("priceTick"),l("minSeparateNumerator"),l("minSeparateDenominator"),l("tradeFeeNumerator"),l("tradeFeeDenominator"),l("pnlNumerator"),l("pnlDenominator"),l("swapFeeNumerator"),l("swapFeeDenominator"),l("baseNeedTakePnl"),l("quoteNeedTakePnl"),l("quoteTotalPnl"),l("baseTotalPnl"),l("poolOpenTime"),l("punishPcAmount"),l("punishCoinAmount"),l("orderbookToInitTime"),z("swapBaseInAmount"),z("swapQuoteOutAmount"),z("swapQuoteInAmount"),z("swapBaseOutAmount"),l("swapQuote2BaseFee"),l("swapBase2QuoteFee"),h("baseVault"),h("quoteVault"),h("baseMint"),h("quoteMint"),h("lpMint"),h("modelDataAccount"),h("openOrders"),h("marketId"),h("marketProgramId"),h("targetOrders"),h("owner"),ee(l(),64,"padding")]),cn=R([D("instruction"),l("baseAmountIn"),l("quoteAmountIn"),l("fixedSide")]),mn=R([D("instruction"),l("amountIn")]),wo={4:un,5:gi};var Pi=require("@solana/web3.js");var Pe=new Pi.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Ue=5e4,wi=R([l("x"),l("y"),l("price")]),hi=R([l("accountType"),l("status"),l("multiplier"),l("validDataCount"),ee(wi,Ue,"DataElement")]);function Ia(n,t){return[0,Ue-2]}function xa(n){return[0,Ue-2]}function Sa(n){return[0,Ue-2]}function La(n,t,e){let[o,r]=Ia(t,e),i=o,a=r,u=0,c=t*n.multiplier/e;for(;i<=a;){if(u=Math.floor((a+i)/2),u===0||u>=Ue-2)return[u,u,!1];let m=n.DataElement[u].x*n.multiplier/n.DataElement[u].y,d=n.DataElement[u-1].x*n.multiplier/n.DataElement[u-1].y,p=n.DataElement[u+1].x*n.multiplier/n.DataElement[u+1].y;if(c===m)return[u,u,!0];if(c===d)return[u-1,u-1,!0];if(c===p)return[u+1,u+1,!0];if(c<d)a=u-1;else{if(c>d&&c<m)return[u-1,u,!0];if(c>m&&c<p)return[u,u+1,!0];i=u+1}}return[u,u,!1]}function ho(n,t,e){let[o,r,i]=La(n,t,e);if(!i)return 0;if(o===r){let a=n.DataElement[o].x;return t*n.multiplier/a}else{let a=n.DataElement[o].x,u=n.DataElement[o].y,c=n.DataElement[r].x,m=n.DataElement[r].y,d=e*(c*u-a*m),p=a*d,y=(c-a)*(t*u-a*e)*m,f=p+y;return t*n.multiplier*d/f}}function We(n,t,e){return t*n.multiplier/e}function ki(n,t,e){return t*e/n.multiplier}function _a(n,t){let[e,o]=xa(t),r=e,i=o,a=0,u=t;for(;r<i;){if(a=Math.floor((i+r)/2),a<=0||a>Ue-2)return[a,a,!1];let c=n.DataElement[a].x,m=n.DataElement[a-1].x,d=n.DataElement[a+1].x;if(u===c)return[a,a,!0];if(u===m)return[a-1,a-1,!0];if(u===d)return[a+1,a+1,!0];if(u<m)i=a-1;else{if(u>m&&u<c)return[a-1,a,!0];if(u>c&&u<d)return[a,a+1,!0];r=a+1}}return[a,a,!1]}function Ra(n,t){let[e,o]=Sa(t),r=e,i=o,a=0,u=t;for(;r<=i;){if(a=Math.floor((i+r)/2),a<=0||a>=Ue-2)return[a,a,!1];let c=n.DataElement[a].y,m=n.DataElement[a-1].y,d=n.DataElement[a+1].y;if(u===c)return[a,a,!0];if(u===m)return[a-1,a-1,!0];if(u===d)return[a+1,a+1,!0];if(u<d)r=a+1;else{if(u<m&&u>c)return[a-1,a,!0];if(u<c&&u>d)return[a,a+1,!0];i=a-1}}return[a,a,!1]}function Ti(n,t,e,o){let r=o?t+e:t-e,[i,a,u]=_a(n,r);if(!u)return[0,0,!1,u];if(i===a)return[n.DataElement[a].price,n.DataElement[a].y,!1,u];{let c=n.DataElement[i].x,m=n.DataElement[a].x,d=n.DataElement[i].price,p=n.DataElement[a].price,y=n.DataElement[i].y,f=n.DataElement[a].y;if(t>=c&&t<=m)return o?[p,f,!0,u]:[d,y,!0,u];{let b,w;return o?(b=d+(p-d)*(t-c)/(m-c),w=y-(r-c)*n.multiplier/p):(b=d+(p-d)*(t-c)/(m-c),w=f+(m-r)*n.multiplier/d),[b,w,!1,u]}}}function Ma(n,t,e,o){let r=o?t-e:t+e,[i,a,u]=Ra(n,r);if(!u)return[0,0,!1,u];if(i===a)return[n.DataElement[a].price,n.DataElement[a].x,!1,u];{let c=n.DataElement[i].x,m=n.DataElement[a].x,d=n.DataElement[i].price,p=n.DataElement[a].price,y=n.DataElement[i].y,f=n.DataElement[a].y;if(t>=f&&t<=y)return o?[p,m,!0,u]:[d,c,!0,u];{let b,w;return o?(b=d+(p-d)*(y-t)/(y-f),w=c+p*(y-r)/n.multiplier):(b=d+(p-d)*(y-t)/(y-f),w=m-d*(r-f)/n.multiplier),[b,w,!1,u]}}}function Ba(n,t){let e=Ti(n,t,0,!1);return e[3]?e[0]:0}function ko(n,t,e,o){let r=ho(n,t,e),i=We(n,t,r),a=We(n,e,r),u=We(n,o,r),c=!0,[m,d,p,y]=Ti(n,i,u,c);if(!y)return 0;if(p)return o*n.multiplier/m;{let f=a-d;return ki(n,f,r)}}function To(n,t,e,o){let r=ho(n,t,e),i=We(n,t,r),a=We(n,e,r),u=We(n,o,r),c=!1,[m,d,p,y]=Ma(n,a,u,c);if(!y)return 0;if(p)return o*m/n.multiplier;{let f=i-d;return ki(n,f,r)}}function Ai(n){let t=hi.decode(n);return{accountType:t.accountType.toNumber(),status:t.status.toNumber(),multiplier:t.multiplier.toNumber(),validDataCount:t.validDataCount.toNumber(),DataElement:t.DataElement.map(e=>({x:e.x.toNumber(),y:e.y.toNumber(),price:e.price.toNumber()}))}}function Ao(n,t,e,o){let r=Ba(n,We(n,t,ho(n,t,e)))/n.multiplier;return o?r:1/r}var kt=class{constructor({connection:t}){this._layoutData={accountType:0,status:0,multiplier:0,validDataCount:0,DataElement:[]};this.connection=t}get stableModelData(){return this._layoutData}async initStableModelLayout(){if(this._layoutData.validDataCount===0&&this.connection){let t=await this.connection.getAccountInfo(Pe);t&&(this._layoutData=Ai(t==null?void 0:t.data))}}};var ln=M("Raydium_liquidity_instruction");function Io(n){let{poolKeys:t,userKeys:e,amountIn:o,amountOut:r,fixedSide:i}=n,{version:a}=t;if(a===4||a===5){let u={poolKeys:t,userKeys:e};if(i==="in")return Ii(K(L({},u),{amountIn:o,minAmountOut:r}),a);if(i==="out")return xi(K(L({},u),{maxAmountIn:o,amountOut:r}),a);ln.logWithError("invalid params","params",n)}throw ln.logWithError("invalid version","poolKeys.version",a),new Error("invalid version")}function xo(n){let t=R([D("instruction"),D("simulateType")]),e=Buffer.alloc(t.span);t.encode({instruction:12,simulateType:0},e);let o=[s({pubkey:n.id,isWritable:!1}),s({pubkey:n.authority,isWritable:!1}),s({pubkey:n.openOrders,isWritable:!1}),s({pubkey:n.baseVault,isWritable:!1}),s({pubkey:n.quoteVault,isWritable:!1}),s({pubkey:n.lpMint,isWritable:!1}),s({pubkey:n.marketId,isWritable:!1})];return new le.TransactionInstruction({programId:n.programId,keys:o,data:e})}function Ii({poolKeys:n,userKeys:t,amountIn:e,minAmountOut:o},r){let i=Buffer.alloc(on.span);on.encode({instruction:9,amountIn:I(e),minAmountOut:I(o)},i);let a=[s({pubkey:dn.TOKEN_PROGRAM_ID,isWritable:!1}),s({pubkey:n.id}),s({pubkey:n.authority,isWritable:!1}),s({pubkey:n.openOrders})];return r===4&&a.push(s({pubkey:n.targetOrders})),a.push(s({pubkey:n.baseVault}),s({pubkey:n.quoteVault})),r===5&&a.push(s({pubkey:Pe})),a.push(s({pubkey:n.marketProgramId,isWritable:!1}),s({pubkey:n.marketId}),s({pubkey:n.marketBids}),s({pubkey:n.marketAsks}),s({pubkey:n.marketEventQueue}),s({pubkey:n.marketBaseVault}),s({pubkey:n.marketQuoteVault}),s({pubkey:n.marketAuthority,isWritable:!1}),s({pubkey:t.tokenAccountIn}),s({pubkey:t.tokenAccountOut}),s({pubkey:t.owner,isWritable:!1})),new le.TransactionInstruction({programId:n.programId,keys:a,data:i})}function xi({poolKeys:n,userKeys:t,maxAmountIn:e,amountOut:o},r){let i=Buffer.alloc(rn.span);rn.encode({instruction:11,maxAmountIn:I(e),amountOut:I(o)},i);let a=[s({pubkey:le.SystemProgram.programId,isWritable:!1}),s({pubkey:n.id}),s({pubkey:n.authority,isWritable:!1}),s({pubkey:n.openOrders}),s({pubkey:n.targetOrders}),s({pubkey:n.baseVault}),s({pubkey:n.quoteVault})];return r===5&&a.push(s({pubkey:Pe})),a.push(s({pubkey:n.marketProgramId,isWritable:!1}),s({pubkey:n.marketId}),s({pubkey:n.marketBids}),s({pubkey:n.marketAsks}),s({pubkey:n.marketEventQueue}),s({pubkey:n.marketBaseVault}),s({pubkey:n.marketQuoteVault}),s({pubkey:n.marketAuthority,isWritable:!1}),s({pubkey:t.tokenAccountIn}),s({pubkey:t.tokenAccountOut}),s({pubkey:t.owner,isWritable:!1,isSigner:!0})),new le.TransactionInstruction({programId:n.programId,keys:a,data:i})}function So(n){let i=n,{owner:t}=i,e=ne(i,["owner"]),o=Buffer.alloc(an.span);an.encode({instruction:10,nonce:e.nonce},o);let r=[...De,s({pubkey:e.targetOrders}),s({pubkey:e.withdrawQueue}),s({pubkey:e.authority,isWritable:!1}),s({pubkey:e.lpMint}),s({pubkey:e.baseMint,isWritable:!1}),s({pubkey:e.quoteMint,isWritable:!1}),s({pubkey:e.baseVault}),s({pubkey:e.quoteVault}),s({pubkey:e.lpVault}),s({pubkey:e.marketId,isWritable:!1}),s({pubkey:t,isSigner:!0})];return new le.TransactionInstruction({programId:e.programId,keys:r,data:o})}function Lo(n){let{poolKeys:t,userKeys:e,startTime:o}=n,r=Buffer.alloc(sn.span);sn.encode({instruction:0,nonce:t.nonce,startTime:I(o)},r);let i=[...De,s({pubkey:t.id}),s({pubkey:t.authority,isWritable:!1}),s({pubkey:t.openOrders}),s({pubkey:t.lpMint}),s({pubkey:t.baseMint,isWritable:!1}),s({pubkey:t.quoteMint,isWritable:!1}),s({pubkey:t.baseVault,isWritable:!1}),s({pubkey:t.quoteVault,isWritable:!1}),s({pubkey:t.withdrawQueue}),s({pubkey:t.targetOrders}),s({pubkey:e.lpTokenAccount}),s({pubkey:t.lpVault,isWritable:!1}),s({pubkey:t.marketProgramId,isWritable:!1}),s({pubkey:t.marketId,isWritable:!1}),s({pubkey:e.payer,isSigner:!0})];return new le.TransactionInstruction({programId:t.programId,keys:i,data:r})}function _o(n){let{poolKeys:t,userKeys:e,baseAmountIn:o,quoteAmountIn:r,fixedSide:i}=n,{version:a}=t;if(a===4||a===5){let u=Buffer.alloc(cn.span);cn.encode({instruction:3,baseAmountIn:I(o),quoteAmountIn:I(r),fixedSide:I(i==="base"?0:1)},u);let c=[s({pubkey:dn.TOKEN_PROGRAM_ID,isWritable:!1}),s({pubkey:t.id}),s({pubkey:t.authority,isWritable:!1}),s({pubkey:t.openOrders,isWritable:!1}),s({pubkey:t.targetOrders}),s({pubkey:t.lpMint}),s({pubkey:t.baseVault}),s({pubkey:t.quoteVault})];return a===5&&c.push(s({pubkey:Pe})),c.push(s({pubkey:t.marketId,isWritable:!1}),s({pubkey:e.baseTokenAccount}),s({pubkey:e.quoteTokenAccount}),s({pubkey:e.lpTokenAccount}),s({pubkey:e.owner,isWritable:!1,isSigner:!0})),new le.TransactionInstruction({programId:t.programId,keys:c,data:u})}return ln.logWithError("invalid version","poolKeys.version",a),new le.TransactionInstruction({programId:t.programId,keys:[]})}function Ro(n){let{poolKeys:t,userKeys:e,amountIn:o}=n,{version:r}=t;if(r===4||r===5){let i=Buffer.alloc(mn.span);mn.encode({instruction:4,amountIn:I(o)},i);let a=[s({pubkey:dn.TOKEN_PROGRAM_ID,isWritable:!1}),s({pubkey:t.id}),s({pubkey:t.authority,isWritable:!1}),s({pubkey:t.openOrders}),s({pubkey:t.targetOrders}),s({pubkey:t.lpMint}),s({pubkey:t.baseVault}),s({pubkey:t.quoteVault})];return r===5?a.push(s({pubkey:Pe})):a.push(s({pubkey:t.withdrawQueue}),s({pubkey:t.lpVault})),a.push(s({pubkey:t.marketProgramId,isWritable:!1}),s({pubkey:t.marketId}),s({pubkey:t.marketBaseVault}),s({pubkey:t.marketQuoteVault}),s({pubkey:t.marketAuthority,isWritable:!1}),s({pubkey:e.lpTokenAccount}),s({pubkey:e.baseTokenAccount}),s({pubkey:e.quoteTokenAccount}),s({pubkey:e.owner,isWritable:!1,isSigner:!0}),s({pubkey:t.marketEventQueue}),s({pubkey:t.marketBids}),s({pubkey:t.marketAsks})),new le.TransactionInstruction({programId:t.programId,keys:a,data:i})}return ln.logWithError("invalid version","poolKeys.version",r),new le.TransactionInstruction({programId:t.programId,keys:[]})}var _i=require("@project-serum/serum"),Xe=H(require("bn.js"));var Mo=require("@solana/web3.js");var Bo=M("Raydium_liquidity_serum"),Ko="9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin",Si=new Mo.PublicKey(Ko),Ka={[Ko]:3},Li={3:Si};function Oo(n){let t=Po[n];return t||Bo.logWithError("invalid version","version",n),t}function qo(n){let t=Li[n];return t||Bo.logWithError("invalid version","version",n),t}async function Fo({programId:n,marketId:t}){let e=[t.toBuffer()],o=0,r;for(;o<100;){try{let i=e.concat(Buffer.from([o]),Buffer.alloc(7));r=await Mo.PublicKey.createProgramAddress(i,n)}catch(i){if(i instanceof TypeError)throw i;o++;continue}return{publicKey:r,nonce:o}}throw Bo.logWithError("unable to find a viable program address nonce","params",{programId:n,marketId:t}),new Error("unable to find a viable program address nonce")}var pn=M("Raydium_liquidity_util");function fn(n,t){let e=n instanceof O?n.token:J.WSOL,{baseMint:o,quoteMint:r}=t;if(e.mint.equals(o))return"base";if(e.mint.equals(r))return"quote";let i=`liquidity getTokenSide - token not match with pool, params: ${JSON.stringify({token:e.mint,baseMint:o,quoteMint:r})}`;throw console.error(i),new Error(i)}function Ge(n,t){let{baseMint:e,quoteMint:o}=t;return n.mint.equals(e)||n.mint.equals(o)}function yn(n){let{status:t,startTime:e}=n,o=t.toNumber();return{[0]:{swap:!1,addLiquidity:!1,removeLiquidity:!1},[1]:{swap:!0,addLiquidity:!0,removeLiquidity:!0},[2]:{swap:!1,addLiquidity:!1,removeLiquidity:!1},[3]:{swap:!1,addLiquidity:!1,removeLiquidity:!0},[4]:{swap:!1,addLiquidity:!0,removeLiquidity:!0},[5]:{swap:!1,addLiquidity:!0,removeLiquidity:!0},[6]:{swap:!0,addLiquidity:!0,removeLiquidity:!0},[7]:{swap:Date.now()/1e3>=e.toNumber(),addLiquidity:!0,removeLiquidity:!0}}[o]||{swap:!1,addLiquidity:!1,removeLiquidity:!1}}function Oa(n){let t=wo[n];return t||pn.logWithError("invalid version","version",n),t}function Ri(n){let t=go[n];return t||pn.logWithError("invalid version","version",n),t}async function Se({name:n,programId:t,marketId:e}){let{publicKey:o}=await Ie([t.toBuffer(),e.toBuffer(),Buffer.from(n,"utf-8")],t);return o}async function Mi({programId:n}){return Ie([Buffer.from([97,109,109,32,97,117,116,104,111,114,105,116,121])],n)}async function bn({version:n,marketId:t,baseMint:e,quoteMint:o}){let r=Ri(n),[i,a,u]=[C({publicKey:t}),C({publicKey:e,transformSol:!0}),C({publicKey:o,transformSol:!0})],c=await Se({name:"amm_associated_seed",programId:r,marketId:i}),m=await Se({name:"lp_mint_associated_seed",programId:r,marketId:i}),{publicKey:d,nonce:p}=await Mi({programId:r}),y=await Se({name:"coin_vault_associated_seed",programId:r,marketId:i}),f=await Se({name:"pc_vault_associated_seed",programId:r,marketId:i}),b=await Se({name:"temp_lp_token_associated_seed",programId:r,marketId:i}),w=await Se({name:"open_order_associated_seed",programId:r,marketId:i}),S=await Se({name:"target_associated_seed",programId:r,marketId:i}),g=await Se({name:"withdraw_associated_seed",programId:r,marketId:i}),k=Oo(n),_=qo(k),{publicKey:T}=await Fo({programId:_,marketId:i});return{id:c,baseMint:a,quoteMint:u,lpMint:m,version:n,programId:r,authority:d,nonce:p,baseVault:y,quoteVault:f,lpVault:b,openOrders:w,targetOrders:S,withdrawQueue:g,marketVersion:k,marketProgramId:_,marketId:i,marketAuthority:T}}async function vo({connection:n,pools:t}){let e=t.map(r=>xo(r));return(await Fr(n,e,"GetPoolData")).map(r=>{let i=Nr(r,"GetPoolData"),a=new Xe.default(Ae(i,"status")),u=Number(Ae(i,"coin_decimals")),c=Number(Ae(i,"pc_decimals")),m=Number(Ae(i,"lp_decimals")),d=new Xe.default(Ae(i,"pool_coin_amount")),p=new Xe.default(Ae(i,"pool_pc_amount")),y=new Xe.default(Ae(i,"pool_lp_supply")),f="0";try{f=Ae(i,"pool_open_time")}catch{f="0"}return{status:a,baseDecimals:u,quoteDecimals:c,lpDecimals:m,baseReserve:d,quoteReserve:p,lpSupply:y,startTime:new Xe.default(f)}})}function Do(n,t,e){return Bi(n.token,t.token,e)}function Bi(n,t,e){let{baseMint:o,quoteMint:r}=e,i=No(n,e),a=No(t,e);return i===a&&pn.logWithError("tokens not match with pool","params",{tokenA:n.mint,tokenB:t.mint,baseMint:o,quoteMint:r}),[i,a]}function No(n,t){let{baseMint:e,quoteMint:o}=t;return n.mint.equals(e)?"base":n.mint.equals(o)?"quote":(pn.logWithError("token not match with pool","params",{token:n.mint,baseMint:e,quoteMint:o}),"base")}var Eo=n=>n==="a"||n==="b";async function qa(n,t,e){let o=await n.getAccountInfo(t);if(o===null)return null;let r=un.decode(o.data),i=await n.getTokenAccountBalance(r.baseVault),a=await n.getTokenAccountBalance(r.quoteVault),u=await _i.OpenOrders.load(n,r.openOrders,e),c=10**r.baseDecimal.toNumber(),m=10**r.quoteDecimal.toNumber(),d=u.baseTokenTotal.toNumber()/c,p=u.quoteTokenTotal.toNumber()/m,y=r.baseNeedTakePnl.toNumber()/c,f=r.quoteNeedTakePnl.toNumber()/m,b=i.value.uiAmount+d-y,w=a.value.uiAmount+p-f,S=parseFloat(r.lpReserve.toString()),g=b/w;return{baseAmount:b,quoteAmount:w,lpSupply:S,baseVaultKey:r.baseVault,quoteVaultKey:r.quoteVault,baseVaultBalance:i.value.uiAmount,quoteVaultBalance:a.value.uiAmount,openOrdersKey:r.openOrders,openOrdersTotalBase:d,openOrdersTotalQuote:p,basePnl:y,quotePnl:f,priceInQuote:g}}var Tt=class extends ie{constructor(e){super(e);this._poolInfos=[];this._poolInfoMap=new Map;this._pairsInfo=[];this._pairsInfoMap=new Map;this._lpTokenMap=new Map;this._lpPriceMap=new Map;this._officialIds=new Set;this._unOfficialIds=new Set;this._sdkParseInfoCache=new Map;this._stableLayout=new kt({connection:this.scope.connection})}async load(e){if(await this.scope.fetchLiquidity(e==null?void 0:e.forceUpdate),!this.scope.apiData.liquidityPools)return;let{data:o}=this.scope.apiData.liquidityPools,[r,i]=[o.official||[],o.unOfficial||[]];this._poolInfos=[...r,...i],this._officialIds=new Set(r.map(a=>{var c,m;let u=`${(c=this.scope.token.allTokenMap.get(a.baseMint))==null?void 0:c.symbol} - ${(m=this.scope.token.allTokenMap.get(a.quoteMint))==null?void 0:m.symbol}`;return this._poolInfoMap.set(a.id,a),this._lpTokenMap.set(a.lpMint,new J({mint:a.lpMint,decimals:a.lpDecimals,symbol:u,name:`${u} LP`})),a.id})),this._unOfficialIds=new Set(i.map(a=>{var c,m;let u=`${(c=this.scope.token.allTokenMap.get(a.baseMint))==null?void 0:c.symbol} - ${(m=this.scope.token.allTokenMap.get(a.quoteMint))==null?void 0:m.symbol}`;return this._poolInfoMap.set(a.id,a),this._lpTokenMap.set(a.lpMint,new J({mint:a.lpMint,decimals:a.lpDecimals,symbol:u,name:`${u} LP`})),a.id}))}async loadPairs(e){var o;return await this.scope.fetchPairs(e==null?void 0:e.forceUpdate),this._pairsInfo=((o=this.scope.apiData.liquidityPairsInfo)==null?void 0:o.data)||[],this._pairsInfoMap=new Map(this._pairsInfo.map(r=>{let i=this._lpTokenMap.get(r.lpMint),a=i&&r.lpPrice?ut({token:i,numberPrice:r.lpPrice,decimalDone:!0}):null;return a&&this._lpPriceMap.set(r.lpMint,a),[r.ammId,r]})),this._pairsInfo}get allPools(){return this._poolInfos}get allPoolIdSet(){return{official:this._officialIds,unOfficial:this._unOfficialIds}}get allPoolMap(){return this._poolInfoMap}get allPairs(){return this._pairsInfo}get allPairsMap(){return this._pairsInfoMap}get lpTokenMap(){return this._lpTokenMap}get lpPriceMap(){return this._lpPriceMap}async fetchMultipleInfo(e){return await this._stableLayout.initStableModelLayout(),await vo(K(L({},e),{connection:this.scope.connection}))}async sdkParseJsonLiquidityInfo(e){if(!e.length)return[];let o=e.map(r=>r.id).join("-");if(this._sdkParseInfoCache.has(o))return this._sdkParseInfoCache.get(o);try{let i=(await this.fetchMultipleInfo({pools:e.map(pe)})).map((a,u)=>L(L({jsonInfo:e[u]},pe(e[u])),a));return this._sdkParseInfoCache.set(o,i),i}catch(r){return console.error(r),[]}}computeAmountOut({poolKeys:e,poolInfo:o,amountIn:r,outputToken:i,slippage:a}){this.checkDisabled();let u=M("Raydium_computeAmountOut"),c=r.token,m=i;(!Ge(c,e)||!Ge(m,e))&&u.logWithError("token not match with pool","poolKeys",e);let{baseReserve:d,quoteReserve:p}=o;this.logDebug("baseReserve:",d.toString(),"quoteReserve:",p.toString());let y=r.token;this.logDebug("inputToken:",y),this.logDebug("amountIn:",r.toFixed()),this.logDebug("outputToken:",i),this.logDebug("slippage:",`${a.toSignificant()}%`);let f=[d,p],b=fn(r,e);b==="quote"&&f.reverse(),this.logDebug("input side:",b);let[w,S]=f,g;if(e.version===4)g=new Z({baseToken:y,denominator:w,quoteToken:i,numerator:S});else{let Q=Ao(this._stableLayout.stableModelData,d.toNumber(),p.toNumber(),!1);g=new Z({baseToken:y,denominator:b==="quote"?new we.default(Q*1e6):new we.default(1e6),quoteToken:i,numerator:b==="quote"?new we.default(1e6):new we.default(Q*1e6)})}this.logDebug("currentPrice:",`1 ${y.symbol} \u2248 ${g.toFixed()} ${i.symbol}`),this.logDebug("currentPrice invert:",`1 ${i.symbol} \u2248 ${g.invert().toFixed()} ${y.symbol}`);let k=r.raw,_=ue,T=ue;if(!k.isZero())if(e.version===4){T=k.mul(po).div(fo);let Q=k.sub(T),oe=w.add(Q);_=S.mul(Q).div(oe)}else{T=k.mul(new we.default(2)).div(new we.default(1e4));let Q=k.sub(T),oe=b==="quote"?ko:To;_=new we.default(oe(this._stableLayout.stableModelData,p.toNumber(),d.toNumber(),Q.toNumber()))}let N=new re(be).add(a).invert().mul(_).quotient,v=new O(i,_),Y=new O(i,N);this.logDebug("amountOut:",v.toFixed(),"minAmountOut:",Y.toFixed());let E=new Z({baseToken:y,denominator:k.sub(T),quoteToken:i,numerator:_});!k.isZero()&&!_.isZero()&&(E=new Z({baseToken:y,denominator:k.sub(T),quoteToken:i,numerator:_}),this.logDebug("executionPrice:",`1 ${y.symbol} \u2248 ${E.toFixed()} ${i.symbol}`),this.logDebug("executionPrice invert:",`1 ${i.symbol} \u2248 ${E.invert().toFixed()} ${y.symbol}`));let G=new re(parseInt(String(Math.abs(parseFloat(E.toFixed())-parseFloat(g.toFixed()))*1e9)),parseInt(String(parseFloat(g.toFixed())*1e9))),te=new O(y,T);return{amountOut:v,minAmountOut:Y,currentPrice:g,executionPrice:E,priceImpact:G,fee:te}}async computePairAmount({poolId:e,amount:o,anotherToken:r,slippage:i}){let a=C({publicKey:e}),u=this._poolInfoMap.get(a.toBase58());u||this.logAndCreateError("pool not found",a.toBase58());let c=(await this.sdkParseJsonLiquidityInfo([u]))[0];c||this.logAndCreateError("pool parseInfo not found",a.toBase58());let{baseReserve:m,quoteReserve:d}=c;this.logDebug("baseReserve:",m.toString(),"quoteReserve:",d.toString());let p=o.token;this.logDebug("tokenIn:",p,"amount:",o.toFixed(),"anotherToken:",r,"slippage:",`${i.toSignificant()}%`);let y=fn(o,pe(u));this.logDebug("input side:",y);let f=ue;o.isZero()||(f=y==="base"?Tn(o.raw.mul(d),m):Tn(o.raw.mul(m),d));let w=new re(be).add(i).mul(f).quotient,S=new O(r,f),g=new O(r,w);return this.logDebug("anotherAmount:",S.toFixed(),"maxAnotherAmount:",g.toFixed()),{anotherAmount:S,maxAnotherAmount:g}}async swapWithAMM(e){let{poolKeys:o,payer:r,amountIn:i,amountOut:a,fixedSide:u,config:c}=e;this.logDebug("amountIn:",i),this.logDebug("amountOut:",a),(i.isZero()||a.isZero())&&this.logAndCreateError("amounts must greater than zero","amounts",{amountIn:i.toFixed(),amountOut:a.toFixed()});let{account:m}=this.scope,d=this.createTxBuilder(),{bypassAssociatedCheck:p=!1}=c||{},[y,f]=[i.token,a.token],b=await m.getCreatedTokenAccount({mint:y.mint,associatedOnly:!1}),w=await m.getCreatedTokenAccount({mint:f.mint}),[S,g]=[i.raw,a.raw],N=await m.handleTokenAccount({side:"in",amount:S,mint:y.mint,tokenAccount:b,bypassAssociatedCheck:p}),{tokenAccount:k}=N,_=ne(N,["tokenAccount"]);d.addInstruction(_);let v=await m.handleTokenAccount({side:"out",amount:0,mint:f.mint,tokenAccount:w,payer:r,bypassAssociatedCheck:p}),{tokenAccount:T}=v,F=ne(v,["tokenAccount"]);return d.addInstruction(F),d.addInstruction({instructions:[Io({poolKeys:o,userKeys:{tokenAccountIn:k,tokenAccountOut:T,owner:this.scope.ownerPubKey},amountIn:S,amountOut:g,fixedSide:u})]}),d.buildMultiTx({extInfo:{amountOut:a}})}async createPool(e){this.checkDisabled(),this.scope.checkOwner(),e.version!==4&&this.logAndCreateError("invalid version","poolKeys.version",e.version);let o=this.createTxBuilder(),r=await bn(e);return await o.addInstruction({instructions:[So(K(L({},r),{owner:this.scope.ownerPubKey}))]}).build()}async initPool(e){e.version!==4&&this.logAndCreateError("invalid version","poolKeys.version",e.version);let{baseAmount:o,quoteAmount:r,startTime:i=0,config:a}=e,u=await bn(e),{baseMint:c,quoteMint:m,lpMint:d,baseVault:p,quoteVault:y}=u,f=this.createTxBuilder(),{account:b}=this.scope,w=!!(a!=null&&a.bypassAssociatedCheck),S=await b.getCreatedTokenAccount({mint:c,associatedOnly:!1}),g=await b.getCreatedTokenAccount({mint:m,associatedOnly:!1});!S&&!g&&this.logAndCreateError("cannot found target token accounts","tokenAccounts",b.tokenAccounts);let k=await b.getCreatedTokenAccount({mint:d,associatedOnly:!1}),E=await b.handleTokenAccount({side:"in",amount:o.raw,mint:c,tokenAccount:S,bypassAssociatedCheck:w}),{tokenAccount:_}=E,T=ne(E,["tokenAccount"]);f.addInstruction(T);let G=await b.handleTokenAccount({side:"in",amount:r.raw,mint:m,tokenAccount:g,bypassAssociatedCheck:w}),{tokenAccount:F}=G,N=ne(G,["tokenAccount"]);f.addInstruction(N);let te=await b.handleTokenAccount({side:"out",amount:0,mint:d,tokenAccount:k,bypassAssociatedCheck:w}),{tokenAccount:v}=te,Y=ne(te,["tokenAccount"]);return f.addInstruction(Y),f.addInstruction({instructions:[Ve({source:_,destination:p,owner:this.scope.ownerPubKey,amount:o.raw}),Ve({source:F,destination:y,owner:this.scope.ownerPubKey,amount:r.raw}),Lo({poolKeys:u,userKeys:{lpTokenAccount:v,payer:this.scope.ownerPubKey},startTime:i})]}),await f.build()}async addLiquidity(e){let{poolId:o,amountInA:r,amountInB:i,fixedSide:a,config:u}=e,c=C({publicKey:o}),m=this.allPools.find(Ot=>Ot.id===c.toBase58());m||this.logAndCreateError("pool not found",o);let p=(await this.sdkParseJsonLiquidityInfo([m]))[0];p||this.logAndCreateError("pool parse error",p),this.logDebug("amountInA:",r,"amountInB:",i),(r.isZero()||i.isZero())&&this.logAndCreateError("amounts must greater than zero","amountInA & amountInB",{amountInA:r.toFixed(),amountInB:i.toFixed()});let{account:y}=this.scope,f=(u==null?void 0:u.bypassAssociatedCheck)||!1,[b,w]=[r.token,i.token],S=await y.getCreatedTokenAccount({mint:b.mint,associatedOnly:!1}),g=await y.getCreatedTokenAccount({mint:w.mint,associatedOnly:!1});!S&&!g&&this.logAndCreateError("cannot found target token accounts","tokenAccounts",y.tokenAccounts);let k=await y.getCreatedTokenAccount({mint:p.lpMint}),_=[b,w],T=[S,g],F=[r.raw,i.raw],[N]=Do(r,i,p),v="base";(!["quote","base"].includes(N)||!Eo(a))&&this.logAndCreateError("invalid fixedSide","fixedSide",a),N==="quote"?(_.reverse(),T.reverse(),F.reverse(),v=a==="a"?"quote":"base"):N==="base"&&(v=a==="a"?"base":"quote");let[Y,E]=_,[G,te]=T,[Q,oe]=F,ae=this.createTxBuilder(),nt=await y.handleTokenAccount({side:"in",amount:Q,mint:Y.mint,tokenAccount:G,bypassAssociatedCheck:f}),{tokenAccount:Le}=nt,de=ne(nt,["tokenAccount"]);ae.addInstruction(de);let ot=await y.handleTokenAccount({side:"in",amount:oe,mint:E.mint,tokenAccount:te,bypassAssociatedCheck:f}),{tokenAccount:he}=ot,ye=ne(ot,["tokenAccount"]);ae.addInstruction(ye);let rt=await y.handleTokenAccount({side:"out",amount:0,mint:p.lpMint,tokenAccount:k,bypassAssociatedCheck:f}),{tokenAccount:Bt}=rt,Kt=ne(rt,["tokenAccount"]);return ae.addInstruction(Kt),ae.addInstruction({instructions:[_o({poolKeys:p,userKeys:{baseTokenAccount:Le,quoteTokenAccount:he,lpTokenAccount:Bt,owner:this.scope.ownerPubKey},baseAmountIn:Q,quoteAmountIn:oe,fixedSide:v})]}),await ae.build()}async removeLiquidity(e){let{poolId:o,amountIn:r,config:i}=e,a=C({publicKey:o}),u=this.allPools.find(E=>E.id===a.toBase58());u||this.logAndCreateError("pool not found",o);let m=(await this.sdkParseJsonLiquidityInfo([u]))[0];m||this.logAndCreateError("pool pass error",m);let{baseMint:d,quoteMint:p,lpMint:y}=m;this.logDebug("amountIn:",r),r.isZero()&&this.logAndCreateError("amount must greater than zero","amountIn",r.toFixed()),r.token.mint.equals(y)||this.logAndCreateError("amountIn's token not match lpMint","amountIn",r);let{account:f}=this.scope,b=await f.getCreatedTokenAccount({mint:y,associatedOnly:!1});b||this.logAndCreateError("cannot found lpTokenAccount","tokenAccounts",f.tokenAccounts);let w=await f.getCreatedTokenAccount({mint:d}),S=await f.getCreatedTokenAccount({mint:p}),g=this.createTxBuilder(),k=(i==null?void 0:i.bypassAssociatedCheck)||!1,v=await f.handleTokenAccount({side:"out",amount:0,mint:d,tokenAccount:w,bypassAssociatedCheck:k}),{tokenAccount:_}=v,T=ne(v,["tokenAccount"]);g.addInstruction(T);let Y=await f.handleTokenAccount({side:"out",amount:0,mint:p,tokenAccount:S,bypassAssociatedCheck:k}),{tokenAccount:F}=Y,N=ne(Y,["tokenAccount"]);return g.addInstruction(N),g.addInstruction({instructions:[Ki.ComputeBudgetProgram.requestUnits({units:4e5,additionalFee:0}),Ro({poolKeys:m,userKeys:{lpTokenAccount:b,baseTokenAccount:_,quoteTokenAccount:F,owner:this.scope.ownerPubKey},amountIn:r.raw})]}),await g.build()}lpMintToTokenAmount({poolId:e,amount:o,decimalDone:r}){let i=C({publicKey:e});i||this.logAndCreateError("pool not found");let a=this._poolInfoMap.get(i.toBase58()),u=ce(o),c=new J({mint:a.lpMint,decimals:a.lpDecimals}),m=r?new A(u.numerator,u.denominator):new A(u.numerator,u.denominator).mul(new we.default(10).pow(new we.default(c.decimals)));return new O(c,_e(m))}getFixedSide({poolId:e,inputMint:o}){let[r,i]=[C({publicKey:e}),C({publicKey:o})],a=this._poolInfoMap.get(r.toBase58());a||this.logAndCreateError("pool not found",r.toBase58());let u=a.baseMint===i.toBase58();return(i.equals(Re)||i.equals(U))&&(u=!u),u?"a":"b"}};var Go=require("@solana/web3.js"),St=require("lodash");var Oi=require("@solana/web3.js");var qi="routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS",et=new Oi.PublicKey(qi),Vo=["amm","serum","route"],Co=[xr,Vt,Re,Lr,Ir,_r,Rr,Sr,Mr].map(n=>n.toBase58());var xt=require("@solana/spl-token"),tt=require("@solana/web3.js");var At=R([D("instruction"),l("amountIn"),l("amountOut")]),It=R([D("instruction")]);var Fa=M("Raydium_route_instruction");function Wo(n){let{fixedSide:t}=n;if(t==="in")return[Fi(n),Ni(n)];throw Fa.logWithError("invalid params","params",n),new Error(`invalid params, params: ${n}`)}function Fi({fromPoolKeys:n,toPoolKeys:t,userKeys:e,amountIn:o,amountOut:r}){let i=Buffer.alloc(At.span),a;return n.version===4?(At.encode({instruction:0,amountIn:I(o),amountOut:I(r)},i),a=[s({pubkey:tt.SystemProgram.programId,isWritable:!1}),s({pubkey:xt.TOKEN_PROGRAM_ID,isWritable:!1}),s({pubkey:n.programId,isWritable:!1}),s({pubkey:n.id}),s({pubkey:t.id,isWritable:!1}),s({pubkey:n.authority,isWritable:!1}),s({pubkey:n.openOrders}),s({pubkey:n.baseVault}),s({pubkey:n.quoteVault}),s({pubkey:n.marketProgramId,isWritable:!1}),s({pubkey:n.marketId}),s({pubkey:n.marketBids}),s({pubkey:n.marketAsks}),s({pubkey:n.marketEventQueue}),s({pubkey:n.marketBaseVault}),s({pubkey:n.marketQuoteVault}),s({pubkey:n.marketAuthority,isWritable:!1}),s({pubkey:e.inTokenAccount}),s({pubkey:e.middleTokenAccount}),s({pubkey:e.middleStatusAccount}),s({pubkey:e.owner,isWritable:!1,isSigner:!0})]):(At.encode({instruction:2,amountIn:I(o),amountOut:I(r)},i),a=[s({pubkey:tt.SystemProgram.programId,isWritable:!1}),s({pubkey:xt.TOKEN_PROGRAM_ID,isWritable:!1}),s({pubkey:n.programId,isWritable:!1}),s({pubkey:n.id}),s({pubkey:t.id,isWritable:!1}),s({pubkey:n.authority,isWritable:!1}),s({pubkey:n.openOrders}),s({pubkey:n.baseVault}),s({pubkey:n.quoteVault}),s({pubkey:Pe,isWritable:!1}),s({pubkey:n.marketProgramId,isWritable:!1}),s({pubkey:n.marketId}),s({pubkey:n.marketBids}),s({pubkey:n.marketAsks}),s({pubkey:n.marketEventQueue}),s({pubkey:n.id}),s({pubkey:n.id}),s({pubkey:n.id}),s({pubkey:e.inTokenAccount}),s({pubkey:e.middleTokenAccount}),s({pubkey:e.middleStatusAccount}),s({pubkey:e.owner,isWritable:!1,isSigner:!0})]),new tt.TransactionInstruction({programId:et,keys:a,data:i})}function Ni({fromPoolKeys:n,toPoolKeys:t,userKeys:e}){let o=Buffer.alloc(It.span),r;return t.version===4?(It.encode({instruction:1},o),r=[s({pubkey:xt.TOKEN_PROGRAM_ID,isWritable:!1}),s({pubkey:t.programId,isWritable:!1}),s({pubkey:n.id,isWritable:!1}),s({pubkey:t.id}),s({pubkey:t.authority,isWritable:!1}),s({pubkey:t.openOrders}),s({pubkey:t.baseVault}),s({pubkey:t.quoteVault}),s({pubkey:t.marketProgramId,isWritable:!1}),s({pubkey:t.marketId}),s({pubkey:t.marketBids}),s({pubkey:t.marketAsks}),s({pubkey:t.marketEventQueue}),s({pubkey:t.marketBaseVault}),s({pubkey:t.marketQuoteVault}),s({pubkey:t.marketAuthority,isWritable:!1}),s({pubkey:e.middleTokenAccount}),s({pubkey:e.outTokenAccount}),s({pubkey:e.middleStatusAccount}),s({pubkey:e.owner,isWritable:!1,isSigner:!0})]):(It.encode({instruction:3},o),r=[s({pubkey:xt.TOKEN_PROGRAM_ID,isWritable:!1}),s({pubkey:t.programId,isWritable:!1}),s({pubkey:n.id,isWritable:!1}),s({pubkey:t.id}),s({pubkey:t.authority,isWritable:!1}),s({pubkey:t.openOrders}),s({pubkey:t.baseVault}),s({pubkey:t.quoteVault}),s({pubkey:Pe,isWritable:!1}),s({pubkey:t.marketProgramId,isWritable:!1}),s({pubkey:t.marketId}),s({pubkey:t.marketBids}),s({pubkey:t.marketAsks}),s({pubkey:t.marketEventQueue}),s({pubkey:t.id}),s({pubkey:t.id}),s({pubkey:t.id}),s({pubkey:e.middleTokenAccount}),s({pubkey:e.outTokenAccount}),s({pubkey:e.middleStatusAccount}),s({pubkey:e.owner,isWritable:!1,isSigner:!0})]),new tt.TransactionInstruction({programId:et,keys:r,data:o})}async function Uo({programId:n,fromPoolId:t,middleMint:e,owner:o}){let{publicKey:r}=await Ie([t.toBuffer(),e.toBuffer(),o.toBuffer()],n);return r}var Lt=class extends ie{constructor(t){super(t)}computeRouteAmountOut({fromPoolKeys:t,toPoolKeys:e,fromPoolInfo:o,toPoolInfo:r,amountIn:i,outputToken:a,slippage:u}){let{swap:c}=yn(o),{swap:m}=yn(r);(!c||!m)&&this.logAndCreateError("pools swap not enabled","pools",{fromPoolKeys:t,toPoolKeys:e,fromPoolInfo:o,toPoolInfo:r});let d=i.token,p=a;(!Ge(d,t)||!Ge(p,e))&&this.logAndCreateError("pools cannot be routed","pools",{fromPoolKeys:t,toPoolKeys:e});let y=[t.baseMint.toBase58(),t.quoteMint.toBase58()],f=[e.baseMint.toBase58(),e.quoteMint.toBase58()],b=[...y,...f],w=[o.baseDecimals,o.quoteDecimals,r.baseDecimals,r.quoteDecimals],[S,g]=[d.mint.toBase58(),p.mint.toBase58()],k=(0,St.xor)(y,f);(k.length!==2||!k.includes(S)||!k.includes(g))&&this.logAndCreateError("xor tokens not match","pools",{fromPoolKeys:t,toPoolKeys:e});let _=(0,St.intersection)(y,f);_.length!==1&&this.logAndCreateError("cannot found middle token of two pools","pools",{fromPoolKeys:t,toPoolKeys:e});let T=_[0],F=b.indexOf(T);F===-1&&this.logAndCreateError("cannot found middle token","pools",{fromPoolKeys:t,toPoolKeys:e});let N=w[F],v=new Go.PublicKey(T),Y=new J({mint:v,decimals:N});this.logInfo("from pool:",t),this.logInfo("to pool:",e),this.logInfo("intersection mints:",_),this.logInfo("xor mints:",k),this.logInfo("middleMint:",T);let{minAmountOut:E,priceImpact:G,fee:te}=this.scope.liquidity.computeAmountOut({poolKeys:t,poolInfo:o,amountIn:i,outputToken:Y,slippage:u}),{amountOut:Q,minAmountOut:oe,priceImpact:ae,fee:Le}=this.scope.liquidity.computeAmountOut({poolKeys:e,poolInfo:r,amountIn:E,outputToken:a,slippage:u}),de=null,[he,ye]=[i.raw,Q.raw];return!he.isZero()&&!ye.isZero()&&(de=new Z({baseToken:d,denominator:he,quoteToken:a,numerator:ye}),this.logDebug("executionPrice:",`1 ${d.symbol} \u2248 ${de.toFixed()} ${a.symbol}`),this.logDebug("executionPrice invert:",`1 ${a.symbol} \u2248 ${de.invert().toFixed()} ${d.symbol}`)),{amountOut:Q,minAmountOut:oe,executionPrice:de,priceImpact:G.add(ae),fee:[te,Le]}}async swapWithRoute(t){let{fromPoolKeys:e,toPoolKeys:o,amountIn:r,amountOut:i,fixedSide:a,config:u}=t;this.logDebug("amountIn:",r,"amountOut:",i),(r.isZero()||i.isZero())&&this.logAndCreateError("amounts must greater than zero","amounts",{amountIn:r.toFixed(),amountOut:i.toFixed()});let{account:c}=this.scope,{bypassAssociatedCheck:m=!1}=u||{},[d,p]=[r.token,i.token],y=await this.scope.account.getCreatedTokenAccount({mint:d.mint,associatedOnly:!1}),f=await this.scope.account.getCreatedTokenAccount({mint:p.mint}),b=[e.baseMint.toBase58(),e.quoteMint.toBase58()],w=[o.baseMint.toBase58(),o.quoteMint.toBase58()],g=(0,St.intersection)(b,w)[0],k=new Go.PublicKey(g),_=await this.scope.account.getCreatedTokenAccount({mint:k}),[T,F]=[r.raw,i.raw],N=this.createTxBuilder(),v=this.createTxBuilder(),de=await c.handleTokenAccount({side:"in",amount:T,mint:d.mint,tokenAccount:y,bypassAssociatedCheck:m,skipCloseAccount:!0}),{tokenAccount:Y}=de,E=ne(de,["tokenAccount"]);N.addInstruction(E);let he=await c.handleTokenAccount({side:"out",amount:0,mint:p.mint,tokenAccount:f,bypassAssociatedCheck:m,skipCloseAccount:!0}),{tokenAccount:G}=he,te=ne(he,["tokenAccount"]);N.addInstruction(te);let ye=await c.handleTokenAccount({side:"in",amount:0,mint:k,tokenAccount:_,bypassAssociatedCheck:m,skipCloseAccount:!0}),{tokenAccount:Q}=ye,oe=ne(ye,["tokenAccount"]);N.addInstruction(oe),v.addInstruction({instructions:Wo({fromPoolKeys:e,toPoolKeys:o,userKeys:{inTokenAccount:Y,outTokenAccount:G,middleTokenAccount:Q,middleStatusAccount:await Uo({programId:et,fromPoolId:e.id,middleMint:k,owner:this.scope.ownerPubKey}),owner:this.scope.ownerPubKey},amountIn:T,amountOut:F,fixedSide:a})});let ae=N.build();return await v.buildMultiTx({extraPreBuildData:[ae],extInfo:{amountOut:F}})}};var vi=require("@solana/web3.js"),$o=H(require("bn.js"));var gn=R([Ee("mintAuthorityOption"),h("mintAuthority"),l("supply"),D("decimals"),D("isInitialized"),Ee("freezeAuthorityOption"),h("freezeAuthority")]);function Jo(n,t){return n.sort((e,o)=>{let{official:r,unOfficial:i}=t,a=new Set(r),u=new Set(i),c=p=>a.has(p.mint)?1:u.has(p.mint)?2:3,m=c(e)-c(o),d=p=>!/^[a-zA-Z]/.test(p);if(m===0){let p=d(e.symbol),y=d(o.symbol);return p&&!y?1:!p&&y?-1:e.symbol.localeCompare(o.symbol)}else return m})}async function Na(n,t){try{if(!n)return;let e=await n.getAccountInfo(C({publicKey:t}));return!e||e.data.length!==gn.span?void 0:gn.decode(e.data)}catch{return}}var _t=class extends ie{constructor(e){super(e);this._tokens=[];this._tokenMap=new Map;this._tokenPrice=new Map;this._mintList={official:[],unOfficial:[],unNamed:[]}}async load(e){this.checkDisabled(),await this.scope.fetchTokens(e==null?void 0:e.forceUpdate),this._mintList={official:[],unOfficial:[],unNamed:[]},this._tokens=[],this._tokenMap=new Map;let{data:o}=this.scope.apiData.tokens||{data:{official:[],unOfficial:[],unNamed:[],blacklist:[]}},r=new Set(o.blacklist);[o.official,o.unOfficial,o.unNamed].forEach((i,a)=>{i.forEach(u=>{let c=["official","unOfficial","unNamed"][a];!r.has(u.mint)&&u.mint!==U.toBase58()&&(this._tokens.push(K(L({},u),{symbol:u.symbol||"",name:u.name||""})),this._mintList[c].push(u.mint))})}),this._mintList.official.push($e.mint.toBase58()),this._tokens=Jo(this._tokens,this._mintList),this._tokens.push(K(L({},$e),{mint:U.toBase58()})),this._tokens.forEach(i=>{this._tokenMap.set(i.mint,K(L({},i),{id:i.mint}))}),this._tokenMap.set($.mint,K(L({},$),{icon:$e.icon,id:"wsol"})),this._tokenMap.set(U.toBase58(),K(L({},$e),{mint:U.toBase58()}))}get allTokens(){return this._tokens}get allTokenMap(){return this._tokenMap}get tokenMints(){return this._mintList}get tokenPrices(){return this._tokenPrice}async fetchTokenPrices(e){let o=this.allTokens.filter(m=>{var d;return!!((d=m.extensions)!=null&&d.coingeckoId)&&m.mint!==vi.PublicKey.default.toBase58()}),r=o.map(m=>m.extensions.coingeckoId),i=await this.scope.api.getCoingeckoPrice(r),a=o.reduce((m,d)=>i[d.extensions.coingeckoId].usd?K(L({},m),{[d.mint]:ut({token:this._tokenMap.get(d.mint),numberPrice:i[d.extensions.coingeckoId].usd,decimalDone:!0})}):m,{}),u=e||await this.scope.api.getRaydiumTokenPrice(),c=Object.keys(u).reduce((m,d)=>this._tokenMap.get(d)?K(L({},m),{[d]:ut({token:this._tokenMap.get(d),numberPrice:u[d],decimalDone:!0})}):m,{});return this._tokenPrice=new Map([...Object.entries(a),...Object.entries(c)]),this._tokenPrice}mintToToken(e){let o=C({publicKey:e,transformSol:!0}),r=this.allTokenMap.get(o.toBase58());r||this.logAndCreateError("token not found, mint:",o.toBase58());let{decimals:i,name:a,symbol:u}=r;return new J({mint:e,decimals:i,name:a,symbol:u})}mintToTokenAmount({mint:e,amount:o,decimalDone:r}){let i=this.mintToToken(e);return r?new O(i,I(o)):new O(i,this.decimalAmount({mint:e,amount:o,decimalDone:r}))}decimalAmount({mint:e,amount:o}){let r=ce(o),i=this.mintToToken(e);return _e(new A(r.numerator,r.denominator).mul(new $o.default(10**i.decimals)))}uiAmount({mint:e,amount:o}){let r=ce(o),i=this.mintToToken(e);return i?new A(r.numerator,r.denominator).div(new $o.default(10**i.decimals)).toSignificant(i.decimals):""}};function jo(n){let t=[];for(let e=0;e<n.length;e++)for(let o=0;o<n.length;o++)e!=o&&t.push([n[e],n[o]]);return t}var Rt=class extends ie{async load(){this.checkDisabled(),await this.scope.fetchLiquidity()}async _getBestSwapPool({availablePools:t,officialPoolIdSet:e}){if(t.length===0)return;if(t.length===1)return t[0];let o=t.filter(a=>e.has(a.id));return o.length===1?o[0]:(await this.scope.liquidity.sdkParseJsonLiquidityInfo(o.length?o:t)).reduce((a,u)=>{let c=a.version===5,m=u.version===5;return c&&!m?a:!c&&m?u:Vr(Rn(a.lpSupply,10**a.lpDecimals),Rn(u.lpSupply,10**u.lpDecimals))?a:u}).jsonInfo}async getAvailablePools(t){this.checkDisabled();let{inputMint:e,outputMint:o}=t,[r,i]=[C({publicKey:e,transformSol:!0}).toBase58(),C({publicKey:o,transformSol:!0}).toBase58()],a=this.scope.liquidity.allPools.filter(p=>p.baseMint===r&&p.quoteMint===i||p.baseMint===i&&p.quoteMint===r),u=new Set([...Co,r,i]),c=new Set(JSON.parse(JSON.stringify([...u])));c.delete(r),c.delete(i);let m=this.scope.liquidity.allPools.filter(p=>{let y=u.has(p.baseMint)&&u.has(p.quoteMint),f=c.has(p.baseMint)&&c.has(p.quoteMint);return y&&!f}),d=await this._getBestSwapPool({availablePools:a,officialPoolIdSet:this.scope.liquidity.allPoolIdSet.official});return{availablePools:a,best:d,routedPools:m}}async getBestAmountOut({pools:t,amountIn:e,inputToken:o,outputToken:r,slippage:i,features:a}){if(this.checkDisabled(),!t){let{routedPools:_}=await this.getAvailablePools({inputMint:o.mint,outputMint:r.mint});t=_}let u=await this.scope.liquidity.sdkParseJsonLiquidityInfo(t||[]),c=(t||[]).map((_,T)=>({poolKeys:pe(_),poolInfo:u[T]})),m=a||Vo;this.logDebug("features:",m),c.length||this.logAndCreateError("please provide at least one source of trade or (inputMint & outputMint)",c);let d=[],p="amm",y=new O(o,e),f=new O(r,0),b=f,w=null,S=null,g=new re(ue),k=[];if(m.includes("amm"))for(let{poolKeys:_,poolInfo:T}of c)try{let{amountOut:F,minAmountOut:N,currentPrice:v,executionPrice:Y,priceImpact:E,fee:G}=this.scope.liquidity.computeAmountOut({poolKeys:_,poolInfo:T,amountIn:y,outputToken:r,slippage:i});F.gt(f)&&(console.log("amm",T),d=[{source:"amm",keys:_}],p="amm",f=F,b=N,w=v,S=Y,g=E,k=[G])}catch{}if(m.includes("route")){let _=jo(c);for(let T of _){if(T.length!==2)continue;let[F,N]=T,{poolKeys:v,poolInfo:Y}=F,{poolKeys:E,poolInfo:G}=N;try{let{amountOut:te,minAmountOut:Q,executionPrice:oe,priceImpact:ae,fee:Le}=this.scope.route.computeRouteAmountOut({fromPoolKeys:v,toPoolKeys:E,fromPoolInfo:Y,toPoolInfo:G,amountIn:y,outputToken:r,slippage:i});te.gt(f)&&(d=[{source:"amm",keys:v},{source:"amm",keys:E}],p="route",f=te,b=Q,S=oe,g=ae,k=Le)}catch{}}}return{routes:d,routeType:p,amountOut:f,minAmountOut:b,fixedSide:"in",currentPrice:w,executionPrice:S,priceImpact:g,fee:k}}async directSwap(t){this.checkDisabled();let{amountOut:e,amountIn:o,slippage:r,config:i}=t,a=o.token,u=e.token,{routes:c,routeType:m,minAmountOut:d}=await this.getBestAmountOut({inputToken:a,outputToken:u,amountIn:o.raw,slippage:r});return await this.swap({routes:c,routeType:m,amountIn:o,amountOut:d,fixedSide:"in",config:i})}async swap(t){this.checkDisabled(),this.scope.checkOwner();let{routes:e,routeType:o,amountIn:r,amountOut:i,fixedSide:a,config:u}=t;if(o==="amm"&&e.length===1)return await this.scope.liquidity.swapWithAMM({poolKeys:e[0].keys,amountIn:r,amountOut:i,fixedSide:a,config:u});if(o==="route"&&e.length===2)return await this.scope.route.swapWithRoute({fromPoolKeys:e[0].keys,toPoolKeys:e[1].keys,amountIn:r,amountOut:i,fixedSide:a,config:u});throw this.logAndCreateError("invalid routes with routeType","routes",{routeType:o,routes:e}),new Error("invalid routes with routeType")}async getWSolAccounts(){this.scope.checkOwner(),await this.scope.account.fetchWalletTokenAccounts();let t=this.scope.account.tokenAccounts.filter(e=>e.mint.equals(Re));return t.sort((e,o)=>e.isAssociated?1:o.isAssociated||e.amount.lt(o.amount)?-1:1),t}async unWrapWSol(t){let e=await this.getWSolAccounts(),o=this.createTxBuilder(),r=await xe({connection:this.scope.connection,owner:this.scope.ownerPubKey,payer:this.scope.ownerPubKey,amount:0});o.addInstruction(r);let i=I(t);for(let a=0;a<e.length;a++)i.gte(e[a].amount)?(o.addInstruction({instructions:[Ke({tokenAccount:e[a].publicKey,payer:this.scope.ownerPubKey,owner:this.scope.ownerPubKey})]}),i.sub(e[a].amount)):(o.addInstruction({instructions:[Ke({tokenAccount:e[a].publicKey,payer:this.scope.ownerPubKey,owner:this.scope.ownerPubKey})]}),Ve({destination:r.signers[0].publicKey,source:e[a].publicKey,amount:i,owner:this.scope.ownerPubKey}));return o.build()}async wrapWSol(t){let e=await this.getWSolAccounts(),o=this.createTxBuilder(),r=await xe({connection:this.scope.connection,owner:this.scope.ownerPubKey,payer:this.scope.ownerPubKey,amount:t,skipCloseAccount:!0});return o.addInstruction(r),e.length&&o.addInstruction({instructions:[Ve({destination:e[0].publicKey,source:r.signers[0].publicKey,amount:t,owner:this.scope.ownerPubKey})],endInstructions:[Ke({tokenAccount:r.signers[0].publicKey,payer:this.scope.ownerPubKey,owner:this.scope.ownerPubKey})]}),o.build()}};var Fe={},Mt=class{constructor(t){this.rawBalances=new Map;let{connection:e,cluster:o,owner:r,api:i,defaultApiTokens:a,defaultApiLiquidityPools:u,defaultApiFarmPools:c,defaultApiPairsInfo:m,apiCacheTime:d}=t;this._connection=e,this.cluster=o,this._owner=r?new fe(r):void 0,this._signAllTransactions=t.signAllTransactions,this.api=i,this._apiCacheTime=d||5*60*1e3,this.logger=M("Raydium"),this.farm=new ht({scope:this,moduleName:"Raydium_Farm"}),this.account=new bt({scope:this,moduleName:"Raydium_Account",tokenAccounts:t.tokenAccounts,tokenAccountRawInfos:t.tokenAccountRawInfos}),this.liquidity=new Tt({scope:this,moduleName:"Raydium_Liquidity"}),this.token=new _t({scope:this,moduleName:"Raydium_token"}),this.trade=new Rt({scope:this,moduleName:"Raydium_trade"}),this.route=new Lt({scope:this,moduleName:"Raydium_route"});let p=new Date().getTime(),[y,f,b,w]=[a?{fetched:p,data:a}:Fe.tokens,u?{fetched:p,data:u}:Fe.liquidityPools,c?{fetched:p,data:c}:Fe.farmPools,m?{fetched:p,data:m}:Fe.liquidityPairsInfo];this.apiData=L(L(L(L({},y?{tokens:y}:{}),f?{liquidityPools:f}:{}),b?{farmPools:b}:{}),w?{liquidityPairsInfo:w}:{})}static async load(t){let e=(0,Di.merge)({cluster:"mainnet",owner:null,apiRequestInterval:3e5,apiRequestTimeout:1e4},t),{cluster:o,apiRequestTimeout:r}=e,i=new Jt({cluster:o,timeout:r}),a=new Mt(K(L({},e),{api:i}));return await a.token.load(),await a.liquidity.load(),a}get owner(){return this._owner}get ownerPubKey(){if(!this._owner)throw new Error($t);return this._owner.publicKey}setOwner(t){return this._owner=t?new fe(t):void 0,this}get connection(){if(!this._connection)throw new Error($r);return this._connection}setConnection(t){return this._connection=t,this}get signAllTransactions(){return this._signAllTransactions}setSignAllTransactions(t){return this._signAllTransactions=t,this}checkOwner(){if(!this.owner)throw this.logger.error($t),new Error($t)}isCacheInvalidate(t){return new Date().getTime()-t>this._apiCacheTime}async fetchTokens(t){if(this.apiData.tokens&&!this.isCacheInvalidate(this.apiData.tokens.fetched)&&!t)return this.apiData.tokens.data;let e={fetched:Date.now(),data:await this.api.getTokens()};return this.apiData.tokens=e,Fe.tokens=e,e.data}async fetchLiquidity(t){if(this.apiData.liquidityPools&&!this.isCacheInvalidate(this.apiData.liquidityPools.fetched)&&!t)return this.apiData.liquidityPools.data;let e={fetched:Date.now(),data:await this.api.getLiquidityPools()};return this.apiData.liquidityPools=e,Fe.liquidityPools=e,e.data}async fetchPairs(t){var o;if(this.apiData.liquidityPairsInfo&&!this.isCacheInvalidate(this.apiData.liquidityPairsInfo.fetched)&&!t)return((o=this.apiData.liquidityPairsInfo)==null?void 0:o.data)||[];let e={fetched:Date.now(),data:await this.api.getPairsInfo()};return this.apiData.liquidityPairsInfo=e,Fe.liquidityPairsInfo=e,e.data}async fetchFarms(t){if(this.apiData.farmPools&&!this.isCacheInvalidate(this.apiData.farmPools.fetched)&&!t)return this.apiData.farmPools.data;let e={fetched:Date.now(),data:await this.api.getFarmPools()};return this.apiData.farmPools=e,Fe.farmPools=e,e.data}async chainTimeOffset(){let t=await this.connection.getBlockTime(await this.connection.getSlot());return t?(t*1e3,Number((t*1e3-Date.now()).toFixed(0))):0}mintToToken(t){return this.token.mintToToken(t)}mintToTokenAmount(t){return this.token.mintToTokenAmount(t)}decimalAmount(t){return this.token.decimalAmount(t)}uiAmount(t){return this.token.uiAmount(t)}};var va=n=>n;0&&(module.exports={DataElement,FARM_LOCK_MINT,FARM_LOCK_VAULT,FARM_PROGRAMID_TO_VERSION,FARM_PROGRAM_ID_V3,FARM_PROGRAM_ID_V3_PUBKEY,FARM_PROGRAM_ID_V5,FARM_PROGRAM_ID_V5_PUBKEY,FARM_PROGRAM_ID_V6,FARM_PROGRAM_ID_V6_PUBKEY,FARM_VERSION_TO_LEDGER_LAYOUT,FARM_VERSION_TO_PROGRAMID,FARM_VERSION_TO_STATE_LAYOUT,LIQUIDITY_FEES_DENOMINATOR,LIQUIDITY_FEES_NUMERATOR,LIQUIDITY_PROGRAMID_TO_VERSION,LIQUIDITY_PROGRAM_ID_V4,LIQUIDITY_PROGRAM_ID_V5,LIQUIDITY_VERSION_TO_PROGRAM_ID,LIQUIDITY_VERSION_TO_SERUM_VERSION,LIQUIDITY_VERSION_TO_STATE_LAYOUT,LiquidityPoolStatus,MODEL_DATA_PUBKEY,ROUTE_PROGRAM_ID_V1,Raydium,SERUM_PROGRAMID_TO_VERSION,SERUM_PROGRAM_ID_V3,SERUM_VERSION_TO_PROGRAM_ID,SPL_MINT_LAYOUT,StableLayout,TOKEN_SOL,TOKEN_WSOL,_LIQUIDITY_PROGRAM_ID_V4,_LIQUIDITY_PROGRAM_ID_V5,_ROUTE_PROGRAM_ID_V1,_SERUM_PROGRAM_ID_V3,addLiquidityLayout,associatedLedgerAccountLayout,calFarmRewardAmount,calculateFarmPoolAprList,closeAccountInstruction,createAssociatedLedgerAccountInstruction,createPoolV4Layout,createWSolAccountInstructions,defaultRoutes,dwLayout,farmAddRewardLayout,farmDespotVersionToInstruction,farmLedgerLayoutV3_1,farmLedgerLayoutV3_2,farmLedgerLayoutV5_1,farmLedgerLayoutV5_2,farmLedgerLayoutV6_1,farmRewardInfoToConfig,farmRewardLayout,farmRewardRestartLayout,farmRewardTimeInfoLayout,farmStateV3Layout,farmStateV5Layout,farmStateV6Layout,farmWithdrawVersionToInstruction,fetchMultipleFarmInfoAndUpdate,fixedSwapInLayout,fixedSwapOutLayout,formatLayout,getAmountSide,getAmountsSide,getAssociatedAuthority,getAssociatedLedgerAccount,getAssociatedLedgerPoolAccount,getAssociatedMiddleStatusAccount,getAssociatedPoolKeys,getDxByDyBaseIn,getDyByDxBaseIn,getFarmLedgerLayout,getFarmProgramId,getFarmStateLayout,getFarmVersion,getLiquidityAssociatedAuthority,getLiquidityAssociatedId,getLiquidityInfo,getLiquidityProgramId,getLiquidityStateLayout,getPoolEnabledFeatures,getSPLTokenInfo,getSerumAssociatedAuthority,getSerumProgramId,getSerumVersion,getStablePrice,getTokenSide,getTokensSide,groupPools,includesToken,initPoolLayout,initTokenAccountInstruction,isValidFarmVersion,isValidFixedSide,judgeFarmType,liquidityStateV4Layout,liquidityStateV5Layout,makeAMMSwapInstruction,makeAddLiquidityInstruction,makeCreateFarmInstruction,makeCreatePoolInstruction,makeInitPoolInstruction,makeRemoveLiquidityInstruction,makeRouteSwapInstruction,makeSimulatePoolInfoInstruction,makeSimulationPoolInfo,makeSwapFixedInInstruction,makeSwapFixedOutInstruction,makeSwapInFixedInInstruction,makeSwapOutFixedInInstruction,makeTransferInstruction,mergeSdkFarmInfo,modelDataInfoLayout,parseTokenAccountResp,poolTypeV6,quantumSOLHydratedTokenJsonInfo,realFarmStateV3Layout,realFarmStateV5Layout,realFarmV6Layout,removeLiquidityLayout,routeSwapInLayout,routeSwapOutLayout,sortTokens,splAccountLayout,swapRouteMiddleMints,unionArr,updateFarmPoolInfo,validateFarmRewards,whetherIsStakeFarmPool,withdrawRewardLayout});
//# sourceMappingURL=index.js.map