import{TOKEN_PROGRAM_ID as E}from"@solana/spl-token";import{SystemProgram as pe,TransactionInstruction as de}from"@solana/web3.js";import m from"bn.js";import Le from"big.js";import it from"bn.js";import{get as q,set as le}from"lodash";import j from"dayjs";import be from"dayjs/plugin/utc";j.extend(be);var D=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:3,this.name=e.name}set level(e){this.logLevel=e}get time(){return j().utc().format("YYYY/MM/DD HH:mm:ss UTC")}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let r=e.map(o=>typeof o=="object"?JSON.stringify(o):o).join(", ");throw new Error(r)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},V={},fe={};function b(n){let e=q(V,n);if(!e){let r=q(fe,n);e=new D({name:n,logLevel:r}),le(V,n,e)}return e}import ge from"toformat";var ye=ge,h=ye;import w from"big.js";import xe from"decimal.js-light";var S=b("module/fraction"),_=h(w),k=h(xe),he={[0]:k.ROUND_DOWN,[1]:k.ROUND_HALF_UP,[2]:k.ROUND_UP},ke={[0]:w.roundDown,[1]:w.roundHalfUp,[2]:w.roundUp},i=class{constructor(e,r=Y){this.numerator=p(e),this.denominator=p(r)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new i(this.denominator,this.numerator)}add(e){let r=e instanceof i?e:new i(p(e));return this.denominator.eq(r.denominator)?new i(this.numerator.add(r.numerator),this.denominator):new i(this.numerator.mul(r.denominator).add(r.numerator.mul(this.denominator)),this.denominator.mul(r.denominator))}sub(e){let r=e instanceof i?e:new i(p(e));return this.denominator.eq(r.denominator)?new i(this.numerator.sub(r.numerator),this.denominator):new i(this.numerator.mul(r.denominator).sub(r.numerator.mul(this.denominator)),this.denominator.mul(r.denominator))}mul(e){let r=e instanceof i?e:new i(p(e));return new i(this.numerator.mul(r.numerator),this.denominator.mul(r.denominator))}div(e){let r=e instanceof i?e:new i(p(e));return new i(this.numerator.mul(r.denominator),this.denominator.mul(r.numerator))}toSignificant(e,r={groupSeparator:""},o=1){Number.isInteger(e)||S.logWithError(`${e} is not an integer.`),e<=0&&S.logWithError(`${e} is not positive.`),k.set({precision:e+1,rounding:he[o]});let u=new k(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return u.toFormat(u.decimalPlaces(),r)}toFixed(e,r={groupSeparator:""},o=1){return Number.isInteger(e)||S.logWithError(`${e} is not an integer.`),e<0&&S.logWithError(`${e} is negative.`),_.DP=e,_.RM=ke[o]||1,new _(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,r)}isZero(){return this.numerator.isZero()}};var lt=b("Raydium_amount"),bt=h(Le);import{PublicKey as we}from"@solana/web3.js";var H={symbol:"SOL",name:"Solana",decimals:9},g={symbol:"WSOL",name:"Wrapped SOL",mint:"So11111111111111111111111111111111111111112",decimals:9,extensions:{coingeckoId:"solana"}},yt={isQuantumSOL:!0,isLp:!1,official:!0,mint:new we(g.mint),decimals:9,symbol:"SOL",id:"sol",name:"solana",icon:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",extensions:{coingeckoId:"solana"}};import{PublicKey as U}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Be}from"@solana/spl-token";import{PublicKey as c,SystemProgram as Te,SYSVAR_RENT_PUBKEY as Ne}from"@solana/web3.js";function t({pubkey:n,isSigner:e=!1,isWritable:r=!0}){return{pubkey:n,isWritable:r,isSigner:e}}var Lt=[t({pubkey:Be,isWritable:!1}),t({pubkey:Te.programId,isWritable:!1}),t({pubkey:Ne,isWritable:!1})];function X({publicKey:n,transformSol:e}){if(n instanceof c)return e&&n.equals(P)?B:n;if(e&&n===P.toBase58())return B;if(typeof n=="string")try{return new c(n)}catch{throw new Error("invalid public key")}throw new Error("invalid public key")}var G=new c("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),z=new c("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),St=new c("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),Z=new c("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),J=new c("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),$=new c("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),Q=new c("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),K=new c("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),wt=new c("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),Bt=new c("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),ee=new c("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),B=new c("So11111111111111111111111111111111111111112"),P=c.default;var I=class{constructor({mint:e,decimals:r,symbol:o="UNKNOWN",name:u="UNKNOWN",skipMint:d=!1}){if(e===P.toBase58()||e instanceof U&&P.equals(e)){this.decimals=g.decimals,this.symbol=g.symbol,this.name=g.name,this.mint=new U(g.mint);return}this.decimals=r,this.symbol=o,this.name=u,this.mint=d?U.default:X({publicKey:e})}equals(e){return this===e?!0:this.mint.equals(e.mint)}},L=I;L.WSOL=new I(g);var M=class{constructor({decimals:e,symbol:r="UNKNOWN",name:o="UNKNOWN"}){this.decimals=e,this.symbol=r,this.name=o}equals(e){return this===e}},R=M;R.SOL=new M(H);var vt=new i(te);var Ht=b("Raydium_price");var T=b("Raydium_bignumber");var mn=new m(0),Y=new m(1),pn=new m(2),dn=new m(3),ln=new m(5),Se=new m(10),te=new m(100),bn=new m(1e3),fn=new m(1e4),ne=9007199254740991;function p(n){if(n instanceof m)return n;if(typeof n=="string"){if(n.match(/^-?[0-9]+$/))return new m(n);T.logWithError(`invalid BigNumberish string: ${n}`)}return typeof n=="number"?(n%1&&T.logWithError(`BigNumberish number underflow: ${n}`),(n>=ne||n<=-ne)&&T.logWithError(`BigNumberish number overflow: ${n}`),new m(String(n))):typeof n=="bigint"?new m(n.toString()):(T.logWithError(`invalid BigNumberish value: ${n}`),new m(0))}import{PublicKey as Re}from"@solana/web3.js";import{PublicKey as br}from"@solana/web3.js";import ae,{isBN as ce}from"bn.js";import{bits as xn,BitStructure as hn,blob as Ee,Blob as kn,cstr as Pn,f32 as Ln,f32be as Sn,f64 as wn,f64be as Bn,greedy as Tn,Layout as De,ns64 as Nn,ns64be as Wn,nu64 as En,nu64be as Dn,offset as _n,s16 as Un,s16be as In,s24 as Rn,s24be as Mn,s32 as On,s32be as An,s40 as vn,s40be as Fn,s48 as Cn,s48be as qn,s8 as Vn,seq as _e,struct as jn,Structure as Ue,u16 as Yn,u16be as Hn,u24 as Xn,u24be as Gn,u32 as zn,u32be as Zn,u40 as Jn,u40be as $n,u48 as Qn,u48be as Kn,u8 as er,UInt as Ie,union as tr,Union as nr,unionLayoutDiscriminator as rr,utf8 as or}from"@solana/buffer-layout";var re=De,oe=Ue;var ie=Ie;var ue=_e;var se=Ee;var O=class extends re{constructor(r,o,u){super(r,u);this.blob=se(r),this.signed=o}decode(r,o=0){let u=new ae(this.blob.decode(r,o),10,"le");return this.signed?u.fromTwos(this.span*8).clone():u}encode(r,o,u=0){return typeof r=="number"&&(r=new ae(r)),this.signed&&(r=r.toTwos(this.span*8)),this.blob.encode(r.toArrayLike(Buffer,"le",this.span),o,u)}};function v(n){return new ie(1,n)}function l(n){return new O(8,!1,n)}var A=class extends oe{decode(e,r){return super.decode(e,r)}};function x(n,e,r){return new A(n,e,r)}function me(n,e,r){let o,u=typeof e=="number"?e:ce(e)?e.toNumber():new Proxy(e,{get(d,f){if(!o){let y=Reflect.get(d,"count");o=ce(y)?y.toNumber():y,Reflect.set(d,"count",o)}return Reflect.get(d,f)},set(d,f,y){return f==="count"&&(o=y),Reflect.set(d,f,y)}});return ue(n,u,r)}var F=new Re("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Me=5e4,Oe=x([l("x"),l("y"),l("price")]),Lr=x([l("accountType"),l("status"),l("multiplier"),l("validDataCount"),me(Oe,Me,"DataElement")]);import{PublicKey as Ae}from"@solana/web3.js";var ve="routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS",C=new Ae(ve);var Tr=[Z,G,B,$,z,Q,K,J,ee].map(n=>n.toBase58());var N=x([v("instruction"),l("amountIn"),l("amountOut")]),W=x([v("instruction")]);var Fe=b("Raydium_route_instruction");function vr(n){let{fixedSide:e}=n;if(e==="in")return[Ce(n),qe(n)];throw Fe.logWithError("invalid params","params",n),new Error(`invalid params, params: ${n}`)}function Ce({fromPoolKeys:n,toPoolKeys:e,userKeys:r,amountIn:o,amountOut:u}){let d=Buffer.alloc(N.span),f;return n.version===4?(N.encode({instruction:0,amountIn:p(o),amountOut:p(u)},d),f=[t({pubkey:pe.programId,isWritable:!1}),t({pubkey:E,isWritable:!1}),t({pubkey:n.programId,isWritable:!1}),t({pubkey:n.id}),t({pubkey:e.id,isWritable:!1}),t({pubkey:n.authority,isWritable:!1}),t({pubkey:n.openOrders}),t({pubkey:n.baseVault}),t({pubkey:n.quoteVault}),t({pubkey:n.marketProgramId,isWritable:!1}),t({pubkey:n.marketId}),t({pubkey:n.marketBids}),t({pubkey:n.marketAsks}),t({pubkey:n.marketEventQueue}),t({pubkey:n.marketBaseVault}),t({pubkey:n.marketQuoteVault}),t({pubkey:n.marketAuthority,isWritable:!1}),t({pubkey:r.inTokenAccount}),t({pubkey:r.middleTokenAccount}),t({pubkey:r.middleStatusAccount}),t({pubkey:r.owner,isWritable:!1,isSigner:!0})]):(N.encode({instruction:2,amountIn:p(o),amountOut:p(u)},d),f=[t({pubkey:pe.programId,isWritable:!1}),t({pubkey:E,isWritable:!1}),t({pubkey:n.programId,isWritable:!1}),t({pubkey:n.id}),t({pubkey:e.id,isWritable:!1}),t({pubkey:n.authority,isWritable:!1}),t({pubkey:n.openOrders}),t({pubkey:n.baseVault}),t({pubkey:n.quoteVault}),t({pubkey:F,isWritable:!1}),t({pubkey:n.marketProgramId,isWritable:!1}),t({pubkey:n.marketId}),t({pubkey:n.marketBids}),t({pubkey:n.marketAsks}),t({pubkey:n.marketEventQueue}),t({pubkey:n.id}),t({pubkey:n.id}),t({pubkey:n.id}),t({pubkey:r.inTokenAccount}),t({pubkey:r.middleTokenAccount}),t({pubkey:r.middleStatusAccount}),t({pubkey:r.owner,isWritable:!1,isSigner:!0})]),new de({programId:C,keys:f,data:d})}function qe({fromPoolKeys:n,toPoolKeys:e,userKeys:r}){let o=Buffer.alloc(W.span),u;return e.version===4?(W.encode({instruction:1},o),u=[t({pubkey:E,isWritable:!1}),t({pubkey:e.programId,isWritable:!1}),t({pubkey:n.id,isWritable:!1}),t({pubkey:e.id}),t({pubkey:e.authority,isWritable:!1}),t({pubkey:e.openOrders}),t({pubkey:e.baseVault}),t({pubkey:e.quoteVault}),t({pubkey:e.marketProgramId,isWritable:!1}),t({pubkey:e.marketId}),t({pubkey:e.marketBids}),t({pubkey:e.marketAsks}),t({pubkey:e.marketEventQueue}),t({pubkey:e.marketBaseVault}),t({pubkey:e.marketQuoteVault}),t({pubkey:e.marketAuthority,isWritable:!1}),t({pubkey:r.middleTokenAccount}),t({pubkey:r.outTokenAccount}),t({pubkey:r.middleStatusAccount}),t({pubkey:r.owner,isWritable:!1,isSigner:!0})]):(W.encode({instruction:3},o),u=[t({pubkey:E,isWritable:!1}),t({pubkey:e.programId,isWritable:!1}),t({pubkey:n.id,isWritable:!1}),t({pubkey:e.id}),t({pubkey:e.authority,isWritable:!1}),t({pubkey:e.openOrders}),t({pubkey:e.baseVault}),t({pubkey:e.quoteVault}),t({pubkey:F,isWritable:!1}),t({pubkey:e.marketProgramId,isWritable:!1}),t({pubkey:e.marketId}),t({pubkey:e.marketBids}),t({pubkey:e.marketAsks}),t({pubkey:e.marketEventQueue}),t({pubkey:e.id}),t({pubkey:e.id}),t({pubkey:e.id}),t({pubkey:r.middleTokenAccount}),t({pubkey:r.outTokenAccount}),t({pubkey:r.middleStatusAccount}),t({pubkey:r.owner,isWritable:!1,isSigner:!0})]),new de({programId:C,keys:u,data:o})}export{vr as makeRouteSwapInstruction,Ce as makeSwapInFixedInInstruction,qe as makeSwapOutFixedInInstruction};
//# sourceMappingURL=instruction.mjs.map