var Le=Object.create;var _=Object.defineProperty;var Ne=Object.getOwnPropertyDescriptor;var We=Object.getOwnPropertyNames;var Ie=Object.getPrototypeOf,Ee=Object.prototype.hasOwnProperty;var De=(t,e)=>{for(var r in e)_(t,r,{get:e[r],enumerable:!0})},z=(t,e,r,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of We(e))!Ee.call(t,s)&&s!==r&&_(t,s,{get:()=>e[s],enumerable:!(i=Ne(e,s))||i.enumerable});return t};var f=(t,e,r)=>(r=t!=null?Le(Ie(t)):{},z(e||!t||!t.__esModule?_(r,"default",{value:t,enumerable:!0}):r,t)),_e=t=>z(_({},"__esModule",{value:!0}),t);var Je={};De(Je,{ROUTE_PROGRAM_ID_V1:()=>R,_ROUTE_PROGRAM_ID_V1:()=>oe,defaultRoutes:()=>Ae,getAssociatedMiddleStatusAccount:()=>qe,makeRouteSwapInstruction:()=>Ge,makeSwapInFixedInInstruction:()=>we,makeSwapOutFixedInInstruction:()=>Be,routeSwapInLayout:()=>T,routeSwapOutLayout:()=>w,swapRouteMiddleMints:()=>Re});module.exports=_e(Je);var re=require("@solana/web3.js");var K=require("@solana/spl-token"),c=require("@solana/web3.js");function n({pubkey:t,isSigner:e=!1,isWritable:r=!0}){return{pubkey:t,isWritable:r,isSigner:e}}var et=[n({pubkey:K.TOKEN_PROGRAM_ID,isWritable:!1}),n({pubkey:c.SystemProgram.programId,isWritable:!1}),n({pubkey:c.SYSVAR_RENT_PUBKEY,isWritable:!1})];function $({publicKey:t,transformSol:e}){if(t instanceof c.PublicKey)return e&&t.equals(S)?A:t;if(e&&t===S.toBase58())return A;if(typeof t=="string")try{return new c.PublicKey(t)}catch{throw new Error("invalid public key")}throw new Error("invalid public key")}var X=new c.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),G=new c.PublicKey("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),tt=new c.PublicKey("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),J=new c.PublicKey("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),Z=new c.PublicKey("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),Q=new c.PublicKey("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),ee=new c.PublicKey("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),te=new c.PublicKey("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),nt=new c.PublicKey("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),rt=new c.PublicKey("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),ne=new c.PublicKey("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),A=new c.PublicKey("So11111111111111111111111111111111111111112"),S=c.PublicKey.default;var oe="routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS",R=new re.PublicKey(oe),Ae=["amm","serum","route"],Re=[J,X,A,Q,G,ee,te,Z,ne].map(t=>t.toBase58());var Oe=require("@solana/web3.js"),h=f(require("bn.js"));var o=require("@solana/buffer-layout"),ie=o.Layout,se=o.Structure;var ae=o.UInt;var ue=o.seq;var ce=o.blob;var C=class extends ie{constructor(r,i,s){super(r,s);this.blob=ce(r),this.signed=i}decode(r,i=0){let s=new h.default(this.blob.decode(r,i),10,"le");return this.signed?s.fromTwos(this.span*8).clone():s}encode(r,i,s=0){return typeof r=="number"&&(r=new h.default(r)),this.signed&&(r=r.toTwos(this.span*8)),this.blob.encode(r.toArrayLike(Buffer,"le",this.span),i,s)}};function q(t){return new ae(1,t)}function b(t){return new C(8,!1,t)}var F=class extends se{decode(e,r){return super.decode(e,r)}};function P(t,e,r){return new F(t,e,r)}function me(t,e,r){let i,s=typeof e=="number"?e:(0,h.isBN)(e)?e.toNumber():new Proxy(e,{get(d,g){if(!i){let x=Reflect.get(d,"count");i=(0,h.isBN)(x)?x.toNumber():x,Reflect.set(d,"count",i)}return Reflect.get(d,g)},set(d,g,x){return g==="count"&&(i=x),Reflect.set(d,g,x)}});return ue(t,s,r)}var T=P([q("instruction"),b("amountIn"),b("amountOut")]),w=P([q("instruction")]);var L=require("@solana/web3.js");var B=require("lodash"),le=f(require("pino")),de=f(require("pino-pretty")),pe={},Me={},Ce=(0,de.default)({colorize:!0,levelFirst:!0,translateTime:"SYS:yyyymmdd HH:MM:ss.l"}),Fe=(0,le.default)({base:null,level:"silent"},Ce);function l(t){let e=(0,B.get)(pe,t);if(!e){let r=(0,B.get)(Me,t);e=Fe.child({name:t},{level:r}),(0,B.set)(pe,t,e)}return e.logWithError=(...r)=>{let i=r.map(s=>typeof s=="object"?JSON.stringify(s):s).join(", ");throw new Error(i)},e}var It=l("Raydium_txTool");async function be(t,e){let[r,i]=await L.PublicKey.findProgramAddress(t,e);return{publicKey:r,nonce:i}}async function qe({programId:t,fromPoolId:e,middleMint:r,owner:i}){let{publicKey:s}=await be([e.toBuffer(),r.toBuffer(),i.toBuffer()],t);return s}var D=require("@solana/spl-token"),k=require("@solana/web3.js");var m=f(require("bn.js"));var xe=f(require("big.js")),He=f(require("bn.js"));var fe=f(require("toformat")),ve=fe.default,N=ve;var W=f(require("big.js")),ge=f(require("decimal.js-light"));var U=l("module/fraction"),v=N(W.default),I=N(ge.default),Ve={[0]:I.ROUND_DOWN,[1]:I.ROUND_HALF_UP,[2]:I.ROUND_UP},je={[0]:W.default.roundDown,[1]:W.default.roundHalfUp,[2]:W.default.roundUp},a=class{constructor(e,r=ye){this.numerator=p(e),this.denominator=p(r)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new a(this.denominator,this.numerator)}add(e){let r=e instanceof a?e:new a(p(e));return this.denominator.eq(r.denominator)?new a(this.numerator.add(r.numerator),this.denominator):new a(this.numerator.mul(r.denominator).add(r.numerator.mul(this.denominator)),this.denominator.mul(r.denominator))}sub(e){let r=e instanceof a?e:new a(p(e));return this.denominator.eq(r.denominator)?new a(this.numerator.sub(r.numerator),this.denominator):new a(this.numerator.mul(r.denominator).sub(r.numerator.mul(this.denominator)),this.denominator.mul(r.denominator))}mul(e){let r=e instanceof a?e:new a(p(e));return new a(this.numerator.mul(r.numerator),this.denominator.mul(r.denominator))}div(e){let r=e instanceof a?e:new a(p(e));return new a(this.numerator.mul(r.denominator),this.denominator.mul(r.numerator))}toSignificant(e,r={groupSeparator:""},i=1){Number.isInteger(e)||U.logWithError(`${e} is not an integer.`),e<=0&&U.logWithError(`${e} is not positive.`),I.set({precision:e+1,rounding:Ve[i]});let s=new I(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return s.toFormat(s.decimalPlaces(),r)}toFixed(e,r={groupSeparator:""},i=1){return Number.isInteger(e)||U.logWithError(`${e} is not an integer.`),e<0&&U.logWithError(`${e} is negative.`),v.DP=e,v.RM=je[i]||1,new v(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,r)}isZero(){return this.numerator.isZero()}};var Kt=l("Raydium_amount"),$t=N(xe.default);var he=require("@solana/web3.js"),Pe={symbol:"SOL",name:"Solana",decimals:9},y={symbol:"WSOL",name:"Wrapped SOL",mint:"So11111111111111111111111111111111111111112",decimals:9,extensions:{coingeckoId:"solana"}},Gt={isQuantumSOL:!0,isLp:!1,official:!0,mint:new he.PublicKey(y.mint),decimals:9,symbol:"SOL",id:"sol",name:"solana",icon:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",extensions:{coingeckoId:"solana"}};var O=require("@solana/web3.js");var V=class{constructor({mint:e,decimals:r,symbol:i="UNKNOWN",name:s="UNKNOWN",skipMint:d=!1}){if(e===S.toBase58()||e instanceof O.PublicKey&&S.equals(e)){this.decimals=y.decimals,this.symbol=y.symbol,this.name=y.name,this.mint=new O.PublicKey(y.mint);return}this.decimals=r,this.symbol=i,this.name=s,this.mint=d?O.PublicKey.default:$({publicKey:e})}equals(e){return this===e?!0:this.mint.equals(e.mint)}},E=V;E.WSOL=new V(y);var Y=class{constructor({decimals:e,symbol:r="UNKNOWN",name:i="UNKNOWN"}){this.decimals=e,this.symbol=r,this.name=i}equals(e){return this===e}},j=Y;j.SOL=new Y(Pe);var cn=new a(ke);var gn=l("Raydium_price");var M=l("Raydium_bignumber");var An=new m.default(0),ye=new m.default(1),Rn=new m.default(2),Un=new m.default(3),On=new m.default(5),ze=new m.default(10),ke=new m.default(100),Mn=new m.default(1e3),Cn=new m.default(1e4),Se=9007199254740991;function p(t){if(t instanceof m.default)return t;if(typeof t=="string"){if(t.match(/^-?[0-9]+$/))return new m.default(t);M.logWithError(`invalid BigNumberish string: ${t}`)}return typeof t=="number"?(t%1&&M.logWithError(`BigNumberish number underflow: ${t}`),(t>=Se||t<=-Se)&&M.logWithError(`BigNumberish number overflow: ${t}`),new m.default(String(t))):typeof t=="bigint"?new m.default(t.toString()):(M.logWithError(`invalid BigNumberish value: ${t}`),new m.default(0))}var Te=require("@solana/web3.js");var H=new Te.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Ke=5e4,$e=P([b("x"),b("y"),b("price")]),Vn=P([b("accountType"),b("status"),b("multiplier"),b("validDataCount"),me($e,Ke,"DataElement")]);var Xe=l("Raydium_route_instruction");function Ge(t){let{fixedSide:e}=t;if(e==="in")return[we(t),Be(t)];throw Xe.logWithError("invalid params","params",t),new Error(`invalid params, params: ${t}`)}function we({fromPoolKeys:t,toPoolKeys:e,userKeys:r,amountIn:i,amountOut:s}){let d=Buffer.alloc(T.span),g;return t.version===4?(T.encode({instruction:0,amountIn:p(i),amountOut:p(s)},d),g=[n({pubkey:k.SystemProgram.programId,isWritable:!1}),n({pubkey:D.TOKEN_PROGRAM_ID,isWritable:!1}),n({pubkey:t.programId,isWritable:!1}),n({pubkey:t.id}),n({pubkey:e.id,isWritable:!1}),n({pubkey:t.authority,isWritable:!1}),n({pubkey:t.openOrders}),n({pubkey:t.baseVault}),n({pubkey:t.quoteVault}),n({pubkey:t.marketProgramId,isWritable:!1}),n({pubkey:t.marketId}),n({pubkey:t.marketBids}),n({pubkey:t.marketAsks}),n({pubkey:t.marketEventQueue}),n({pubkey:t.marketBaseVault}),n({pubkey:t.marketQuoteVault}),n({pubkey:t.marketAuthority,isWritable:!1}),n({pubkey:r.inTokenAccount}),n({pubkey:r.middleTokenAccount}),n({pubkey:r.middleStatusAccount}),n({pubkey:r.owner,isWritable:!1,isSigner:!0})]):(T.encode({instruction:2,amountIn:p(i),amountOut:p(s)},d),g=[n({pubkey:k.SystemProgram.programId,isWritable:!1}),n({pubkey:D.TOKEN_PROGRAM_ID,isWritable:!1}),n({pubkey:t.programId,isWritable:!1}),n({pubkey:t.id}),n({pubkey:e.id,isWritable:!1}),n({pubkey:t.authority,isWritable:!1}),n({pubkey:t.openOrders}),n({pubkey:t.baseVault}),n({pubkey:t.quoteVault}),n({pubkey:H,isWritable:!1}),n({pubkey:t.marketProgramId,isWritable:!1}),n({pubkey:t.marketId}),n({pubkey:t.marketBids}),n({pubkey:t.marketAsks}),n({pubkey:t.marketEventQueue}),n({pubkey:t.id}),n({pubkey:t.id}),n({pubkey:t.id}),n({pubkey:r.inTokenAccount}),n({pubkey:r.middleTokenAccount}),n({pubkey:r.middleStatusAccount}),n({pubkey:r.owner,isWritable:!1,isSigner:!0})]),new k.TransactionInstruction({programId:R,keys:g,data:d})}function Be({fromPoolKeys:t,toPoolKeys:e,userKeys:r}){let i=Buffer.alloc(w.span),s;return e.version===4?(w.encode({instruction:1},i),s=[n({pubkey:D.TOKEN_PROGRAM_ID,isWritable:!1}),n({pubkey:e.programId,isWritable:!1}),n({pubkey:t.id,isWritable:!1}),n({pubkey:e.id}),n({pubkey:e.authority,isWritable:!1}),n({pubkey:e.openOrders}),n({pubkey:e.baseVault}),n({pubkey:e.quoteVault}),n({pubkey:e.marketProgramId,isWritable:!1}),n({pubkey:e.marketId}),n({pubkey:e.marketBids}),n({pubkey:e.marketAsks}),n({pubkey:e.marketEventQueue}),n({pubkey:e.marketBaseVault}),n({pubkey:e.marketQuoteVault}),n({pubkey:e.marketAuthority,isWritable:!1}),n({pubkey:r.middleTokenAccount}),n({pubkey:r.outTokenAccount}),n({pubkey:r.middleStatusAccount}),n({pubkey:r.owner,isWritable:!1,isSigner:!0})]):(w.encode({instruction:3},i),s=[n({pubkey:D.TOKEN_PROGRAM_ID,isWritable:!1}),n({pubkey:e.programId,isWritable:!1}),n({pubkey:t.id,isWritable:!1}),n({pubkey:e.id}),n({pubkey:e.authority,isWritable:!1}),n({pubkey:e.openOrders}),n({pubkey:e.baseVault}),n({pubkey:e.quoteVault}),n({pubkey:H,isWritable:!1}),n({pubkey:e.marketProgramId,isWritable:!1}),n({pubkey:e.marketId}),n({pubkey:e.marketBids}),n({pubkey:e.marketAsks}),n({pubkey:e.marketEventQueue}),n({pubkey:e.id}),n({pubkey:e.id}),n({pubkey:e.id}),n({pubkey:r.middleTokenAccount}),n({pubkey:r.outTokenAccount}),n({pubkey:r.middleStatusAccount}),n({pubkey:r.owner,isWritable:!1,isSigner:!0})]),new k.TransactionInstruction({programId:R,keys:s,data:i})}0&&(module.exports={ROUTE_PROGRAM_ID_V1,_ROUTE_PROGRAM_ID_V1,defaultRoutes,getAssociatedMiddleStatusAccount,makeRouteSwapInstruction,makeSwapInFixedInInstruction,makeSwapOutFixedInInstruction,routeSwapInLayout,routeSwapOutLayout,swapRouteMiddleMints});
//# sourceMappingURL=index.js.map