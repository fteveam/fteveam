var re=Object.create;var P=Object.defineProperty;var ie=Object.getOwnPropertyDescriptor;var oe=Object.getOwnPropertyNames;var se=Object.getPrototypeOf,ae=Object.prototype.hasOwnProperty;var ue=(t,e)=>{for(var n in e)P(t,n,{get:e[n],enumerable:!0})},M=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of oe(e))!ae.call(t,o)&&o!==n&&P(t,o,{get:()=>e[o],enumerable:!(r=ie(e,o))||r.enumerable});return t};var m=(t,e,n)=>(n=t!=null?re(se(t)):{},M(e||!t||!t.__esModule?P(n,"default",{value:t,enumerable:!0}):n,t)),ce=t=>M(P({},"__esModule",{value:!0}),t);var ke={};ue(ke,{Api:()=>K,endlessRetry:()=>Pe});module.exports=ce(ke);var ne=m(require("axios"));var y=require("lodash"),L=m(require("dayjs")),q=m(require("dayjs/plugin/utc"));L.default.extend(q.default);var A=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:3,this.name=e.name}set level(e){this.logLevel=e}get time(){return(0,L.default)().utc().format("YYYY/MM/DD HH:mm:ss UTC")}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let n=e.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(n)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},U={},me={};function c(t){let e=(0,y.get)(U,t);if(!e){let n=(0,y.get)(me,t);e=new A({name:t,logLevel:n}),(0,y.set)(U,t,e)}return e}var we=require("@solana/web3.js"),Te=m(require("bn.js"));var X=m(require("big.js")),xe=m(require("bn.js"));var u=m(require("bn.js"));var k=c("Raydium_bignumber");var ge=new u.default(0),v=new u.default(1),Re=new u.default(2),Ae=new u.default(3),Le=new u.default(5),de=new u.default(10),j=new u.default(100),Ee=new u.default(1e3),Oe=new u.default(1e4),_=9007199254740991;function p(t){if(t instanceof u.default)return t;if(typeof t=="string"){if(t.match(/^-?[0-9]+$/))return new u.default(t);k.logWithError(`invalid BigNumberish string: ${t}`)}return typeof t=="number"?(t%1&&k.logWithError(`BigNumberish number underflow: ${t}`),(t>=_||t<=-_)&&k.logWithError(`BigNumberish number overflow: ${t}`),new u.default(String(t))):typeof t=="bigint"?new u.default(t.toString()):(k.logWithError(`invalid BigNumberish value: ${t}`),new u.default(0))}var J=m(require("toformat")),fe=J.default,x=fe;var w=m(require("big.js")),z=m(require("decimal.js-light"));var S=c("module/fraction"),E=x(w.default),T=x(z.default),he={[0]:T.ROUND_DOWN,[1]:T.ROUND_HALF_UP,[2]:T.ROUND_UP},ye={[0]:w.default.roundDown,[1]:w.default.roundHalfUp,[2]:w.default.roundUp},i=class{constructor(e,n=v){this.numerator=p(e),this.denominator=p(n)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new i(this.denominator,this.numerator)}add(e){let n=e instanceof i?e:new i(p(e));return this.denominator.eq(n.denominator)?new i(this.numerator.add(n.numerator),this.denominator):new i(this.numerator.mul(n.denominator).add(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}sub(e){let n=e instanceof i?e:new i(p(e));return this.denominator.eq(n.denominator)?new i(this.numerator.sub(n.numerator),this.denominator):new i(this.numerator.mul(n.denominator).sub(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}mul(e){let n=e instanceof i?e:new i(p(e));return new i(this.numerator.mul(n.numerator),this.denominator.mul(n.denominator))}div(e){let n=e instanceof i?e:new i(p(e));return new i(this.numerator.mul(n.denominator),this.denominator.mul(n.numerator))}toSignificant(e,n={groupSeparator:""},r=1){Number.isInteger(e)||S.logWithError(`${e} is not an integer.`),e<=0&&S.logWithError(`${e} is not positive.`),T.set({precision:e+1,rounding:he[r]});let o=new T(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return o.toFormat(o.decimalPlaces(),n)}toFixed(e,n={groupSeparator:""},r=1){return Number.isInteger(e)||S.logWithError(`${e} is not an integer.`),e<0&&S.logWithError(`${e} is negative.`),E.DP=e,E.RM=ye[r]||1,new E(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,n)}isZero(){return this.numerator.isZero()}};var Xe=c("Raydium_amount"),Ge=x(X.default);var G=require("@solana/web3.js"),Z={symbol:"SOL",name:"Solana",decimals:9},g={symbol:"WSOL",name:"Wrapped SOL",mint:"So11111111111111111111111111111111111111112",decimals:9,extensions:{coingeckoId:"solana"}},Ve={isQuantumSOL:!0,isLp:!1,official:!0,mint:new G.PublicKey(g.mint),decimals:9,symbol:"SOL",id:"sol",name:"solana",icon:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",extensions:{coingeckoId:"solana"}};var B=require("@solana/web3.js");var Q=require("@solana/spl-token"),a=require("@solana/web3.js");function O({pubkey:t,isSigner:e=!1,isWritable:n=!0}){return{pubkey:t,isWritable:n,isSigner:e}}var tt=[O({pubkey:Q.TOKEN_PROGRAM_ID,isWritable:!1}),O({pubkey:a.SystemProgram.programId,isWritable:!1}),O({pubkey:a.SYSVAR_RENT_PUBKEY,isWritable:!1})];function ee({publicKey:t,transformSol:e}){if(t instanceof a.PublicKey)return e&&t.equals(N)?V:t;if(e&&t===N.toBase58())return V;if(typeof t=="string")try{return new a.PublicKey(t)}catch{throw new Error("invalid public key")}throw new Error("invalid public key")}var nt=new a.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),rt=new a.PublicKey("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),it=new a.PublicKey("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),ot=new a.PublicKey("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),st=new a.PublicKey("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),at=new a.PublicKey("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),ut=new a.PublicKey("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),ct=new a.PublicKey("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),mt=new a.PublicKey("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),lt=new a.PublicKey("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),pt=new a.PublicKey("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),V=new a.PublicKey("So11111111111111111111111111111111111111112"),N=a.PublicKey.default;var F=class{constructor({mint:e,decimals:n,symbol:r="UNKNOWN",name:o="UNKNOWN",skipMint:l=!1}){if(e===N.toBase58()||e instanceof B.PublicKey&&N.equals(e)){this.decimals=g.decimals,this.symbol=g.symbol,this.name=g.name,this.mint=new B.PublicKey(g.mint);return}this.decimals=n,this.symbol=r,this.name=o,this.mint=l?B.PublicKey.default:ee({publicKey:e})}equals(e){return this===e?!0:this.mint.equals(e.mint)}},d=F;d.WSOL=new F(g);var C=class{constructor({decimals:e,symbol:n="UNKNOWN",name:r="UNKNOWN"}){this.decimals=e,this.symbol=n,this.name=r}equals(e){return this===e}},I=C;I.SOL=new C(Z);var kt=new i(j);var Et=c("Raydium_price");async function te(t){new Promise(e=>setTimeout(e,t))}var W=require("@solana/web3.js");var Vt=c("Raydium_txTool");var Ne=require("@solana/web3.js");var cn=c("Raydium_accountInfo_util");var f=c("Raydium_Api");async function Pe(t,e,n=1e3){let r;for(;r==null;)try{f.debug(`Request ${t} through endlessRetry`),r=await e()}catch(o){f.error(`Request ${t} failed, retry after ${n} ms`,o),await te(n)}return r}var K=class{constructor({cluster:e,timeout:n}){this.cluster=e,this.api=ne.default.create({baseURL:"https://api.raydium.io/v2",timeout:n}),this.api.interceptors.request.use(r=>{let{method:o,baseURL:l,url:b}=r;return f.debug(`${o==null?void 0:o.toUpperCase()} ${l}${b}`),r},r=>(f.error("Request failed"),Promise.reject(r))),this.api.interceptors.response.use(r=>{let{config:o,data:l,status:b}=r,{method:h,baseURL:D,url:R}=o;return f.debug(`${h==null?void 0:h.toUpperCase()} ${D}${R}  ${b}`),l},r=>{let{config:o,response:l={}}=r,{status:b}=l,{method:h,baseURL:D,url:R}=o;return f.error(`${h.toUpperCase()} ${D}${R} ${b||r.message}`),Promise.reject(r)})}async getTokens(){return this.api.get("/sdk/token/raydium.mainnet.json")}async getLiquidityPools(){return this.api.get(`/sdk/liquidity/${this.cluster}.json`)}async getPairsInfo(){return this.api.get("https://api.raydium.io/v2/main/pairs")}async getFarmPools(){return this.api.get(`/sdk/farm-v2/${this.cluster}.json`)}async getCoingeckoPrice(e){return this.api.get(`https://api.coingecko.com/api/v3/simple/price?ids=${e.join(",")}&vs_currencies=usd`)}async getRaydiumTokenPrice(){return this.api.get("https://api.raydium.io/v2/main/price")}async getBlockSlotCountForSecond(e){if(!e)return 2;let r=(await this.api.post(e,{id:"getRecentPerformanceSamples",jsonrpc:"2.0",method:"getRecentPerformanceSamples",params:[4]})).result.map(o=>o.numSlots);return r.reduce((o,l)=>o+l,0)/r.length/60}};0&&(module.exports={Api,endlessRetry});
//# sourceMappingURL=api.js.map